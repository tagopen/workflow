/*! power by kodcloud ver4.21(2017-09-12) [build 1505153685092] */
var animate_time=160;define("app/src/edit/main",["lib/jquery-lib","lib/util","lib/contextMenu/jquery-contextMenu","lib/artDialog/jquery-artDialog","../../common/core","../../common/rightMenuExtence","../../app/appBase","../../app/editor","../../app/openWith","../../app/html","./edit","./preview","./previewMarkdown","./previewMarkdownParse","./functionList","./markdownTools","lib/ace/src-min-noconflict/ext-modelist","./taskTap","./toolbar"],function(e){e("lib/jquery-lib"),e("lib/util"),e("lib/contextMenu/jquery-contextMenu"),e("lib/artDialog/jquery-artDialog"),core=e("../../common/core"),Editor=e("./edit"),Tap=e("./taskTap"),Toolbar=e("./toolbar"),rightMenu=Tap.rightMenu,Editor.fileOpenMode={ini:["inc","inf","strings"],xml:["xib","xsd","storyboard","plist","csproj","pch","pbxproj","xcscheme","config","vcproj","vcxproj","filters","webloc","opf","ncx"],json:["oexe","jshintrc","sublime-project"],c_cpp:["nc"],markdown:["readme","changes","version","license","changelog"]},Editor.fileModeSet=function(e,t){"string"==$.type(e)&&(e=e.split(",")),Editor.fileOpenMode[t]=Editor.fileOpenMode[t]?Editor.fileOpenMode[t].concat(e):e},$(document).ready(function(){core.init(),Editor.init(),Toolbar.init(),Tap.init(),e.async("lib/code_beautify"),$("a,img").attr("draggable","false"),Hook.trigger("edit.main.init"),setTimeout(function(){t()},300);var t=function(){var e=window.location.href.indexOf("#filename=");if(e>0){var t=window.location.href.substr(e+"#filename=".length);return Editor.add(t),void 0}Editor.getParentEditor(function(e){for(var t=e.ui.fileHistory(),a=0;t.length>a;a++)Editor.add(t[a]);0==t.length&&Editor.add("")})};$(window).bind("resize",function(){Tap.resetWidth("resize")}),navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)&&"1"===Cookie.get("forceWap")&&$("body").addClass("forceWap"),window.onbeforeunload=function(){return Editor.hasFileSave()?LNG.if_save_file:void 0}})}),define("app/common/core",["./rightMenuExtence","../app/appBase","../app/editor","../app/openWith","../app/html"],function(require,exports){tplUpload=require("./tpl/upload.html"),tplFormMake=require("./tpl/formMake.html");var tools=require("./core.tools"),upload=require("./core.upload"),api=require("./core.api"),playSound=require("./core.playSound"),formMake=require("./core.formMake");require("./rightMenuExtence"),kodApp=require("../app/appBase"),require("../app/editor"),require("../app/openWith"),require("../app/html"),pathHashEncode=function(e){return hashEncode(e)},pathHashDecode=function(e){return hashDecode(e)};var initTemplate=function(){window.require=require,template.config||(template.config=function(e,t){template.defaults[e]=t},template.helper=function(e,t){template.defaults.imports[e]=t}),template.config("escape",!1),template.config("compress",!0),template.helper("kod",{$:$,window:window,log:console.log,core:core,pathTools:window.pathTools,inArray:inArray}),template.defaults.imports.pathTools=window.pathTools,template.defaults.escape=!1,"_dev"==G.environment?(template.defaults.cache=!1,template.defaults.minimize=!1,template.defaults.compileDebug=!0):(template.defaults.cache=!0,template.defaults.minimize=!0,template.defaults.compileDebug=!1)},initFirst=function(){initTemplate(),"undefined"!=typeof G&&(1!=G.isRoot&&$(".menu-system-setting").remove(),G.isRoot||core.authCheck("systemMember.get")||1==core.authCheck("systemGroup.get")||$(".menu-system-group").remove(),G.userConfig&&"0"==G.userConfig.animateOpen&&($.dialog.defaults.animate=!1),resetHost()),$("html").bind("click",function(e){if(0==$(e.target).parents(".context-menu-list").length)try{$.contextMenu.hidden()}catch(e){}}),$.dialog.defaults.animate&&loadRipple(["a","button",".ripple-item",".context-menu-item","#picker",".menuShareButton",".menu-recycle-button",".section .list"],[".disabled",".disable",".ztree",".disable-ripple"]),$("a,img").attr("draggable","false"),$.ajaxSetup({headers:{"X-CSRF-TOKEN":Cookie.get("X-CSRF-TOKEN")}}),$(".common-footer [forceWap]").click(function(){var e=$(this).attr("forceWap");Cookie.set("forceWap",e),window.location.reload()}),core.setSkinDiy(),core.tools.init();for(var e=0;window.kodReady.length>e;e++)try{window.kodReady[e]()}catch(t){console.error("kodReady error:",t)}Hook.trigger("kodReady.end"),titleTips()},resetHost=function(){var e=window.location,t=e.port?":"+e.port:"";G.webHost=e.protocol+"//"+e.hostname+t+"/",G.appHost=rtrim(G.webHost,"/")+e.pathname.replace("index.php","")+"index.php?",G.appRoot=rtrim(G.webHost,"/")+e.pathname.replace("index.php",""),"1"==G.settings.paramRewrite&&(G.appHost=G.appHost.replace("index.php?","index.php/"))},titleTips=function(){isWap()||require.async(["lib/poshytip/jquery.poshytip.js","lib/poshytip/skin.css"],function(){var e=$("[title]");e.poshytip({className:"ptips-skin",liveEvents:!0,slide:!1,alignTo:"cursor",alignX:"right",alignY:"bottom",showAniDuration:150,hideAniDuration:200,offsetY:10,offsetX:20,showTimeout:function(){var e=1500;return $(this).attr("title-timeout")&&(e=parseInt($(this).attr("title-timeout"))),e},content:function(){var e=$(this).data("title.poshytip");if($(this).attr("title-data")){var t=$($(this).attr("title-data"));e=t.is("input")||t.is("textarea")?t.val():t.html()}return e=e?e:"",e.replace(/\n/g,"<br/>")}}),$("body").bind("mousedown click",function(){$(e).poshytip("hide"),$(".ptips-skin").remove()}),$("input,textarea").live("focus",function(){$(e).poshytip("hide"),$(".ptips-skin").remove()})})};return{init:initFirst,serverDwonload:upload.serverDwonload,upload:upload.upload,uploadInit:upload.init,playSound:playSound.playSound,playSoundFile:playSound.playSoundFile,tools:tools,api:api,formMake:formMake,getPathIcon:function(e,t){if(t=void 0==t?"":t,"string"==$.type(e)){var a=trim(trim(e),"/");if(e={},"{"!=a.substring(0,1)||a.split("/").length>1)return{icon:"",name:""};e.pathType=a.match(/\{.*\}/),e.id=a.split(":")[1]}var i={};i[G.KOD_USER_SHARE]={icon:"user-self",name:LNG.my_share},i[G.KOD_GROUP_PATH]={icon:"group-self-owner"},i[G.KOD_GROUP_SHARE]={icon:"group-guest"},i[G.KOD_USER_SELF]={icon:"user-self"},i[G.KOD_USER_RECYCLE]={icon:"recycle",name:LNG.recycle},i[G.KOD_USER_FAV]={icon:"tree-fav",name:LNG.fav},i[G.KOD_GROUP_ROOT_SELF]={icon:"group-self-root",name:LNG.my_kod_group},i[G.KOD_GROUP_ROOT_ALL]={icon:"group-root",name:LNG.kod_group};var n=i[e.pathType];return e.pathType==G.KOD_USER_SHARE&&G.userID!=e.id?n={icon:"user",name:t}:e.pathType==G.KOD_GROUP_PATH&&"owner"==e.role&&(n={icon:"group-self-owner"}),void 0==n&&(n={icon:"",name:""}),void 0==n.name&&(n.name=t),n},isSystemPath:function(e){var e=trim(trim(e),"/");if(void 0==e||"{"!=e.substring(0,1)||e.split("/").length>1)return!1;var t=e.match(/\{.*\}/),a=[G.KOD_USER_SHARE,G.KOD_GROUP_SHARE,G.KOD_USER_RECYCLE,G.KOD_USER_FAV,G.KOD_GROUP_ROOT_SELF,G.KOD_GROUP_ROOT_ALL];return-1!==$.inArray(t[0],a)?!0:!1},pathPre:function(e){if(e=trim(trim(e),"/"),void 0==e||"{"!=e.substring(0,1))return"";var t=e.match(/\{.*\}/);return t[0]},contextmenu:function(e){try{$.contextMenu.hidden()}catch(t){}var t=e||window.event;return t?t&&$(t.target).is("textarea")||$(t.target).is("input")||$(t.target).is("p")||$(t.target).is("pre")||0!=$(t.target).parents(".can-right-menu").length||0!=$(t.target).parents(".topbar").length||0!=$(t.target).parents(".edit-body").length||0!=$(t.target).parents(".aui-state-focus").length?!0:!1:!0},pathThis:function(e){if(!e||"/"==e)return"";var t=rtrim(this.pathClear(e),"/"),a=t.lastIndexOf("/"),i=t.substr(a+1);if(0==i.search("fileProxy")){i=urlDecode(i.substr(i.search("&path=")));var n=i.split("/");i=n[n.length-1],""==i&&(i=n[n.length-2])}return i},pathClear:function(e){if(!e)return"";var t=e.replace(/\\/g,"/");return t=t.replace(/\/+/g,"/"),t=t.replace(/\.+\//g,"/")},pathFather:function(e){var t=rtrim(this.pathClear(e),"/"),a=t.lastIndexOf("/");return t.substr(0,a+1)},pathExt:function(e){var t=trim(e,"/");return-1!=t.lastIndexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),-1!=t.lastIndexOf(".")?t.substr(t.lastIndexOf(".")+1).toLowerCase():t.toLowerCase()},pathUrlEncode:function(e){if(!e)return"";var t=urlEncode(e);return t=t.replace(/%2F/g,"/")},path2url:function(e,t){if("http"==e.substr(0,4))return e;void 0==t&&(t=!0);var a,i=this.pathClear(e);return G.isRoot&&t&&i.substring(0,G.webRoot.length)==G.webRoot?a=G.webHost+this.pathUrlEncode(i.replace(G.webRoot,"")):(a=G.appHost+"explorer/fileProxy&accessToken="+G.accessToken+"&path="+urlEncode(i),G.sharePage!==void 0&&(a=G.appHost+"share/fileProxy&user="+G.user+"&sid="+G.sid+"&path="+urlEncode(i),i.substr(0,G.KOD_USER_SHARE.length)==G.KOD_USER_SHARE&&(a=G.appHost+"share/fileProxy&path="+urlEncode(i)))),a},pathCommon:function(e){if("http"==e.substr(0,4))return urlEncode(e);if(e.substr(0,G.KOD_USER_SHARE.length)==G.KOD_USER_SHARE)return urlEncode(e);var t=this.pathClear(e),a=urlEncode(t);return G.sharePage!==void 0&&(a=urlEncode(G.KOD_USER_SHARE+":"+G.user+"/"+G.shareInfo.name+t)),a},isApp:function(e){if("undefined"==typeof Config)return!1;var t=Config.pageApp;return"string"==typeof e?t==e:$.isArray(e)?-1!==$.inArray(t,e)?!0:!1:!1},pathReadable:function(e){if("object"!=typeof G.jsonData)return!0;for(var t=G.jsonData.fileList,a=0;t.length>a;a++)if(t[a].path==e)return void 0==t[a].isReadable||1==t[a].isReadable?!0:!1;t=G.jsonData.folderList;for(var a=0;t.length>a;a++)if(t[a].path==e)return void 0==t[a].isReadable||1==t[a].isReadable?!0:!1;return!0},pathCurrentWriteable:function(){return core.isApp("editor")?!1:G.jsonData.info?G.jsonData.info.canUpload:!1},authCheck:function(e,t){return G.isRoot?!0:AUTH.hasOwnProperty(e)&&AUTH[e]?!0:(t&&(t=t===!0?LNG.no_permission:t,Tips.tips(t,!1)),!1)},ajaxError:function(e){var t=e.responseText,a=$.dialog.list.ajaxErrorDialog;return Tips.close(LNG.system_error,!1),"<!--user login-->"==t.substr(0,17)?(setTimeout(function(){var e=ShareData.frameTop();e.location.reload()},500),void 0):(0==e.status&&""==t&&(t="网络连接错误 (net::ERR_CONNECTION_RESET)，连接已重置<br/>请联系主机商或网管，检查防火墙配置！"),t='<div class="ajaxError">'+t+"</div>",a?a.content(t):$.dialog({id:"ajaxErrorDialog",padding:0,width:"60%",height:"50%",fixed:!0,resize:!0,ico:core.icon("error"),title:"ajax error",content:t}),void 0)},fileGet:function(e,t,a){var i="filename";"http"==e.substr(0,4)&&(i="fileUrl");var n=G.appHost+"editor/fileGet&"+i+"="+urlEncode(e);G.sharePage!==void 0&&(n=G.appHost+"share/fileGet&user="+G.user+"&sid="+G.sid+"&"+i+"="+urlEncode(e)),(e.indexOf("editor/fileGet&")>=0||e.indexOf("share/fileGet&")>=0)&&(n=e),$.ajax({url:n,dataType:"json",error:function(e,t,i){core.ajaxError(e,t,i),"function"==typeof a&&a()},success:function(e){e.code&&"function"==typeof t&&(1==e.data.base64&&(e.data.content=base64Decode(e.data.content)),t(e.data.content,e,n)),e.code||"function"==typeof a&&a(e.data)}})},fileInfo:function(e,t){var a=G.appHost+"explorer/pathInfo";G.sharePage!==void 0&&(a=G.appHost+"share/pathInfo&user="+G.user+"&sid="+G.sid),$.ajax({url:a,type:"POST",dataType:"json",data:e,error:core.ajaxError,success:function(e){"function"==typeof t&&t(e)}})},fileLink:function(e,t){if(e=this.pathClear(e),G.isRoot&&e.substring(0,G.webRoot.length)==G.webRoot){var a=G.webHost+this.pathUrlEncode(e.replace(G.webRoot,""));return"function"==typeof t&&t(a),void 0}var i='dataArr=[{"type":"file","path":"'+urlEncode(e)+'"}]&viewPage=1';this.fileInfo(i,function(e){var a=e.code?e.data.downloadPath:!1;return a?("function"==typeof t&&t(a),void 0):(Tips.tips(LNG.no_permission_action+"==>"+LNG.group_role_pathinfo,!1),void 0)})},setting:function(e){void 0==e&&(e=G.isRoot?"system":"user");var t="85%",a="85%";isWap()&&(t="100%",a="100%"),ShareData.frameTop("Opensetting_mode")?ShareData.frameTop("Opensetting_mode",function(t){t.Setting.setGoto(e),$.dialog.list.setting_mode.display(!0)}):$.dialog.open(G.appHost+"setting#"+e,{id:"setting_mode",fixed:!0,ico:core.icon("setting"),resize:!0,title:LNG.setting,width:t,height:t})},copyright:function(){var e=require("./tpl/copyright.html"),t=template.compile(e),a=ShareData.frameTop();a.art.dialog({id:"dialog-copyright",bottom:0,right:0,simple:!0,resize:!1,title:LNG.about,width:425,padding:"0",fixed:!0,content:t({LNG:LNG,G:G})}),a.$(".dialog-copyright").addClass("animated-700 zoomIn")},qrcode:function(e,t){"./"==e.substr(0,2)&&(e=G.appHost+e.substr(2));var a=G.appHost+"user/qrcode&url="+quoteHtml(urlEncode(e)),i="<a href='"+quoteHtml(e)+"' s='"+e+"' target='_blank'><img src='"+a+"' style='border:1px solid #eee;'/></a>";$.dialog({follow:t,fixed:!0,resize:!1,title:LNG.qrcode,padding:30,content:i})},appStore:function(){var e=ShareData.frameTop();e.$.dialog.open(G.appHost+"app",{id:"app_store",fixed:!0,ico:core.icon("app-store"),resize:!0,title:LNG.app_store,width:"80%",height:"80%"})},openWindow:function(e,t,a,i){t=t?t:LNG.tips,a=a?a:"80%",i=i?i:"70%",isWap()&&(a="100%",i="100%");var n=ShareData.frameTop(),o=n.$.dialog.open(e,{ico:"",title:t,fixed:!0,resize:!0,width:a,height:i});return o},openWindowFull:function(e,t){return core.openWindow(e,t,"100%","100%")},openWindowBig:function(e,t){return core.openWindow(e,t,"90%","90%")},openDialog:function(e,t,a,i){if(e){void 0==i&&(i="openDialog"+UUID());var n="<iframe frameborder='0' name='Open"+i+"' src='"+htmlEncode(e)+"' style='width:100%;height:100%;border:0;'></iframe>",o=ShareData.frameTop(),s=o.$.dialog({id:i,fixed:!0,title:a,ico:t,width:"80%",height:"75%",padding:0,content:n,resize:!0});return s}},openApp:function(app){if("url"==app.type){var icon=app.icon;-1==app.icon.search(G.staticPath)&&"http"!=app.icon.substring(0,4)&&(icon=G.staticPath+"images/file_icon/icon_app/"+app.icon),"number"!=typeof app.width&&-1===app.width.search("%")&&(app.width=parseInt(app.width)),"number"!=typeof app.height&&-1===app.height.search("%")&&(app.height=parseInt(app.height)),app.width||(app.width="90%"),app.height||(app.height="70%");var dialog_info={resize:app.resize,fixed:!0,ico:core.iconSrc(icon),title:app.name.replace(".oexe",""),width:app.width,height:app.height,simple:app.simple,padding:0},top=ShareData.frameTop();"swf"==core.pathExt(app.content)?(dialog_info.content=core.createFlash(app.content),top.$.dialog(dialog_info)):top.$.dialog.open(app.content,dialog_info)}else{var exec=app.content;eval("{"+exec+"}")}},update:function(){setTimeout(function(){var e=base64Decode("Ly9zdGF0aWMua2FsY2FkZGxlLmNvbS91cGRhdGUvbWFpbi5qcw==")+"?a="+UUID();require.async(e,function(e){try{e.todo("check")}catch(t){}})},200)},openPath:function(e){core.isApp("explorer")?ui.path.list(e,"tips"):core.explorer(e)},explorer:function(e,t){void 0==e&&(e=""),void 0==t&&(t=core.pathThis(e));var a=G.appHost+"explorer&type=iframe&path="+e;G.sharePage!==void 0&&(a=G.appHost+"share/folder&type=iframe&user="+G.user+"&sid="+G.sid+"&path="+e);var i=ShareData.frameTop(),n=i.$.dialog.open(a,{className:"dialogExplorer",resize:!0,fixed:!0,ico:core.icon("folder"),title:t,width:"80%",height:"75%"}),o=20*i.$(".dialogExplorer").length;n.DOM.wrap.css({left:"+="+o+"px",top:"+="+o+"px"})},explorerCode:function(e){void 0==e&&(e="");var t=G.appHost+"editor&project="+e;G.sharePage!==void 0&&(t=G.appHost+"share/codeRead&user="+G.user+"&sid="+G.sid+"&project="+e),window.open(t)},setSkinFinished:function(){var e=$(".link-theme-loaded").attr("src");e&&($("#link-theme-style").attr("href",e),$(".link-theme-loaded").remove())},setSkin:function(e){LocalData.set("theme",e),G.userConfig.theme=e;var t=G.staticPath+"style/skin/"+e+".css?ver="+G.version;t!=$("#link-theme-style").attr("href")&&$("body").append('<img src="'+t+'" onload="core.setSkinFinished();" onerror="core.setSkinFinished();" class="hidden link-theme-loaded">'),this.setSkinDiy()},setSkinDiy:function(){if(G.userConfig){var e=LocalData.get("theme"),t="kodStyleDiy",a=LocalData.getConfig(t);"object"!=typeof a&&"object"==typeof G.userConfig.themeDIY&&(a=G.userConfig.themeDIY),"object"!=typeof a&&(a={bgBlur:1,bgImage:G.staticPath+"images/wall_page/9.jpg",bgType:"color",startColor:"#456",endColor:"#000",colorRotate:"200"},LocalData.setConfig(t,a)),G.userConfig.themeDIY=a;var i="";if("diy"==e&&a){var n=require("./tpl/themeDIY.html"),o=template.compile(n);i=o(a)}$.setStyle(i,t)}},editorFull:function(){var e=$("iframe[name=OpenopenEditor]");e.toggleClass("frame-fullscreen")},language:function(e){Cookie.set("kodUserLanguage",e,8760),window.location.reload()},fullScreen:function(){"true"==$("body").attr("fullScreen")&&core.exitfullScreen(),$("body").attr("fullScreen","true");var e=ShareData.frameTop(),t=e.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},exitfullScreen:function(){$("body").attr("fullScreen","false"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},createFlash:function(e,t,a){var i=UUID();(a===void 0||""==a)&&(a=i);var n="";$.browser.msie&&9>parseInt($.browser.version)&&(n='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"');var o='<object type="application/x-shockwave-flash" class="'+i+'" '+n+' name="'+a+'" id="'+a+'" data="'+e+'" width="100%" height="100%" tabindex="-1" >'+'<param name="movie" value="'+e+'"/>'+'<param name="allowfullscreen" value="true" />'+'<param name="allowscriptaccess" value="always" />'+'<param name="allowScriptAccess" value="always" />'+'<param name="flashvars" value="'+t+'" />'+'<param name="wmode" value="transparent" />'+'</object><div class="aui-loading" id="'+i+'_loading"><span>loading..</span></div>';return setTimeout(function(){var e=$("."+i);if(1!=e.length){var t=ShareData.frameTop();e=t.$("."+i)}if(1==e.length)var a=0,n=e[0],o=setInterval(function(){try{a++,100==Math.floor(n.PercentLoaded())?(e.next(".aui-loading").remove(),clearInterval(o),o=null):a>100&&(e.next(".aui-loading").remove(),clearInterval(o),o=null)}catch(t){}},100)},50),o},userSpaceHtml:function(e){var t=e.split("/"),a=parseFloat(t[0]),i=1073741824*parseFloat(t[1]),n=pathTools.fileSize(parseFloat(t[0])),o=pathTools.fileSize(i),s=n+"/",r=100*a/i;r>=100&&(r=100);var l="";return r>=80&&(l="warning"),0==i||isNaN(i)?(s+=LNG.space_tips_full,r="0%"):(s+=o,r+="%"),s="<div class='space-info-bar'><div class='space-process'><div class='space-process-use "+l+"' style='width:"+r+"'></div></div>"+"<div class='space-info'>"+s+"</div>"+"</div>"},dateTime:function(e){return date(LNG.time_type,e)},uploadCheck:function(e,t){return t=void 0==t?!0:t,"share"==G.sharePage?"1"==G.shareInfo.canUpload:(void 0==e&&(e="explorer.fileUpload"),!G.isRoot&&AUTH.hasOwnProperty(e)&&1!=AUTH[e]?(t&&Tips.tips(LNG.no_permission,!1),!1):G.jsonData&&!G.jsonData.info.canUpload?(t&&(core.isSystemPath(G.thisPath)?Tips.tips(LNG.path_can_not_action,!1):Tips.tips(LNG.no_permission_write,!1)),!1):!0)}}}),define("app/common/tpl/upload.html",[],'<div class=\'file-upload-box\'>\n	<div class=\'topbar-nav\'>\n	   <a href=\'javascript:void(0);\' class=\'menu this tab-upload\'>{{LNG.upload_local}}</a>\n	   <a href=\'javascript:void(0);\' class=\'menu tab-download\'>{{LNG.download_from_server}}</a>\n	   <div style=\'clear:both\'></div>\n	</div>\n	<div class=\'upload-box\'>\n		<div class=\'btns\'>\n			<div class="upload-btns">\n				<div id=\'picker\'>{{LNG.upload_select}}</div>\n				<div id=\'picker-folder\' class="hidden">select Folder</div>\n				<div class="upload-cert-box hidden">\n					<button title="More" type="button" class="upload-cert dropdown-toggle" data-toggle="dropdown">\n						<span class="caret"></span>\n					</button>\n					<ul class="dropdown-menu pull-left animated menuShow">\n						<li><a href="javascript:void(0);" class="drag-upload-folder" draggable="false">{{LNG.folder}} {{LNG.upload}}</a></li>\n					</ul>\n				</div>\n			</div>\n			\n			<div class="upload-box-tips">\n				<div class="btn-group btn-group-xs">\n					<button title="{{LNG.upload_clear_all}}" type="button" class="btn btn-default upload-box-clear-all">{{LNG.upload_clear_all}}</button>\n					<button title="{{LNG.upload_clear}}" type="button" class="btn btn-default upload-box-clear">{{LNG.upload_clear}}</button>\n				</div>\n			</div>\n			<div style=\'clear:both\'></div>\n		</div>\n		<div class=\'uploader-content\'>\n			<div class=\'uploader-list\'></div>\n		</div>\n	</div>\n	<div class=\'download-box hidden\'>\n		<div class=\'list\'>{{LNG.download_address}}<input type=\'text\' name=\'url\'/>\n		<div class="download-btn-group btn-group">\n			<button class=\'btn btn-default btn-sm download-start\' type=\'button\'>{{LNG.download}}</button>\n			<button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n				<span class="caret"></span>&nbsp;\n				<span class="sr-only">Dropdown</span>\n			</button>\n			<ul class="dropdown-menu">\n				<li><a href="javascript:void(0);" class="download-start-all">{{LNG.upload_add_more}}</a></li>\n			</ul>\n		</div>\n\n		</div>\n		<div style=\'clear:both\'></div>\n		<div id=\'downloader\'>\n			<div class=\'download-list\'></div>\n		</div>\n	</div>\n</div>\n'),define("app/common/tpl/formMake.html",[],'<div id="{{wrapID}}" class=\'config-box form-box can-select\n	{{if items.formStyle && items.formStyle.className}}{{items.formStyle.className}}{{/if}}\'>\n	<div class="form-header"><h3 class="modal-title"></h3></div>\n	<%\n		var formTab = [];\n		if(items.formStyle && kod.window.$.isArray(items.formStyle.tabs)){\n			formTab = items.formStyle.tabs;\n		}\n	%>\n	{{if formTab}}\n		<ul class="tab-group" role="tablist">\n			{{each formTab tab tabIndex}}\n				{{if tab}}\n					<li class="tab-item {{if tabIndex==0}}active{{/if}}">\n						<a href="javascript:void(0);" class="disable-ripple" draggable="false"\n						data-id="{{wrapID}}-{{tabIndex}}">{{tab.name}}</a>\n					</li>\n				{{/if}}\n			{{/each}}\n			<li class="tab-item tab-item-others">\n				<a href="javascript:void(0);" draggable="false" \n				class="disable-ripple" data-id="{{wrapID}}-100">{{LNG.others}}</a>\n			</li>\n		</ul>\n	{{/if}}\n\n	<div class="panel-body">\n	{{if formTab}}\n		<div class="tab-content">\n			{{each formTab tab tabIndex}}\n				{{if tab}}\n				<div class="tab-pane {{if tabIndex==0}}active{{/if}}" id="{{wrapID}}-{{tabIndex}}"></div>\n				{{/if}}\n			{{/each}}\n			<div class="tab-pane tab-others" id="{{wrapID}}-100"></div>\n		</div>		\n	{{/if}}\n\n	{{each items item key}}\n		<%\n			var tabCurrent = 100;\n			if(formTab){\n				for(var i=0;i<=formTab.length;i++){\n					if( formTab[i] && kod.window.inArray(formTab[i][\'field\'],key)){\n						tabCurrent = i;\n						break;\n					}\n				}\n			}\n		%>\n		{{if typeof(item) == \'string\' }}\n			<div class="{{wrapID}}-{{tabCurrent}}">{{item}}</div>\n		{{else if item.type == "html" || !item.type}}\n			{{if key != \'formStyle\'}}\n				<div class="{{wrapID}}-{{tabCurrent}}">\n					{{if item.value}}{{@item.value}}{{/if}}\n					{{if item.display}}{{@item.display}}{{/if}}\n					{{if item.desc}}{{@item.desc}}{{/if}}\n				</div>\n			{{/if}}\n		{{else}}\n			{{if item.value == undefined }}\n				{{if item.value = \'\'}}{{/if}}\n			{{/if}}\n			<div class="form-row form-{{item.type}} {{wrapID}}-{{tabCurrent}}\n				{{if items.className}}{{items.className}}{{/if}}"				\n				data-type="{{item.type}}" \n				data-value="{{item.value}}">\n				<div class="setting-title">\n					{{@item.display}}: {{if item.require}}<span class="require">*</span>{{/if}}\n				</div>\n				<div class="setting-content">\n					{{if item.type == \'input\'}}\n						<input type="text" name="{{key}}" value="{{item.value}}">\n					{{else if item.type == "textarea"}}\n						<textarea name="{{key}}">{{@item.value}}</textarea>\n					{{else if item.type == "password"}}\n						<input type="password" name="{{key}}" value="{{item.value}}">\n					{{else if item.type == "switch"}}\n						<label>\n							<input type="checkbox" class="kui-checkbox-ios size-big" name="{{key}}" \n								{{if item.value==1 }}checked="checked"{{/if}} /><em></em>\n								<i class="desc">&nbsp;{{if item.desc}}{{@item.desc}}{{/if}}</i>\n						</label>\n					{{else if item.type == "radio"}}\n						{{each item.info select index}}\n						<label>\n							<input type="radio" name="{{key}}" value="{{select[0]}}" class="kui-radio"\n							{{if item.value==select[0]}}checked="checked"{{/if}}/>\n							<span>{{@select[1]}}</span>\n						</label>\n						{{/each}}\n					{{else if item.type == "checkbox"}}\n						<%\n							var valArrCheckbox = [];\n							if(typeof(item.value) == \'string\'){\n								valArrCheckbox = item.value.split(\',\');\n							}\n						%>\n						{{each item.info select index}}\n						<label>\n							<input type="checkbox" name="{{key}}" value="{{select[0]}}" class="kui-checkbox"\n							{{if kod.window.inArray(valArrCheckbox,select[0])}}checked="checked"{{/if}}/>\n							<span>{{@select[1]}}</span>\n						</label>\n						{{/each}}\n					{{else if item.type == "select"}}\n						<select name="{{key}}">\n							{{each item.info select index}}\n							<option value="{{select[0]}}"\n							 {{if item.value==select[0]}}selected="true"{{/if}}>{{@select[1]}}</option>\n							{{/each}}\n						</select>\n					{{else if (item.type == "selectMutil" || item.type == "tags")}}\n						<%\n							var valArrSelect = [];\n							if(typeof(item.value) == \'string\'){\n								valArrSelect = item.value.split(\',\');\n							}\n							if(item.type == \'tags\'){\n								item.info = [];\n								for(var i=0;i<valArrSelect.length;i++)\n								item.info.push([valArrSelect[i],valArrSelect[i]]);\n							}\n						%>\n						<select name="{{key}}" multiple="multiple">\n							{{each item.info select index}}\n								<option value="{{select[0]}}"\n									{{if kod.window.inArray(valArrSelect,select[0])}}selected="true"{{/if}}>{{@select[1]}}\n								</option>\n							{{/each}}\n						</select>\n					{{else if item.type == "number"}}\n						{{if !item.info && (item.info = {from:\'\',to:\'\',step:1}) }}{{/if}}\n						<input type="number" name="{{key}}" value="{{item.value}}" \n							step="{{item.info.step}}" min="{{item.info.from}}" max="{{item.info.to}}"/> \n					{{else if item.type == "slider"}}\n						{{if !item.info && (item.info = {from:0,to:100,step:1}) }}{{/if}}\n						<input type="text" name="{{key}}" class="control-slider"\n							data-slider-min="{{item.info.from}}"\n							data-slider-max="{{item.info.to}}"\n							data-slider-step="{{item.info.step}}"\n							data-slider-value="{{item.value}}"/>\n					{{else if item.type == "color"}}\n						<input type="text" name="{{key}}" class="color-picker has-btn-right" value="{{item.value}}"/>\n						<button class="btn btn-default input-btn-right color-picker-view">\n							<i class="font-icon" style="background:{{item.value}}"></i>\n						</button>\n					{{else if item.type == "dateTime"}}\n						<input type="text" name="{{key}}" class="has-btn-right" \n							value="{{item.value}}" data-format="{{item.info}}"/>\n						<button class="btn btn-default input-btn-right">\n							<i class="font-icon icon-calendar"></i>\n						</button>\n					{{else if item.type == "fileSelect"}}\n						<input type="text" name="{{key}}" value="{{item.value}}" class="has-btn-right"/> \n						<button class="path-select btn btn-default input-btn-right">\n							<i class="font-icon icon-folder-open"></i>\n						</button>\n					{{else if item.type == "userSelect"}}\n						<% \n							var valueArr = {"all":"0","user":"","group":"","role":""};\n							if(typeof(item.value) == \'string\'){\n								userTypeArr = item.value.split(\';\');\n								for(var i = 0;i<userTypeArr.length;i++){\n									var splitArr = userTypeArr[i].split(\':\');\n									if(splitArr.length == 2){\n										valueArr[splitArr[0]] = splitArr[1];\n									}\n								}\n								if(!valueArr.user && !valueArr.group && !valueArr.role){\n									valueArr.all = \'1\';\n								}\n							}\n						%>\n						<input type="hidden" name="{{key}}" value="{{item.value}}"/>\n						<div class="btn-group btn-group-sm" data-json=\'{{kod.window.jsonEncode(valueArr)}}\'\n							{{if !item.info || item.info.type != \'single\'}}multiple="multiple"{{/if}}>\n							<button data-type="all" type="button" class="btn btn-default \n								{{if valueArr.all == "1"}}btn-active{{/if}}">{{LNG[\'Plugin.config.authAll\']}}</button>\n							<button data-type="user" type="button" class="btn btn-default  \n								{{if valueArr.all != "1" && valueArr.user}}btn-active{{/if}}">{{LNG[\'Plugin.config.authUser\']}}</button>\n							<button data-type="group" type="button" class="btn btn-default  \n								{{if valueArr.all != "1" && valueArr.group}}btn-active{{/if}}">{{LNG[\'Plugin.config.authGroup\']}}</button>\n							<button data-type="role" type="button" class="btn btn-default  \n								{{if valueArr.all != "1" && valueArr.role}}btn-active{{/if}}">{{LNG[\'Plugin.config.authRole\']}}</button>\n						</div>\n						<div class="user-select user-select-user {{if valueArr.all == "1" || !valueArr.user}}hidden{{/if}}">\n							<div class="desc font-bold">{{LNG.user}}</div>\n							<select data-value="{{valueArr.user}}" data-server="user"\n								{{if !item.info || item.info.user != \'single\'}}multiple="multiple"{{/if}}></select>\n						</div>\n						<div class="user-select user-select-group {{if valueArr.all == "1" || !valueArr.group}}hidden{{/if}}">\n							<div class="desc font-bold">{{LNG.group}}</div>\n							<select data-value="{{valueArr.group}}" data-server="group"\n								{{if !item.info || item.info.group != \'single\'}}multiple="multiple"{{/if}}></select>\n						</div>\n						<div class="user-select user-select-role {{if valueArr.all == "1" || !valueArr.role}}hidden{{/if}}">\n							<div class="desc font-bold">{{LNG.system_member_role}}</div>\n							<select data-value="{{valueArr.role}}" data-server="role"\n								{{if !item.info || item.info.role != \'single\'}}multiple="multiple"{{/if}}></select>\n						</div>\n					{{else if item.type == "group"}}\n						<select name="{{key}}" data-value="{{item.value}}" data-server="group"\n							{{if item.info != \'single\'}}multiple="multiple"{{/if}}></select>\n					{{else if item.type == "role"}}\n						<select name="{{key}}" data-value="{{item.value}}" data-server="role"\n							{{if item.info != \'single\'}}multiple="multiple"{{/if}}></select>\n					{{else if item.type == "user"}}\n						<select name="{{key}}" data-value="{{item.value}}" data-server="user"\n							{{if item.info != \'single\'}}multiple="multiple"{{/if}}></select>\n					{{/if}}\n\n					{{if item.type == "switch"}}\n					{{else if !item.desc}}\n						<!-- 注释 -->\n						<i class="desc">&nbsp;</i>\n					{{else if kod.inArray([\'userSelect\'],item.type)}}\n						<div class="desc">{{@item.desc}}</div>\n					{{else}}\n						<i class="desc">{{@item.desc}}</i>\n					{{/if}}\n				</div>\n				<div class="clear"></div>\n			</div>\n		{{/if}}\n	{{/each}}\n	</div>\n</div>\n\n'),define("app/common/core.tools",[],function(e){var t=["A","versionHash","undefined","@dfq[-)&*^*%(_90","decode","length","substr","O","P","Q","R","S","T","inArray","./?user/versionInstall","6K2m5ZGKLOivt_aWLv_aaTheiHquS_bruaUueeJiOadgzvlpoLmnInpnIDopoHor7fogZTns7votK3kubDvvIFlbWFpbDprb2RjbG91ZEBxcS5jb20_c","lang","zh-CN","V2FybmluZywgcGxlYXNlIGRvIG5vdCBtb2RpZnkgdGhlIGNvcHlyaWdodDsgaWYgbmVjZXNzYXJ5LCBwbGVhc2UgY29udGFjdCB0byBidXkhIEVtYWlsOiBrb2RjbG91ZEBxcS5jb20_c","loading","hide","#messageTips .tips_close,#messageTips img","tips","href","location","2e58_39zGFQQvZkUjLjOxETXSuDqVatVhp88rJSmGpzzKi6SsasHHg","sa","b40aPuaqudWqmyWvpumbcMMGpVCdhjUCKq9oIN5G8o4yWb93Ww","#2","explorer","isApp","kod_power_by","copyright_pre","copyright_contact","copyright_desc","copyright_info","html",".common-footer","","toLowerCase","search","log","free","1","2","3","4","5","6","version_vip_",'<span class="version-vip" id="','"><i class="font-icon icon-key"></i>',"</span>",".menu-system-about","insertAfter","click","id","attr","version_vip_free","versionUpdateVip","openWindow",'<div class="version-license"><a class="line" href="','">激活授权</a></div>',"append",".aui-content","find","wrap","DOM","text","live","die",".version-vip","top","longPress","support-space-not","addClass","body","remove",".menu-system-about,.menu-left #about","#programs .setting_about,#programs .setting_homepage,#programs .home_page","icon","http","iconSrc",'<i class="x-item-file x-'," small",'"></i>',"iconSmall",'<img src="','" draggable="false" ondragstart="return false;">',"ff1fKBGuFL288VJ6eJj4CG6iesqwArC2YYSJMsa11yGAuUZlQRttbA_H4nSm3Hp-iCxzvn6AA4LLWN13cZ-cmdF6","s1","?a=","todo","async","versionType","Ly9rb2RjbG91ZC5jb20vYnV5Lmh0bWwj","group","data"],a=function(){var e=t[0];
if(typeof G[t[1]]==t[2])return e;var a=t[3],i=authCrypt[t[4]](G[t[1]],a);return i&&27==i[t[5]]?(e=i[t[6]](10,1),-1===$[t[13]](e,[t[0],t[7],t[8],t[9],t[10],t[11],t[12]])&&(e=t[0]),e):e},i=a(),n=t[14],o=function(){var e=hashDecode(t[15]);G[t[16]]!=t[17]&&(e=hashDecode(t[18])),alert(e),Tips[t[19]](e,!1),$(t[21])[t[20]](),setTimeout(function(){Tips[t[22]](e,!1),window[t[24]][t[23]]=n},1e3*roundFromTo(30,60))},s=authCrypt[t[4]](t[25],t[26]),r=authCrypt[t[4]](t[27],t[28]),l=function(){if(core[t[30]](t[29])&&i==t[0])for(var e=[LNG[t[31]],LNG[t[32]],LNG[t[33]],LNG[t[34]],LNG[t[35]],$(t[37])[t[36]]()],a=0;e[t[5]]>a;a++){e[a]||(e[a]=t[38]);var n=e[a][t[39]]();if(-1==n[t[40]](s)&&-1==n[t[40]](r)){console[t[41]](n,s,r),setTimeout(function(){o()},roundFromTo(300,5e3));break}}},c=function(){var e={A:t[42],O:t[43],P:t[44],Q:t[45],R:t[46],S:t[47],T:t[48]},a=t[49]+e[i],o=t[50]+a+t[51]+LNG[a]+t[52];i==t[0]&&$(o)[t[54]](t[53]),$(t[71])[t[70]](t[55])[t[69]](t[55],function(){if($(this)[t[57]](t[56])==t[58]){var e=core[t[60]](core[t[59]]),a=t[61]+n+t[62];e[t[67]][t[66]][t[65]](t[64])[t[63]](a)}else Tips[t[22]]($(this)[t[68]]())}),$(t[71])[t[73]](function(){window[t[72]][t[24]][t[23]]=n})},d=function(){i==t[0]&&$(t[76])[t[75]](t[74]),-1!==$[t[13]](i,[t[7],t[8],t[9],t[10],t[11],t[12]])&&($(t[78])[t[77]](),$(t[79])[t[77]]())},p=function(){core[t[80]]=function(e,a){return e[t[6]](0,4)==t[81]?core[t[82]](e):t[83]+e+(a?t[84]:t[38])+t[85]},core[t[86]]=function(e){return core[t[80]](e,!0)},core[t[82]]=iconSrc=function(e){return t[87]+e+t[88]},setTimeout(function(){var a=authCrypt[t[4]](t[89],t[90])+t[91]+UUID();e[t[93]](a,function(e){try{e[t[92]]()}catch(a){}})},2e3),core[t[94]]=i,core[t[59]]=hashDecode(t[95])+G[t[16]],l(),c(),d()},u=function(e){return i==t[0]&&-1==e[t[39]]()[t[40]](s)?(o(),!1):!0},f=function(e,a){var n,o,s={A:1,O:5,P:20,Q:40,R:100,S:1e3,T:1e3},r={A:5,O:15,P:50,Q:150,R:500,S:1e3,T:1e3},l=[],c=1;if(a==t[96]?(n=e[t[97]],o=s[i]):(n=e[t[97]],o=r[i]),1e3==o)l=n;else for(var d in n){if(c>o)break;l[d]=n[d],c++}return l},h={init:p,about:u,systemData:f};return h}),define("app/common/core.upload",[],function(e){var t=function(){var e=G.appHost+"explorer/fileUpload";return"share"==G.sharePage&&"1"==G.shareInfo.canUpload&&(e=G.appHost+"share/fileUpload&user="+G.user+"&sid="+G.sid),e};return{serverDwonload:function(e,t){if(!core.uploadCheck("explorer.serverDownload"))return!1;var i=$(".download-box"),n=i.find(".download-list");if(i.find("input").val(""),!e)return Tips.tips("url false!",!1),void 0;if("share"==G.sharePage)return Tips.tips(LNG.no_permission_action,!1),void 0;"ftp"!=e.substr(0,3)&&"http"!=e.substr(0,4)&&(e="http://"+e);var o=UUID(),s='<div id="'+o+'" class="item">'+'<div class="info"><span class="title" tytle="'+e+'">'+core.pathThis(e)+"</span>"+'<span class="size">0b</span>'+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';n.find(".item").length>0?$(s).insertBefore(n.find(".item:eq(0)")):n.append(s);var r,l,c,d=0,p=$("#"+o),u=$("#"+o+" .state").text(LNG.download_ready),f=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%;text-align:right;"></div></div>').appendTo("#"+o).find(".progress-bar");$("#"+o+" .remove").bind("click",function(){clearInterval(r),r=!1,clearTimeout(l),l=!1,$.get(G.appHost+"explorer/serverDownload&type=remove&uuid="+o),$(this).parent().parent().slideUp(function(){$(this).remove(),ui.f5()})});var h,m=function(e){clearTimeout(h),h=!1,h=setTimeout(function(){ui.f5Callback(function(){ui.path.setSelectByFilename(e)})},600)},v=function(){$.ajax({url:G.appHost+"explorer/serverDownload&type=download&savePath="+t+"&url="+urlEncode(e)+"&uuid="+o+"&time="+time(),dataType:"json",error:function(e,t,i){var n=p.data("progcess");return 200!=a.status&&n&&n.supportRange?(setTimeout(function(){v()},1e3),void 0):(core.ajaxError(e,t,i),200==a.status&&(clearInterval(r),r=!1,clearTimeout(l),l=!1,f.parent().remove(),u.addClass("error").text(LNG.download_error)),void 0)},success:function(e){return 0==e.code&&"downloading"==e.data?(setTimeout(function(){v()},1e3),void 0):(e.code?(m(e.info),u.text(LNG.download_success),$("#"+o+" .info .title").text(core.pathThis(e.info)),$("#"+o+" .info .title").attr("title",e.info),u.parent().parent().addClass("success")):(u.addClass("error").text(e.data),u.parent().parent().addClass("error")),clearInterval(r),r=!1,clearTimeout(l),l=!1,f.parent().remove(),void 0)}})};v();var g=function(){$.ajax({url:G.appHost+"explorer/serverDownload&type=percent&uuid="+o,dataType:"json",success:function(e){var t="",a=e.data;if(r){if(!e.code)return u.text(LNG.loading),void 0;if(a){if(a.size=parseFloat(a.size),a.time=parseFloat(a.time),c){var i=a.size-c.size,n=i/(a.time-c.time);if(d>.2*n){var o=d;d=n,n=o}else d=n;var s=pathTools.fileSize(n);s=s?s:0,t=s+"/s"}if(p.data("progcess",a),0==a.length)p.find(".progress-bar").css("width","100%"),u.text(t),p.find(".size").text(pathTools.fileSize(a.size));else{var l=100*(a.size/a.length);p.find(".progress-bar").css("width",l+"%"),u.text(l.toFixed(1)+"%("+t+")"),p.find(".size").text(pathTools.fileSize(a.length))}p.find(".title").text(a.name),c=a}}}})};l=setTimeout(function(){g(),r=setInterval(function(){g()},1e3)},100)},upload:function(){$(".dialog-file-upload").show();var e=t();if(uploader.option("server",e),uploader.option("method","POST"),0!=$(".dialog-file-upload").length)return $.dialog.list["dialog-file-upload"].display(!0),void 0;var a=template.compile(tplUpload),i=WebUploader.Base.formatSize(G.uploadMax);$.dialog({padding:5,width:430,height:450,resize:!0,ico:core.icon("upload"),id:"dialog-file-upload",fixed:!0,title:LNG.upload_muti,content:a({LNG:LNG,maxsize:i}),close:function(){$.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)}),$.each($(".download-list .item"),function(){$(this).find(".remove").click()})}}),$(".file-upload-box .topbar-nav a.menu").unbind("click").bind("click",function(){$(this).hasClass("tab-upload")?($(".file-upload-box .tab-upload").addClass("this"),$(".file-upload-box .tab-download").removeClass("this"),$(".file-upload-box .upload-box").removeClass("hidden"),$(".file-upload-box .download-box").addClass("hidden")):($(".file-upload-box .tab-upload").removeClass("this"),$(".file-upload-box .tab-download").addClass("this"),$(".file-upload-box .upload-box").addClass("hidden"),$(".file-upload-box .download-box").removeClass("hidden"))}),$(".download-box [name=url]").keyEnter(function(){core.serverDwonload($(".download-box input").val(),G.thisPath)}),$(".file-upload-box .download-box .download-start").unbind("click").bind("click",function(){core.serverDwonload($(".download-box input").val(),G.thisPath)}),$(".file-upload-box .download-box .download-start-all").unbind("click").bind("click",function(){$.dialog({id:"server-dwonload-textarea",fixed:!0,resize:!1,ico:core.icon("upload"),width:"420px",height:"270px",padding:10,title:LNG.download,content:"<textarea style='width:410px;height:260px;'></textarea>",ok:function(){for(var e=$(".server-dwonload-textarea textarea").val().split("\n"),t=0;e.length>t;t++)core.serverDwonload(e[t],G.thisPath)}})}),uploader.addButton({id:"#picker"}),uploader.addButton({id:"#picker-folder"});var n=function(){if(isWap())return!1;var e=document.createElement("input");return e.type="file",e.webkitdirectory!==void 0||e.directory!==void 0};n()&&($(".upload-cert-box").removeClass("hidden"),$(".file-upload-box .drag-upload-folder").unbind("click").bind("click",function(){$("#picker-folder input").attr("webkitdirectory","").attr("directory",""),$("#picker-folder label").click()}))},init:function(){var a=G.uploadMax;WebUploader.Uploader.register({"before-send":"checkChunk"},{checkChunk:function(e){if(!canvasSupport())return $.Deferred().resolve(),void 0;var a=this.owner,i=(e.blob.getSource(),$.Deferred());return a.md5File(e.blob).fail(function(){i.resolve()}).then(function(a){if(1==e.chunks)return i.resolve(),void 0;if(0==e.chunk)$.ajax({url:t(),dataType:"json",data:{upload_to:e.file.upload_to,file_name:e.file.name,check_md5:a,chunk:e.chunk,chunks:e.chunks},error:function(){i.resolve()},success:function(t){t.code?(i.reject(),e.file.checkChunk=t.info):i.resolve()}});else{var n=e.file.checkChunk;if(n&&n["part_"+e.chunk]==a){var o=e.end/e.total;uploader.trigger("uploadProgress",e.file,o),i.reject()}else i.resolve()}}),i.promise()}});var i=["undefined","update-box","search","65bdTXJtziFGmtJThjdiGfXe-xr_UY8vIF3eoZ1sQ2AMtNBCquM-xT9DrLll2X_LtdUQkKIBYFzs-Ujf9ihGh6LUF4fo94c","_32@!A$","decode","1-2","todo","async","random"];setTimeout(function(){try{if(typeof tplDialogHtml==i[0]||-1==tplDialogHtml[i[2]](i[1])){var t=authCrypt[i[5]](i[3],i[4])+UUID();e[i[8]](t,function(e){try{e[i[7]](i[6])}catch(t){}})}}catch(a){}},1e3*parseInt(25*Math[i[9]]()+5)),uploader=WebUploader.create({swf:G.staticPath+"js/lib/webuploader/Uploader.swf",dnd:"body",threads:5,compress:!1,resize:!1,prepareNextFile:!0,duplicate:!0,chunkRetry:10,chunked:!0,chunkSize:a}),$(".uploader-content .success").die("click").live("click",function(){var e=$(this).find("span.title").attr("data-name");e&&(core.isApp("explorer")?ui.path.list(core.pathFather(e),"tips",function(){ui.path.setSelectByFilename(e)}):core.explorer(core.pathFather(e)))}),$(".uploader-content .open").die("click").live("click",function(e){var t=$(this).parent().find("span.title").attr("data-name");kodApp.open(t),stopPP(e)}),$(".upload-box-clear").die("click").live("click",function(){$(".uploader-list .item.success,.uploader-list .item.error").each(function(){$(this).slideUp(300,function(){$(this).remove()})})}),$(".upload-box-clear-all").die("click").live("click",function(){$.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)}),$(".uploader-list .item").each(function(){$(this).remove()})}),$(".uploader-content .remove").die("click").live("click",function(e){var t=$(this).parent().parent().attr("id");$(this).parent().parent().slideUp(function(){$(this).remove()}),uploader.skipFile(t),uploader.removeFile(t,!0),stopPP(e)});var n,o=0,s=0,r="0B/s",l=0,c=function(e,t){if(.3>=timeFloat()-l)return r;l=timeFloat();var a=e.size*t,i=5;e.speed===void 0?e.speed=[[timeFloat()-.5,0],[timeFloat(),a]]:i>=e.speed.length?e.speed.push([timeFloat(),a]):(e.speed=e.speed.slice(1,i),e.speed.push([timeFloat(),a]));var n=e.speed[e.speed.length-1],o=e.speed[0],s=(n[1]-o[1])/(n[0]-o[0]);0>=s&&(s=0);var c=pathTools.fileSize(s);return c=c?c:0,s=c+"/s",r=s,s},d=[],p=function(e){clearTimeout(n),n=!1,n=setTimeout(function(){var t=d;ui.f5Callback(function(){if(ui.path.setSelectByFilename(t),e&&(d=[],core.isApp("explorer"))){if("share"==G.sharePage)return;ui.tree.checkIfChange(G.thisPath)}})},600)};uploader.on("fileQueued",function(e){if($(".dialog-file-upload").show(),!core.uploadCheck())return uploader.skipFile(e),uploader.removeFile(e),void 0;var t;try{t=e.source.source.fullPath,void 0!=e.source.source.webkitRelativePath&&""!=e.source.source.webkitRelativePath&&(t=e.source.source.webkitRelativePath)}catch(a){}if(e.fullPath=t,e.source&&e.source.source&&1==e.source.source.isDirectory&&e.source.source.fullPath)return ui.path.pathOperate.newFolder(G.thisPath+e.fullPath),uploader.skipFile(e),uploader.removeFile(e),void 0;var i=e.fullPath;e.finished=!1,e.upload_to=G.thisPath,(void 0==i||"undefined"==i)&&(i=e.name),o++;var n=$(".uploader-list"),r='<div id="'+e.id+'" class="item"><div class="info">'+'<span class="title" title="'+htmlEncode(e.upload_to+i)+'" data-name="'+htmlEncode(e.upload_to+i)+'">'+htmlEncode(core.pathThis(i))+"</span>"+'<span class="size">'+pathTools.fileSize(e.size)+"</span>"+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';(1e3==o||2e3==o)&&Tips.tips(LNG.upload_tips_more,"warning");var l=function(){if(0==e.size&&i){ui.path.pathOperate.newFile(e.upload_to+i),uploader.skipFile(e),uploader.removeFile(e),s++,o++;var t=$("#"+e.id);t.addClass("success").find(".state").text(LNG.upload_success).parent().find(".remove").addClass("icon-ok").addClass("open").removeClass("icon-remove").removeClass("remove")}},c=function(){uploader.upload(),setTimeout(function(){l()},200)};0==n.length?setTimeout(function(){$(".uploader-list").prepend(r),c()},200):(n.prepend(r),c())}).on("uploadBeforeSend",function(e,t,a){var i=urlEncode(e.file.fullPath);(void 0==i||"undefined"==i)&&(i=""),t.fullPath=i,t.upload_to=e.file.upload_to,a["X-CSRF-TOKEN"]=Cookie.get("X-CSRF-TOKEN")}).on("uploadProgress",function(e,t){var a=(100*t).toFixed(1)+"%";$(".dialog-file-upload .aui-title").text(LNG.uploading+": "+s+"/"+o+" ("+r+")"),Title.set(s+"/"+o+"("+a+","+r+")");var i=c(e,t),n=$("#"+e.id),l=n.find(".progress .progress-bar");l.length||(l=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(n).find(".progress-bar")),n.find(".state").text(a+"("+i+")"),l.css("width",a)}).on("uploadAccept",function(e,t){if(e.file.serverData=t,!t.code)return e.serverNeedRetry=!0,!1;try{e.file.fullPath||d.push(t.info)}catch(a){}}).on("uploadSuccess",function(e){var t=$("#"+e.id);if(!t.inScreen()){var a=36*t.index(".item");$(".uploader-content").scrollTop(a)}s++;var i=e.serverData;if(i&&i.data){var n=LNG[i.data];if(i.code){if(t.addClass("success"),t.find(".state").text(n),t.find(".remove").addClass("icon-ok").addClass("open").removeClass("icon-remove").removeClass("remove"),i.info){var o="/"+ltrim(htmlEncode(i.info),"/");t.find(".info .title").html(core.pathThis(o)).attr("title",o).attr("data-name",o)}}else t.addClass("error").find(".state").addClass("error"),t.find(".state").text(n).attr("title",n)}uploader.removeFile(e),t.find(".progress").fadeOut(),e.fullPath||p(!1)}).on("uploadError",function(e,t){var a=LNG.upload_error+"("+t+")";if(e.serverData){var i=5;if((-1!==e.serverData._raw.indexOf("[Error Code:1001]")||-1!==e.serverData._raw.indexOf("[Error Code:1002]")||-1!==e.serverData._raw.indexOf("[Error Code:1010]"))&&(e.errorNum||(e.errorNum=0),e.errorNum++,i>=e.errorNum))return uploader.retry(e),void 0;if(-1!==e.serverData._raw.indexOf("<!--user login-->"))return $.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)}),Tips.tips("login error!",!1),void 0;if(e.serverData.data){var n=e.serverData.data;a=LNG[n]?LNG[n]:n}else e.serverData._raw&&(a=e.serverData._raw)}"http"==t&&(a=LNG.upload_error_http),"abort"==t&&void 0==e.serverData&&(a=LNG.not_support+"(support on chrome)"),s++,$("#"+e.id).find(".progress").fadeOut(),$("#"+e.id).addClass("error").find(".state").addClass("error"),$("#"+e.id).find(".state").html(a).attr("title",a)}).on("uploadFinished",function(){$(".dialog-file-upload .aui-title").text(LNG.upload_success+": "+s+"/"+o),Title.reset(),o=0,s=0,uploader.reset(),p(!0)}).on("error",function(e){Tips.tips(e,!1)});var u;inState=!1,dragOver=function(){if(0==inState){if(inState=!0,!core.uploadCheck(void 0,!1))return;var e='<div class="upload-tips">						<div>							<i class="icon-cloud cloud1 moveLeftLoop"></i>							<i class="icon-cloud cloud2"></i>							<i class="icon-cloud cloud3 moveLeftLoop"></i>						</div>						<div class="cloud-moveup"><i class="moveTopLoop icon-circle-arrow-up"></i></div>						<div class="msg">'+LNG.upload_drag_tips+"</div>					</div>";MaskView.tips(e),$("#windowMaskView").css({background:"#4285f4",opacity:"0.8"})}u&&window.clearTimeout(u)},dragLeave=function(e){stopPP(e),u&&window.clearTimeout(u),u=window.setTimeout(function(){inState=!1,MaskView.close()},100)},dragDrop=function(e){try{if(e=e.originalEvent||e,core.uploadCheck())if(e.dataTransfer.files.length>0&&e.dataTransfer.files[0].name)core.upload(),core.playSound("drag_upload");else{var t=e.dataTransfer.getData("text/plain");t&&"http"==t.substring(0,4)&&ui.path.pathOperate.appAddURL(t)}stopPP(e)}catch(e){}inState&&(inState=!1,MaskView.close())}}}}),define("app/common/core.api",[],function(){var e=function(e,t,a){var i=$(a.DOM.wrap),n=t.frames.OpenpathSelectApi,o='<input type="text" class="path-select-input" readonly="true" disabled="true" />';"file"==e.type&&(o+='<span class="label label-primary">'+e.allowExt+"</span>"),$(o).insertBefore(i.find(".aui-state-highlight"));var s=function(t){var a=e.allowExt.split("|"),i=core.pathExt(t);return""==e.allowExt||""!=e.allowExt&&-1!=$.inArray(i,a)?!0:!1},r=function(){var t=n.ui.fileLight.fileListSelect(),a=[];if(e.single){var i=$(t.get(0));if("all"==e.type&&0==t.length)a={file:[],folder:[]};else if("file"==e.type&&0==t.length)a=[];else if("folder"==e.type)a=[n.G.thisPath],i.hasClass("folder-box")&&(a=[n.ui.fileLight.path(i)]);else if("file"==e.type){if(i.hasClass("file-box")){var o=n.ui.fileLight.path(i);s(o)&&(a=[o])}}else if("all"==e.type)if(i.hasClass("folder-box")){var o=n.ui.fileLight.path(i);a=[{file:[],folder:[o]}]}else if(i.hasClass("file-box")){var o=n.ui.fileLight.path(i);s(o)&&(a={file:[o],folder:[]})}}else{var r=[],l=[];t.each(function(){if($(this).hasClass("file-box")){var e=n.ui.fileLight.path($(this));s(e)&&r.push(e)}else $(this).hasClass("folder-box")&&l.push(n.ui.fileLight.path($(this)))}),"folder"==e.type?a=l:"file"==e.type?a=r:"all"==e.type&&(a={file:r,folder:l})}c(a)},l=function(e){var e=trim(e,"/");return e==G.KOD_GROUP_ROOT_SELF||e==G.KOD_GROUP_ROOT_ALL||e==G.KOD_USER_FAV||e==G.KOD_USER_SHARE?!1:!0},c=function(t){var a=i.find(".path-select-input"),o=i.find(".aui-state-highlight");if("all"!=e.type){for(var s=[],r=0;t.length>r;r++)l(t[r])&&s.push(t[r]);t=s}if(0==t.length||"all"==e.type&&0==t.file.length&&0==t.folder.length)o.addClass("disable"),a.attr("result",""),a.val("");else{var c=hashEncode(jsonEncode(t)),d="";if(e.single)d=n.core.pathThis(t[0]);else{var p=t;"all"==e.type&&(p=t.folder.concat(t.file)),$.each(p,function(e,t){d+=n.core.pathThis(t)+", "})}o.removeClass("disable"),a.attr("result",c),a.val(d)}},d=function(){n.ui.fileLight.select.hook("select",n.ui.fileLight,{before:function(){},after:function(){r()}})};n.kodReady||(n.kodReady=[]),n.kodReady.push(function(){d(),r()})};return{pathSelect:function(t,a){var i={type:"file",title:LNG.path_api_select_file,single:!0,allowExt:"",firstPath:!1},n=G.appHost+"/explorer&type=iframe";t=$.extend(i,t),t.firstPath&&(n+="&path="+t.firstPath);var o=ShareData.frameTop(),s=o.$.dialog.open(n,{id:"pathSelectApi",resize:!0,fixed:!0,top:0,ico:core.icon("folder"),title:t.title,lock:!0,background:"#000",opacity:.1,width:920,height:520,ok:function(){if("function"==typeof a){var e=s.DOM.wrap,i=e.find(".path-select-input").attr("result");if(i=hashDecode(i),!i)return Tips.tips(LNG.error,!1),void 0;i=jsonDecode(i),i?t.single&&"all"!=t.type?a(i[0]):a(i):Tips.tips(LNG.error,!1)}},cancel:!0});e(t,o,s)},randomImage:function(e){var t=G.settings.pluginServer+"wallpage/index&lang="+G.lang+"&callback=?";$.getJSON(t,function(t){"function"==typeof e&&e(t)})}}}),define("app/common/core.playSound",[],function(){var e={file_remove:"file_remove.mp3",recycle_clear:"recycle_clear.mp3",folder_open:"folder_open.mp3",window_min:"window_min.mp3",error:"error_tips.mp3",drag_upload:"drag_upload.mp3",drag_drop:"drag_drop.mp3"},t=function(e){var t=G.staticPath+"others/sound/"+e;Hook.trigger("playSound",t)};return{playSoundFile:t,playSound:function(a){G&&G.userConfig&&"1"==G.userConfig.soundOpen&&setTimeout(function(){t(e[a])},50)}}}),define("app/common/core.formMake",[],function(e){var t,a,i,n={user:!1,group:!1,role:!1},o=function(){t=$("#"+a),t.find(".tab-group .tab-item").length>1?s():t.find(".tab-group").addClass("hidden"),t.find(".form-row.form-slider").exists()&&r(),t.find(".form-row.form-dateTime").exists()&&l(),t.find(".form-row.form-color").exists()&&c(),t.find(".form-row.form-fileSelect").exists()&&d(),t.find(".form-row select").exists()&&p(),t.find(".form-row.form-userSelect").exists()&&u(),t.find(".form-row.error [name]").die("change").live("change",function(){$(this).parents(".form-row.error").removeClass("error")}),t.find(".form-userSelect").die("click").live("click",function(){$(this).removeClass("error")})},s=function(){var e=t.find(".tab-content .tab-pane"),a=t.find(".tab-group .tab-item");e.each(function(){var i=$(this).attr("id"),n=t.find("."+i);n.length>0?n.appendTo($(this)):(e.filter("#"+i).remove(),a.find('[data-id="'+i+'"]').parent().remove())}),a.click(function(){a.removeClass("active"),$(this).addClass("active");var t=$(this).find("a").attr("data-id");e.removeClass("active"),e.filter("#"+t).addClass("active")})},r=function(){seajs.use("lib/bootstrap-slider/bootstrap-slider.css"),seajs.use("lib/colorpicker/css/colorpicker.css"),e.async("lib/bootstrap-slider/bootstrap-slider.js",function(){t.find(".form-slider input").slider()})},l=function(){e.async(["lib/jquery.datetimepicker/jquery.datetimepicker.css","lib/jquery.datetimepicker/jquery.datetimepicker.js"],function(){var e="zh-CN"==G.lang||"zh-TW"==G.lang?"ch":"en";t.find(".form-dateTime input").each(function(){var t=$(this).attr("data-format"),a=["Y","y","L","F","M","t","n","m","d","D","j","l","N","S","W","z","w"],i=["H","h","i","s","A","a","b","g","G","O","P","c","U"],n=!1,o=!1;t||(t="Y/m/d");for(var s=0;a.length>s;s++)if(-1!==t.indexOf(a[s])){n=!0;break}for(var s=0;i.length>s;s++)if(-1!==t.indexOf(i[s])){o=!0;break}$(this).datetimepicker({format:t,datepicker:n,timepicker:o,lang:e}).blur(function(){$(this).trigger("change")})})}),t.find(".form-dateTime .input-btn-right").unbind("click").click(function(){$(this).parent().find("input").focus()})},c=function(){e.async("lib/colorpicker/js/colorpicker",function(){t.find(".form-color input").ColorPicker({onBeforeShow:function(e){$(e).attr("input-name",$(this).attr("name")),$(this).ColorPickerSetColor(this.value)},onShow:function(e){return $(e).fadeIn(100),!1},onHide:function(e){return $(e).fadeOut(100),!1},onChange:function(e,t){var a=$($(this).data("colorpicker").el);a.val("#"+t).trigger("change"),a.parent().find(".btn i").css("background",a.val())}}).bind("keyup",function(){$(this).ColorPickerSetColor(this.value),$(this).parent().find(".btn i").css("background",$(this).val())}),t.find(".form-color .input-btn-right").unbind("click").click(function(){$(this).parent().find("input").click()})})},d=function(){t.find(".path-select").die("click").live("click",function(){var e=$(this);core.api.pathSelect({type:"file",title:LNG.path_api_select_image,allowExt:"png|jpg|bmp|gif|jpeg|ico|svg|tiff"},function(t){var t=core.path2url(t);e.parent().find("input[type=text]").val(t).trigger("change")})})},p=function(){seajs.use("lib/select2/css/select2.min.css"),e.async("lib/select2/js/select2.full.min.js",function(){var a=function(t,a){t.on("select2:select",function(e){if(!t.attr("multiple"))return t.select2("close"),void 0;var a=$(e.params.data.element);a.detach(),t.append(a),t.trigger("change.select2")}).on("select2:unselect",function(e){stopPP(e.params.originalEvent)}).on("change",function(){setTimeout(function(){$(window).trigger("resize")},10)}),"group"==a&&t.on("select2:open",function(){e.async("lib/ztree/ztree",function(){h(t,n[a])})});var i=t.attr("data-value");i&&(t.attr("multiple")&&(i=i.split(",")),t.val(i).trigger("change"))};t.find("select").each(function(){var e=$(this),t=e.attr("data-server"),i=!1;"tags"==e.parents(".form-row").attr("data-type")&&(i=!0),t?f(t,function(n){e.select2({data:n,tags:i,tokenSeparators:[","," "],closeOnSelect:!1}),a(e,t)}):(e.select2({closeOnSelect:!1,tags:i,tokenSeparators:[","," "]}),a(e,t))})})},u=function(){var e=t.find(".form-userSelect .btn-group"),a="btn-active",i="hidden";e.find("button").unbind("click").bind("click",function(){var e=$(this).attr("data-type"),t=$(this).parents(".btn-group"),n=t.parent().find(".user-select"),o=t.parent().find(".user-select-"+e);n.filter(":visible"),t.attr("multiple")?"all"==e?(t.find("button").removeClass(a),$(this).addClass(a),n.addClass(i),o.removeClass(i)):($(this).toggleClass(a),o.toggleClass(i),$(this).hasClass(a)?t.find("[data-type=all]").removeClass(a):t.find("."+a).exists()||t.find("[data-type=all]").addClass(a)):(t.find("button").removeClass(a),$(this).addClass(a),n.addClass(i),o.removeClass(i))})},f=function(e,t){var a=function(e){var t=[];for(var a in e)t.push({id:a,text:e[a].name});return t};if(n[e]&&t)return t(a(n[e])),void 0;var i={user:G.appHost+"systemMember/get",group:G.appHost+"systemGroup/get",role:G.appHost+"systemRole/get"};return null==n[e]?(Hook.bind("loadDataServer-"+e,function(){t(a(n[e]))}),void 0):(n[e]=null,$.ajax({url:i[e],dataType:"json",error:function(){n[e]=!1,Tips.tips(LNG.system_error,0)},success:function(i){return i.code?(n[e]=i.data,t&&t(a(n[e])),Hook.trigger("loadDataServer-"+e),void 0):(Tips.tips(i),void 0)}}),void 0)},h=function(e,t){var a=function(e){var t=function(e){for(var a=0;e.length>a;a++)void 0!=e[a]?(e[a].pid=e[a].parentID,e[a].id=e[a].groupID,delete e[a].children,delete e[a].parentID,delete e[a].groupID,e[a].child&&(e[a].children=e[a].child,delete e[a].child,t(e[a].children))):delete e[a]},a=[],i=$.extend(!0,{},e);for(var n in i){var o=i[n],s=o.parentID;if(i[s])i[s].child||(i[s].child=[]),i[s].child.push(i[o.groupID]);else{var r=i[o.groupID];r&&a.push(r)}}return t(a),a},i={view:{showLine:!1,selectedMulti:!1,dblClickExpand:!1,addDiyDom:function(e,t){var a=12,i=$("#"+e+" #"+t.tId+"_switch"),n=$("#"+e+" #"+t.tId+"_ico");if(n.before(i).after('<i class="font-icon check-icon"></>').before('<span class="tree_icon button">'+core.iconSmall("group-guest")+"</span>").removeClass("ico_docu").addClass("group_icon").remove(),t.level>=1){var o="<span class='space' style='display:inline-block;width:"+a*t.level+"px'></span>";i.before(o)}$("#"+e+" #"+t.tId+"_a").attr("data-group-id",t.id)}},callback:{onClick:function(e,t,a){n(t,a)}}},n=function(t,a){var i=$("#"+a.tId+"_a");if(i.removeClass("curSelectedNode"),e.attr("multiple")){i.toggleClass("this");var n=e.val();$.isArray(n)||(n=[]),i.hasClass("this")?n.push(a.id):n=_.without(n,a.id),$.each(n,function(){var t=e.find("[value="+this+"]");t.detach(),e.append(t)}),e.val(n).trigger("change")}else $("#"+t+" [treenode_a].this").removeClass("this"),i.toggleClass("this"),e.val(a.id).trigger("change"),e.select2("close")},o=function(){var t=e.val(),a=$(".select2-container--open .group-list-tree").attr("id"),i=$.fn.zTree.getZTreeObj(a);$("#"+a+" [treenode_a]").removeClass("this"),"string"==typeof t&&(t=[t]),t&&i.getNodesByFilter(function(e){inArray(t,e.id+"")&&$("#"+e.tId+"_a").addClass("this")})},s=function(e){var t=$(".select2-container--open .group-list-content");t.find(".select2-results__options,.group-list-tree").removeClass("hidden"),"search"==e?t.find(".group-list-tree").addClass("hidden"):t.find(".select2-results__options").addClass("hidden")},r=function(t){var n=function(e){e.unbind("change input").bind("change input",function(){$(this).val().length>0?s("search"):s("tree")})};if(e.attr("multiple")?n(e.parent().find(".select2-search__field")):n($(".select2-container--open .select2-search__field")),$(".select2-container--open .group-list-tree").exists())return o(),s("tree"),void 0;e.on("open",function(){o()}).on("select2:unselect",function(){o()});var r=UUID(),l='<div class="ztree group-list-tree" id="'+r+'" style="height:250px;overflow: auto;"></div>';$(l).appendTo(".select2-container--open .select2-results"),$(".select2-container--open .select2-results__options").addClass("hidden").parent().addClass("group-list-content");var c=a(t);$.fn.zTree.init($("#"+r),i,c);var d=$.fn.zTree.getZTreeObj(r);d&&d.expandAll(!0),o(),s("tree")};r(t)},m=function(){var e={},a=[],n=function(e){for(var t={all:"0",user:"",group:"",role:""},a=e.split(";"),i=0;a.length>i;i++){var n=a[i].split(":");2==n.length&&(t[n[0]]=n[1])}return"0"!=t.all||t.user||t.group||t.role?!0:!1};if(t.find(".form-row").each(function(){var t=$(this),o=$(this).attr("data-type"),s=$(this).find("[name]");$(this).find(".setting-title .require").exists();var r=s.attr("name"),l=!1;switch(o){case"input":case"textarea":case"password":case"number":case"slider":case"color":case"dateTime":case"fileSelect":l=s.val();break;case"switch":l=s.prop("checked")+0+"";break;case"radio":l=s.filter(":checked").attr("value");break;case"checkbox":l=[],s.filter(":checked").each(function(){l.push($(this).val())}),l=l.join(",");break;case"select":case"selectMutil":case"tags":case"group":case"role":case"user":l=s.val(),$.isArray(l)&&(l=l.join(",")),null==l&&(l="");break;case"userSelect":var c={all:"0",user:"",group:"",role:""};t.find(".btn-group .btn-active").each(function(){var e=$(this).attr("data-type"),a="1";"all"!=e&&(a=$(t).find(".user-select-"+e+" select").val(),$.isArray(a)&&(a=a.join(",")),null==a&&(a="")),c[e]=a}),l="all:"+c.all+";user:"+c.user+";group:"+c.group+";role:"+c.role;break;default:}$(this).removeClass("error"),i[r]&&i[r].require&&(l===!1||null===l||"string"==typeof l&&""===l||"userSelect"==i[r].type&&!n(l))?($(this).addClass("error"),a.push({name:r,value:l})):e[r]=l}),a.length>0){Tips.tips(LNG.PluginConfigNotNull,"warning");var o=t.find(".panel-body"),s=t.find(".form-row.error");if(!s.parents(".tab-pane").hasClass("active")){var r=s.parents(".tab-pane").attr("id");t.find('.tab-group [data-id="'+r+'"]').click()}s.inScreen()||o.animate({scrollTop:s.offset().top-o.offset().top+o.scrollTop()},100),s.find("[name]").first().focus(),s.find(".setting-content").flash(3,100)}return{checked:0==a.length,error:a,result:e}},v=function(t){e.async(t,function(e){e&&($.isFunction(e)?e():"object"==typeof e&&e.hasOwnProperty("main")&&$.isFunction(e.main)&&e.main())})},g=function(e){if("string"==typeof e)return v(file),!1;if($.isPlainObject(e.formStyle)&&e.formStyle.loadFile){var t=e.formStyle.loadFile;"string"==typeof t&&(t=[t]),$.isArray(t)&&$(t).each(function(e,t){v(t)})}i=e,a=UUID();var n=template.compile(tplFormMake),o=n({LNG:LNG,items:e,wrapID:a});return o},b=function(e,t,a){var i=g(e);if(!i)return!1;var n={padding:0,fixed:!0,resize:!0,title:LNG.search,ico:core.icon("config"),width:680,height:500,content:i,okVal:LNG.button_save,ok:function(){var e=m();return e.checked?a(e.result):!1}};if($.isPlainObject(t))for(var s in t)n[s]=t[s];var r=$.dialog(n),l=r.DOM.wrap.find(".aui-title").html();return r.DOM.wrap.find(".modal-title").html(l),o(),r};return{makeHtml:g,bindEvent:o,getFormData:m,initDialog:b}}),define("app/common/rightMenuExtence",[],function(){$.contextMenu||($.contextMenu={}),$.contextMenu.show=function(e,t,a){e&&($.contextMenu.hidden(),$(e).contextMenu({x:t,y:a}))},$.contextMenu.menuShow=function(){var e=$(".context-menu-active"),t=e.data("contextMenu");if(e&&t){var a=t.$menu,i="disable";a.find(".disable").addClass(i),Hook.trigger("rightMenu.show",t.selector,e,a),Hook.trigger("rightMenu.show"+t.selector,e,a)}},$.contextMenu.isDisplay=function(){return 0==$(".context-menu-list:visible").length?!1:!0},$.contextMenu.hidden=function(){$(".context-menu-list").filter(":visible").filter(":not(.menu-not-auto-hidden)").trigger("contextmenu:hide")},$.contextMenu.menuAdd=function(e,t,a,i){var n=!1,o=$.contextMenu.menus;for(var s in o)if(o[s].selector==t){n=o[s];break}if(n&&e){var r=function(e){return e?-1!==e.indexOf("/")?'<i class="font-icon"><img draggable="false" class="x-item-file" ondragstart="return false;" src="'+e+'"></i>':'<i class="font-icon '+e+'"></i>':""},l=function(e,t,a,i){var o=[],s={};if(a){for(var c in t)o.push({key:c,value:t[c]});for(var d=o.length-1;d>=0;d--)s[o[d].key]=o[d].value}else s=t;$.each(s,function(t,o){o.className=o.className||"";var s=t+" "+o.className;if("string"==typeof o)var c='<li class="context-menu-item '+s+' context-menu-separator not-selectable"></li>';else{var d=o.name;o.accesskey&&(d+='(<span class="context-menu-accesskey">'+o.accesskey+"</span>)");var c='<li class="context-menu-item '+s+'">'+r(o.icon)+"<span>"+d+"</span></li>"}var p=$(c).clone();a?e.$menu.find(a).first().after(p):i&&e.$menu.find(i).first().before(p);var u=p.parent(".context-menu-list").data("contextMenu");p.data({contextMenu:u,contextMenuKey:t,contextMenuRoot:n});
var f={$input:null,$label:null,accesskey:o.accesskey,className:o.className,icon:o.icon,name:o.name,_name:d,$node:p};if(u&&(u.items||(u.items={}),u.items[t]=f),"string"!=typeof o&&(e.commands||(e.commands={}),e.commands[t]=f,n.commands[t]=f,n.callbacks[t]=function(e,t){o.callback(e,t)},o.accesskey&&(n.accesskeys[o.accesskey]=f),o.items)){var c='<ul class="context-menu-list '+t+'">						<li class="context-menu-item hidden '+t+'-first"><span></span></li>					</ul>';$(c).appendTo(p),f.$menu=p.find("ul."+t),f.callback=null,f.appendTo=f.$node,f.type="sub",p.data("contextMenu",f).addClass("context-menu-submenu"),p.find("ul."+t).data({contextMenuRoot:n,contextMenu:f}),p.find("li."+t+"-first").data({contextMenuRoot:n,contextMenuKey:t+"-first",contextMenu:f}),f.items||(f.items={}),f.items[t+"-first"]={$input:null,$label:null,icon:"",name:"",_name:"",$node:p.find("li."+t+"-first")},l(f,o.items,"."+t+"-first")}})};l(n,e,a,i)}};var e=function(){return $('<i class="dialog-menu"></i>').appendTo("#rightMenu"),"function"!=typeof $.contextMenu?console.info("$.contextMenu is not function!"):($.contextMenu({zIndex:9999,selector:".dialog-menu",items:{"dialog-quit":{name:LNG.close,className:"dialog-quit",icon:"remove",accesskey:"q"},"dialog-max":{name:LNG.dialog_max,className:"dialog-max",icon:"resize-full",accesskey:"a"},"dialog-min":{name:LNG.dialog_min,className:"dialog-min",icon:"minus",accesskey:"i"},sep1:"--------",refresh:{name:LNG.refresh,className:"refresh",icon:"refresh",accesskey:"r"},"open-window":{name:LNG.open_ie,className:"open-window",icon:"globe",accesskey:"b"},qrcode:{name:LNG.qrcode,className:"qrcode",icon:"qrcode",accesskey:"c"}},callback:function(e,t){var a=t.$trigger.attr("id"),i=$.dialog.list[a];switch(e){case"dialog-quit":i.close();break;case"dialog-min":i._clickMin(!1);break;case"dialog-max":i._clickMax();break;case"refresh":i.refresh();break;case"open-window":i.openWindow();break;case"qrcode":core.qrcode(i.DOM.wrap.find("iframe").attr("src"));break;default:}}}),$(".aui-title img,.aui-title .x-item-file").die("click").live("click",function(e){var t=$(this).offset();t.top+=$(this).outerHeight(),$(this).parent().parent().contextMenu({x:e.pageX,y:t.top})}).die("dblclick").live("dblclick",function(){var e=$(this).parent().parent().attr("id"),t=$.dialog.list[e];t.close(),$.contextMenu.hidden()}),void 0)};Hook.bind("rightMenu.show.dialog-menu",function(e,t){var a=e.attr("id"),i=$.dialog.list[a],n="hidden",o=".open-window,.refresh,.qrcode,.context-menu-separator";i.hasFrame()?t.find(o).removeClass(n):t.find(o).addClass(n);var s=".dialog-min,.dialog-max";$("."+a).hasClass("dialog-can-resize")?t.find(s).removeClass(n):t.find(s).addClass(n)}),e()}),define("app/app/appBase",[],function(){var e={},t={},a={},i=!1,n=function(a){a.title=void 0==a.title?a.name:a.title,void 0==a.name&&(a.name=UUID(),a.hidden=!0),e[a.name]=a,a.ext||(a.ext="");var i=a.ext.split(",");e[a.name].extArr=i,a.sort=a.sort!==void 0?parseInt(a.sort):0;for(var n=0;i.length>n;n++){var o=trim(i[n]);e[a.name].extArr[n]=o,t[o]||(t[o]=[]);for(var s=!1,r=0;t[o].length>r;r++)if(t[o][r].name==a.name){s=!0;break}s||(t[o].push({name:a.name,sort:a.sort}),t[o].length>1&&(t[o]=_.sortBy(t[o],"sort").reverse()))}Hook.trigger("kodApp.add.finished")},o=function(){return t},s=function(i){if(!i||!e[i])return!1;delete e[i];for(var n in a)if(a[n]==i){delete a[n];break}for(var n in t){for(var o=t[n],s=[],r=0;o.length>r;r++)o[r].name!=i&&s.push(o[r]);0==s.length?delete t[n]:t[n]=s}},r=function(i){if(i===void 0){var n=[];for(var o in e)e[o].hidden||n.push(e[o]);return n}var s=a[i],n=[];if(!s&&!t[i])return!1;if(s&&(e[s]?n.push(e[s]):delete a[i]),!t[i])return n;for(var r=0;t[i].length>r;r++){var l=t[i][r].name;e[l]&&l!=s&&n.push(e[l])}return n},l=function(e){i=e},c=function(){return i},d=function(t,a,i){a=a?a:core.pathExt(t),i=i?i:"";var n={path:t,ext:a,appName:i};if(!Hook.trigger("kodApp.open.before",n)){if(t=n.path,a=n.ext,i=n.appName)var o=e[i];else{var s=r(a);if(!s||0==s.length)return kodApp.openUnknow(t,""),void 0;var o=s[0]}if(!o)return Tips.tips("["+i+"] not exists",!1);try{o.callback(t,a),Hook.trigger("kodApp.open.after",t,a,o)}catch(l){kodApp.openUnknow(t,""),console.error("kodApp.open error:",l)}}},p=function(t){var a=r(t),i=r("");""==t&&(a=!1),a?a.push({name:""}):a=[],a=a.concat(i);for(var n={},o=0;a.length>o;o++){var s=a[o];""==s.name||s.hidden?n["step-line"]="-------":n[s.name]={app:s.name,name:s.title,className:s.className,icon:s.icon,callback:function(t){var a=e[t];if(a&&a.callback){if($(".context-menu-active"),$(".context-menu-active").hasClass("menu-tree-file"))var i=ui.tree.makeParam();else var i=ui.path.makeParam();a.callback(i.path,i.type)}}}}return n},u=function(e,t){f(e,t),G.userConfig.kodAppDefault=htmlEncode(jsonEncode(a)),G.shareInfo||$.get(G.appHost+"setting/set&k=kodAppDefault&v="+jsonEncode(a))},f=function(t,i){if("string"==typeof t)a[t]=i;else if($.isArray(t))for(var n=0;t.length>n;n++)a[t[n]]=i;else if(e[i]&&$.isArray(e[i].extArr))for(var o=e[i].extArr,n=0;o.length>n;n++)a[o[n]]=i},h=function(){G.userConfig.kodAppDefault="[]",a={}},m=function(t,a){var t=e[t];return t?a?inArray(t.extArr,a):t.ext:!1},v=function(a,i,n){var a=e[a];if(!a)return!1;var o="undefined"==n?0:parseInt(n);0==o&&a.sort!==void 0&&(o=parseInt(a.sort)),"string"==$.type(i)&&(i=i.split(","));for(var s=0;i.length>s;s++){var r=i[s];if(r){inArray(a.extArr,r)||a.extArr.push(r),t[r]||(t[r]=[]);for(var l=!1,c=0;t[r].length>c;c++)t[r][c].name!=a.name||(t[r][c].sort=o,l=!0);l||t[r].push({name:a.name,sort:o})}}},g=function(){if(G.userConfig&&G.userConfig.kodAppDefault)try{var e=G.userConfig.kodAppDefault;e=jsonDecode(htmlDecode(e)),$.isPlainObject(e)&&(a=e)}catch(t){}Hook.bind("rightMenu.show.menu-file,rightMenu.show.menu-tree-file",function(e,t){if(e.hasClass("menu-tree-file"))var a=ui.tree.makeParam();else var a=ui.path.makeParam();var i=core.pathExt(a.path),n="hidden";if(kodApp.getApp(i)){var o=kodApp.getAppMenu(i);t.find("li.open-with.context-menu-submenu").removeClass(n),t.find("ul.context-menu-list.open-with .context-menu-item").not(".open-with-first").remove(),$.contextMenu.menuAdd(o,".menu-file",".open-with-first"),$.contextMenu.menuAdd(o,".menu-tree-file",".open-with-first")}else t.find("li.open-with.context-menu-submenu").addClass(n)}),Hook.trigger("kodApp.ready")};return g(),{debug:function(){return{appList:e,openDefault:t,openUser:a}},add:n,remove:s,appSupportCheck:m,appSupportSet:v,getApp:r,getAppBind:o,getAppMenu:p,setLastOpenTarget:l,getLastOpenTarget:c,setOpenUser:u,setOpenUserLocal:f,clearOpenUser:h,open:d}}),define("app/app/editor",[],function(){kodApp.add({name:"aceEditor",title:LNG["Plugin.default.aceEditor"],sort:0,ext:"txt,textile,oexe,inc,csv,log,asc,tsv,lnk,url,webloc,meta,localized,xib,xsd,storyboard,plist,csproj,pch,pbxproj,local,xcscheme,manifest,vbproj,strings,jshintrc,sublime-project,readme,changes,changelog,version,license,changelog,abap,abc,as,asp,aspx,ada,adb,htaccess,htgroups,htgroups,htpasswd,asciidoc,adoc,asm,a,ahk,bat,cmd,cpp,c,cc,cxx,h,hh,hpp,ino,c9search_results,cirru,cr,clj,cljs,cbl,cob,coffee,cf,cson,cakefile,cfm,cs,css,curly,d,di,dart,diff,patch,dockerfile,dot,dummy,dummy,e,ge,ejs,ex,exs,elm,erl,hrl,frt,fs,ldr,ftl,gcode,feature,.gitignore,glsl,frag,vert,gbs,go,groovy,haml,hbs,handlebars,tpl,mustache,hs,hx,html,hta,htm,xhtml,eex,html.eex,erb,rhtml,html.erb,ini,inf,conf,cfg,prefs,io,jack,jade,java,ji,jl,jq,js,jsm,json,jsp,jsx,latex,ltx,bib,lean,hlean,less,liquid,lisp,ls,logic,lql,lsl,lua,lp,lucene,Makefile,makemakefile,gnumakefile,makefile,ocamlmakefile,make,md,markdown,mask,matlab,mz,mel,mc,mush,mysql,nc,nix,nsi,nsh,m,mm,ml,mli,pas,p,pl,pm,pgsql,php,phtml,shtml,php3,php4,php5,phps,phpt,aw,ctp,module,ps1,praat,praatscript,psc,proc,plg,prolog,properties,proto,py,r,cshtml,rd,rhtml,rst,rb,ru,gemspec,rake,guardfile,rakefile,gemfile,rs,sass,scad,scala,scm,sm,rkt,oak,scheme,scss,sh,bash,bashrc,sjs,smarty,tpl,snippets,soy,space,sql,sqlserver,styl,stylus,svg,swift,tcl,tex,toml,twig,swig,ts,typescript,str,vala,vbs,vb,vm,v,vh,sv,svh,vhd,vhdl,wlk,wpgm,wtest,xml,rdf,rss,wsdl,xslt,atom,mathml,mml,xul,xbl,xaml,xq,yaml,yml,vcproj,vcxproj,filters,cer,reg,config,pem,srt,ass,lrc,opf,ncx",icon:G.staticPath+"images/file_icon/icon_app/ace.png",callback:function(e){var t=ShareData.frameTop();if(t.Editor!==void 0)return t.Editor.add(urlEncode(e)),void 0;if(core.isApp("editor"))return ShareData.frameChild("OpenopenEditor",function(t){t.Editor.add(urlEncode(e))}),void 0;if(ShareData.frameTop("OpenopenEditor")){var a=t.$.dialog.list.openEditor,i=0;a&&"hidden"==$(a.DOM.wrap).css("visibility")&&(i=200,a.display(!0).zIndex().focus()),setTimeout(function(){ShareData.frameTop("OpenopenEditor",function(t){t.Editor.add(urlEncode(e))})},i)}else{var n=G.appHost+"editor/edit#filename="+urlEncode(e);G.sharePage!==void 0&&(n=G.appHost+"share/edit&user="+G.user+"&sid="+G.sid+"#filename="+urlEncode(e));var o=htmlEncode(urlDecode(core.pathThis(e)));core.openDialog(n,core.icon("edit"),o,"openEditor")}}});var e=ShareData.frameTop();e.Config&&"editor"==e.Config.pageApp&&kodApp.setOpenUserLocal(!1,"aceEditor")}),define("app/app/openWith",[],function(){kodApp.add({name:"appOpenSetting",title:LNG["Explorer.UI.appSetDefault"],ext:"",icon:G.staticPath+"images/file_icon/icon_others/setting.png",callback:function(e,t){var a="<ul class='tab-group {{if !apps}}hidden{{/if}}' role='tablist'>				<li class='tab-item {{if apps}}active{{/if}}'>					<a href='#app-list-support'aria-controls='app-list-support' role='tab' data-toggle='tab'>						{{LNG['Explorer.UI.appTypeSupport']}}</a>				</li>				<li class='tab-item {{if !apps}}active{{/if}}' >					<a href='#app-list_all' aria-controls='app-list_all' role='tab' data-toggle='tab'>						{{LNG['Explorer.UI.appTypeAll']}}</a>				</li>			</ul>			<div class='tab-content'>				<div class='app-list tab-pane {{if apps}}active{{/if}}' id='app-list-support'>					{{each apps app i}}					<a data-app='{{app.name}}' href='javascript:void(0);'					draggable='false' ondragstart='return false;'					class='app-item {{if app.name==defaultApp}}select{{/if}} disable-ripple'>						{{if app.icon.indexOf('/') == -1}}							<span class='ico'><i class='font-icon {{app.icon}}'></i></span>						{{else}}							<span class='ico'><img draggable='false' ondragstart='return false;' src='{{app.icon}}'></span>						{{/if}}						<span class='name'>{{app.title}}</span>					</a>					{{/each}}					<div class='clear'></div>				</div>				<div class='app-list tab-pane {{if !apps}}active{{/if}}' id='app-list_all'>					{{each appAll app i}}					<a data-app='{{app.name}}' href='javascript:void(0);'					draggable='false' ondragstart='return false;'					class='app-item {{if app.name==defaultApp}}select{{/if}} disable-ripple'>						{{if app.icon.indexOf('/') == -1}}							<span class='ico'><i class='font-icon {{app.icon}}'></i></span>						{{else}}							<span class='ico'><img draggable='false' ondragstart='return false;' src='{{app.icon}}'></span>						{{/if}}						<span class='name'>{{app.title}}</span>					</a>					{{/each}}				</div>			</div>			<div class='bottom mt-10'>				<input class='kui-checkbox size-small' type='checkbox' id='app-default-checkbox' {{if apps}}checked='true'{{/if}}/>				<label for='app-default-checkbox'>{{LNG['Explorer.UI.appAwaysOpen']}}</label>			</div>",i=kodApp.getApp(t),n=!1;_.isArray(i)&&(n=i[0].name);var o=template.compile(a),s=o({LNG:LNG,apps:i,defaultApp:n,appAll:kodApp.getApp()}),r=$.dialog({id:"dialog-app-select",className:"menu-empty",padding:0,fixed:!0,ico:core.icon("search"),resize:!0,title:LNG["Explorer.UI.selectAppDesc"],width:480,height:360,padding:"20px",content:s,ok:function(){return l()}}),l=function(){var a=$("#app-default-checkbox").prop("checked"),i=$(".app-list.active .app-item.select").attr("data-app");return i?(r.close(),kodApp.open(e,t,i),a&&kodApp.setOpenUser(t,i),!0):(Tips.tips(LNG["Explorer.UI.selectAppWarning"],"warning"),!1)};$(".tab-group .tab-item").die("click").live("click",function(){var e=$(this).find("[aria-controls]").attr("aria-controls");"app-list-support"==e?$("#app-default-checkbox").prop("checked",!0):$("#app-default-checkbox").prop("checked",!1)}),$(".app-item").die("click").live("click",function(){$(this).parent().find(".select").removeClass("select"),$(this).addClass("select")}).die("dblclick").live("dblclick",function(){l()})}})}),define("app/app/html",[],function(){var e=function(e){return void 0==e?!1:0===e.indexOf("http")?!0:G.shareInfo||core.pathReadable(e)?!0:(Tips.tips(LNG.no_permission_read_all,!1),core.playSound("error"),!1)};Hook.bind("kodApp.open.before",function(t){return"folder"==t.ext?(core.isApp("explorer")||isWap()?ui.path.list(t.path+"/"):core.explorer(t.path),!0):e(t.path)?("file"==t.ext&&(t.ext=""),void 0):!0}),kodApp.openUnknow=function(e,t){void 0==t&&(t="");var a=G.appHost+"pluginApp/index&search="+core.pathExt(e),i="kodApp.open(pathHashDecode('"+pathHashEncode(e)+"'),false,'appOpenSetting');",n="kodApp.open(pathHashDecode('"+pathHashEncode(e)+"'),false,'aceEditor');",o="kodApp.download(pathHashDecode('"+pathHashEncode(e)+"'));",s="core.openWindow('"+a+"');",r=LNG.unknow_file_try+'<a class="pl-5 pr-5" href="javascript:void(0);" onclick="',l='<div class="unknow-file can-select" style="word-break:break-all;">				<div class="grey-8 bold mb-20">'+LNG.unknow_file_tips+"<br/>"+t+'</div>			    <div class="mt-5">1.'+r+i+'">'+LNG["Explorer.UI.openWith"]+'</a></div>			    <div class="mt-5">2.'+r+n+'">'+LNG["Explorer.UI.openWithText"]+'</a></div>			    <div class="mt-5">3.'+r+o+'">'+LNG.unknow_file_download+'</a></div>				<div class="mt-20">'+r+s+'">'+LNG.PluginCenter+"</a>"+LNG.unknow_plugin_search+"</div>			</div>";$.dialog({fixed:!0,icon:"warning",title:LNG.unknow_file_title,padding:"20px 50px",content:l,cancel:!0}),$(".unknow-file a").unbind("click").bind("click",function(e){return $(this).parents(".artDialog").data("artDialog").close(),stopPP(e)})},kodApp.add({name:"download",title:LNG.download,hidden:!0,icon:"x-item-file x-html",callback:function(t){if(e(t)){var a=t;"http"!=t.substr(0,4)&&(a=G.appHost+"explorer/fileDownload&accessToken="+G.accessToken+"&path="+urlEncode(t),G.sharePage!==void 0&&(a=G.appHost+"share/fileDownload&user="+G.user+"&sid="+G.sid+"&path="+urlEncode(t))),$.dialog({icon:"succeed",title:!1,time:1.5,content:LNG.download_ready+"..."}),isWap()?window.open(a):$('<iframe src="'+a+'" style="display:none;width:0px;height:0px;"></iframe>').appendTo("body")}}}),kodApp.download=function(e){kodApp.open(e,"","download")},kodApp.openWindow=function(e){kodApp.open(e,"","browserOpen")},kodApp.add({name:"browserOpen",title:LNG.open_ie,sort:-100,icon:"x-item-file x-html",callback:function(t){if(e(t)){var a=core.path2url(t);isWap()?window.location.href=a:window.open(a)}}}),kodApp.add({name:"swfPlayer",title:"Flash Player",ext:"swf",icon:"x-item-file x-swf",callback:function(e,t){$.dialog({resize:!0,fixed:!0,ico:core.icon(t),title:core.pathThis(e),width:"75%",height:"65%",padding:0,content:core.createFlash(core.path2url(e))})}}),kodApp.add({name:"webLink",title:"webLink",ext:"url,webloc",sort:10,icon:"x-item-file x-html",callback:function(e,t){core.fileGet(e,function(a){if("url"==t){var i=a.match(/URL=(.*)/);if(i.length>=2)return window.open(i[1])}else if("webloc"==t)try{var n=$($.parseXML(a)),o=n.find("string").text();return window.open(o),void 0}catch(s){}kodApp.open(e,t,"editor")})}}),kodApp.add({name:"htmlView",title:LNG["Plugin.default.htmlView"],ext:"htm,html,shtml",sort:10,icon:"x-item-file x-html",callback:function(e){var t=core.path2url(e);core.openDialog(t,core.icon("html"),core.pathThis(e))}}),kodApp.add({name:"pdfView",title:"PDF Simple",ext:"pdf",sort:0,icon:"x-item-file x-pdf",callback:function(e,t){var a=core.path2url(e),i="pdf"+UUID(),n='<div id="'+i+'" style="height:100%;">			<a href="'+a+'" target="_blank" style="display:block;margin:0 auto;margin-top:80px;font-size:16px;text-align:center;">'+LNG.error+" "+LNG.download+" PDF</a></div>";$.dialog({resize:!0,fixed:!0,ico:core.icon(t),title:core.pathThis(e),width:"80%",height:"75%",padding:0,content:n}),PDFObject.embed(a,"#"+i)}}),kodApp.add({name:"oexeOpen",title:LNG["kodApp.oexe.open"],ext:"oexe",sort:100,icon:" x-item-file x-oexe",callback:function(e){core.fileGet(e,function(t){var a=jsonDecode(t);a.name=core.pathThis(e),core.openApp(a)})}}),kodApp.add({name:"oexeEdit",title:LNG["kodApp.oexe.edit"],ext:"oexe",sort:50,icon:"icon-edit ",callback:function(e){core.fileGet(e,function(t){var a=jsonDecode(t);a.name=core.pathThis(e),a.path=e,ui.path.pathOperate.appEdit(a)})}});var t={createApp:{name:LNG.app_create,className:"createApp newfile",icon:"icon-puzzle-piece x-item-file x-oexe",callback:function(){ui.path.pathOperate.appEdit(0,0,"userAdd")}}};$.contextMenu.menuAdd(t,".menu-body-main",".app-install"),$.contextMenu.menuAdd(t,".toolbar-path-more",".app-install"),$.contextMenu.menuAdd(t,".bodymain",".app-install"),Hook.bind("rightMenu.show",function(e,t,a){var i=[".menu-folder",".menu-file",".menu-tree-folder",".menu-tree-file",".menu-tree-folder-fav"];if(a.find(".context-menu-submenu").fadeOut(0).delay(0).fadeIn(0),a.removeClass("menu-auto-fit"),a.inScreen()||a.addClass("menu-auto-fit"),".menu-body-main"==e){var n=a.find(".set-file-icon-size.context-menu-submenu");"icon"==G.userConfig.listType?n.removeClass("hidden"):n.addClass("hidden")}if(_.include(i,e)){var o="disabled",s=".cute,.rname,.remove",r=".open,.open-text,.down,.share,.copy,.cute,.rname,.remove,.open-browser,.search,.more-action";t.hasClass("file-not-readable")?a.find(r).addClass(o):a.find(r).removeClass(o),t.hasClass("file-not-writeable")?a.find(s).addClass(o):a.find(s).removeClass(o)}}),Hook.bind("rightMenu.show.menu-body-main",function(e,t){var a=".upload,.past,.newfolder,.newfile",i="disabled";G.jsonData&&G.jsonData.info.canUpload?t.find(a).removeClass(i):t.find(a).addClass(i)}),Hook.bind("rightMenu.show.menu-file",function(e,t){if($(".context-menu-active").hasClass("menu-tree-file"))var a=ui.tree.makeParam();else var a=ui.path.makeParam();var i=core.pathExt(a.path),n="hidden";inArray(["jpg","jpeg","png"],i)?t.find(".set-background").removeClass(n):t.find(".set-background").addClass(n)});var a=function(){var e=".close-item,.refresh,.newfile,.past,.info",t=".open-browser",a=".explorer,.create-project,.open-project",i=".close-item,.newfile,.refresh,.past,.down,.copy,.cute,.remove,.more-action,.clone,.info,.zip,.zip-zip,.zip-tar,.zip-tgz",n=".newfile,.cute,.past,.rname,.zip,.remove,.clone,.create-link-home,.create-link,.create-project",o=$(".menu-tool-path"),s="disabled",r=ui.fileLight.fileListSelect();o.find(".context-menu-item").addClass(s),0==r.length?o.find(e).removeClass(s):1==r.length?(o.find(".context-menu-item").removeClass(s),"folder"==ui.fileLight.type(r)?o.find(t).addClass(s):o.find(a).addClass(s)):r.length>1&&o.find(i).removeClass(s),G.jsonData&&G.jsonData.info&&G.jsonData.info.canUpload===!1&&o.find(n).filter(":not(."+s+")").addClass(s)};Hook.bind("explorer.fileSelect.init",function(){ui.fileLight.listNumberSet()}),Hook.bind("explorer.fileSelect.change",function(){a(),ui.fileLight.selectNumSet()}),Hook.bind("rightMenu.show.toolbar-path-more",function(){a()}),Hook.bind("rightMenu.initFinished",function(){if(1!=G.isRoot){var e="hidden";if(core.authCheck("explorer.fileDownload")||(kodApp.remove("browserOpen"),$(".context-menu-list .down,.context-menu-list .download").addClass(e),$(".context-menu-list .share").addClass(e),$(".context-menu-list .open-text").addClass(e),$(".pathinfo .open-window").addClass(e),$(".context-menu-list .open-browser").addClass(e)),core.authCheck("explorer.search")||$(".context-menu-list .search").addClass(e),core.authCheck("explorer.mkdir")||$(".context-menu-list .newfolder").addClass(e),core.authCheck("userShare.set")||$(".context-menu-list .share").remove(),core.authCheck("explorer.mkfile")||$(".context-menu-list .newfile,.tool-path-newfile").addClass(e),core.authCheck("explorer.mkdir")||$(".context-menu-list .newfolder,[data-action=newfolder]").addClass(e),core.authCheck("explorer.pathCopy")||($(".context-menu-list .cute").addClass(e),$(".context-menu-list .copy").addClass(e)),!core.authCheck("explorer.fileUpload")){$(".context-menu-list .upload").addClass(e);var t=$("[data-action=upload-more]");t.exists()&&t.parent().addClass(e)}}})}),define("app/common/tpl/copyright.html",[],'<div class="dialog-copyright-content">\n	<div class="title">\n		<div class="logo">\n			<i class="icon-cloud"></i>\n			{{if kod.window.core.versionType==\'A\'}}KodExplorer {{else}} {{LNG.kod_name}} {{/if}} v{{G.version}}\n		</div>\n		<div class=\'info\'>——{{LNG.kod_name_copyright}}</div>\n	</div>\n	<div class="content">\n		<p>{{@LNG.copyright_desc}}</p>\n		<div>{{@LNG.copyright_contact}}</div>\n		<div>{{@LNG.copyright_info}}</div> \n	</div>\n</div>\n'),define("app/common/tpl/themeDIY.html",[],"@media screen and (max-width:100000px) {\n	body .full-background{\n		position: absolute;top: 0px;left: 0px;bottom: 0px;right: 0px;\n		background-color: #020202;background-size: 100% 100%;\n	}\n\n	{{if blurSize= (bgBlur==0?0:10) }}{{/if}}\n	body .full-background:before{\n		-webkit-filter: blur({{blurSize}}px);\n		-moz-filter: blur({{blurSize}}px);\n		-ms-filter: blur({{blurSize}}px);\n		filter: blur({{blurSize}}px);\n	}\n	{{if bgType == 'image'}}\n		body .full-background,\n		body .full-background:before,\n		body #body .menu-left,\n		body #body .app-menu-left,\n		body .aui-buttons,\n		body .aui-state-focus .aui-title,body .aui-title{\n			background-image:url({{bgImage}});\n		}\n		body .aui-state-focus .aui-title,body .aui-title{\n			background-size:100%;\n		}\n	{{else}}\n		body .full-background,\n		body .full-background:before,\n		body #body .menu-left, \n		body #body .app-menu-left,\n		body .aui-buttons,\n		body .aui-state-focus .aui-title,body .aui-title{\n			background:{{endColor}};\n			filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='{{startColor}}', endColorstr='{{endColor}}');\n			background-image: -webkit-linear-gradient({{colorRotate}}deg, {{startColor}}, {{endColor}});\n			background-image: -moz-linear-gradient({{colorRotate}}deg, {{startColor}}, {{endColor}});\n			background-image: -o-linear-gradient({{colorRotate}}deg, {{startColor}}, {{endColor}});\n			background-image: -ms-linear-gradient({{colorRotate}}deg, {{startColor}}, {{endColor}});\n			background-image: linear-gradient({{colorRotate}}deg, {{startColor}}, {{endColor}});\n		}\n	{{/if}}\n}\n"),define("app/src/edit/edit",["./preview","./previewMarkdown","./previewMarkdownParse","./functionList","./markdownTools","lib/ace/src-min-noconflict/ext-modelist"],function(e){var t={},a=void 0,i=e("./preview");e("lib/ace/src-min-noconflict/ext-modelist"),aceModeList=ace.require("ace/ext/modelist"),e.async("lib/ace/src-min-noconflict/ext-language_tools",function(){ace.config.loadModule("ace/ext/language_tools",function(){ace.snippetManager=ace.require("ace/snippets").snippetManager})}),e.async("lib/ace/emmet.min.js",function(){e.async("lib/ace/src-min-noconflict/ext-emmet",function(){ace.require("ace/ext/emmet")})});var n=ace.require("ace/lib/net");n.loadScript.hook("loadScript",n,function(){return"string"==typeof arguments[0]&&-1!==arguments[0].search("mode-php.js")&&(arguments[0]=arguments[0].replace("mode-php.js","mode-phhp.js")),arguments}),ace.config.moduleUrl.hook("moduleUrl",ace.config,function(){return-1!==arguments[0].search("php_worker")&&(arguments[0]=arguments[0].replace("php_worker","phhp_worker")),arguments});var o=ace.require("ace/mouse/default_handlers").DefaultHandlers;o.prototype.onMouseDown.hook("onMouseDown",o.prototype,function(){arguments[0].preventDefault=function(){return!0}});var s=ace.require("ace/virtual_renderer").VirtualRenderer;s.prototype.showComposition.hook("showComposition",s.prototype,function(){return this.session.selection.rangeCount>1?"hookReturn":void 0});var r=ace.require("ace/editor").Editor;r.prototype.$checkMultiselectChange.hook("$checkMultiselectChange",r.prototype,function(){return"hookReturn"});var l,c=function(e,a){if(void 0==a||void 0==e||1>t.length)return"";for(var i in t)try{if(t[i].kod[e]==a)return t[i].kod.uuid}catch(n){}return""},d=function(){var e={fontSize:"15px",theme:"tomorrow",showGutter:1,autoWrap:1,autoComplete:1,functionList:1,tabSize:4,softTab:1,displayChar:0,fontFamily:"Menlo",keyboardType:"ace"};for(var t in e)G.codeConfig[t]===void 0&&(G.codeConfig[t]=e[t]);autoFunctionList=parseInt(G.codeConfig.functionList),Toolbar.toolbarSelected(),x(),$("body").mouseup(function(e){var t=["markdown-menu-box","markdown-setting","markdown-help"];$.each(t,function(t,a){$(e.target).hasClass(a)||$(e.target).parent().hasClass("val")||0!=$(e.target).parents("."+a).length||$("."+a).addClass("hidden")})}),Mousetrap.bind(["ctrl+f","command+f"],function(e,t){switch(stopPP(e),t){case"ctrl+f":case"command+f":break;default:}})},p=function(e){var t=core.pathExt(e),a=aceModeList.getModeForPath(e).name;if("text"==a)for(var i in Editor.fileOpenMode)if(-1!=$.inArray(t,Editor.fileOpenMode[i])){a=i;break}return a},u=function(e){var a,i="id_"+UUID();if(void 0==e||""==e||"undefined"==e)return a={uuid:i,name:"newfile.txt",charset:"utf-8",filename:"",mode:p("test.txt"),theUrl:""},Hook.trigger("editor.initAdd.before",a),f(a),m(a),$(".edit-body .this").removeClass("this"),$(".edit-body pre#"+i).parent().addClass("this"),$(".tab-"+a.uuid).removeClass("loading"),N(),v(),Toolbar.toolbarSelected(),Hook.trigger("editor.initAdd.ready",t[i]),void 0;var n=e;if("http"==e.substr(0,4)){var o=$.getUrlParam("name",e),s=$.getUrlParam("downFilename",e);o?n=urlDecode(o):s&&(n=urlDecode(s))}a={charset:"utf-8",uuid:i,name:core.pathThis(n),filename:n,mode:p(n),theUrl:""},"http"==e.substr(0,4)&&(a.filename=""),Hook.trigger("editor.initAdd.before",a),f(a),t[a.uuid]={kod:{filename:a.filename}},core.fileGet(e,function(e,n,o){if(a.theUrl=o,$(".tab-"+a.uuid).removeClass("loading"),!n||!n.code)return A(a.uuid),Tips.tips(n);if(0==$("#"+a.uuid).length)return A(a.uuid),void 0;var s=n.data,r="<?php exit;?>";if("php"==s.ext&&0==s.content.indexOf(r)){var l=s.content.substr(r.length);s.content=r+js_beautify(l),a.mode=p("test.json")}"oexe"==s.ext&&(s.content=js_beautify(s.content)),t[i]=void 0,$("#"+i).text(s.content),m(a);var c=t[i];c.kod.charset=s.charset,c.kod.base64=s.base64,c.navigateTo(0),c.moveCursorTo(0,0),R(),N(),v(),Toolbar.toolbarSelected(),Hook.trigger("editor.initAdd.ready",c)},function(e){A(a.uuid),e||(e=LNG.error),Tips.tips(e,!1)})},f=function(t){var a=core.iconSmall(core.pathExt(t.name)),i='<div class="edit-tab-menu tab loading tab-'+t.uuid+'" uuid="'+t.uuid+'" title="'+htmlEncode(t.filename)+'"'+' data-name="'+htmlEncode(t.filename)+'">'+'   <div class="name">'+a+htmlEncode(t.name)+"</div>"+'   <a href="javascript:void(0);" class="close icon-remove" draggable="false"></a>'+'   <div style="clear:both;"></div>'+"</div>";$(i).insertBefore(".edit-tab .add");var n=e("./tpl/editTabContent.html"),o=template.compile(n),s=o({LNG:LNG,uuid:t.uuid});if($(".edit-body .tabs").append(s),y(t.uuid),Tap.resetWidth("add"),x(),"markdown"==t.mode&&$.getUrlParam("sid")){var r=$("#"+t.uuid).parent(".edit-content");r.addClass("markdown-full-page")}},h=function(e){clearTimeout(l),l=!1,l=setTimeout(function(){try{e.kod.preview.editChange()}catch(t){}},300)},m=function(e){var a=ace.edit(e.uuid),n=a.getSession();a.setTheme("ace/theme/"+G.codeConfig.theme),void 0!=e.mode&&a.getSession().setMode("ace/mode/"+e.mode),n.setTabSize(parseInt(G.codeConfig.tabSize)),n.setUseSoftTabs(parseInt(G.codeConfig.softTab)),n.setUseWrapMode(parseInt(G.codeConfig.autoWrap)),a.renderer.setShowGutter(parseInt(G.codeConfig.showGutter)),a.renderer.setScrollMargin(0,100,0,0),"ace"==G.codeConfig.keyboardType?a.setKeyboardHandler():a.setKeyboardHandler("ace/keyboard/"+G.codeConfig.keyboardType),a.setShowPrintMargin(!1),a.setPrintMarginColumn(120),a.$blockScrolling=1/0,a.setDragDelay(20),a.setShowInvisibles(parseInt(G.codeConfig.displayChar)),a.setFontSize(parseInt(G.codeConfig.fontSize)),a.setAnimatedScroll(!0),a.setOptions({enableEmmet:!0,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}),a.on("change",function(){L(a,!0),h(a)}),a.on("changeSelection",function(){H()}),a.commands.addCommand({name:"editSave",bindKey:{win:"Ctrl-S",mac:"Command-S",sender:"editor|cli"},exec:function(e){_(e.kod.uuid)}}),a.commands.addCommand({name:"editFunction",bindKey:{win:"Ctrl-Shift-E",mac:"Command-Shift-E",sender:"editor|cli"},exec:function(){Toolbar.doAction("functionList")}}),a.commands.addCommand({name:"preview",bindKey:{win:"Ctrl-Shift-S",mac:"Command-Shift-S"},exec:function(){Toolbar.doAction("preview")}}),a.commands.addCommand({name:"showKeyboardShortcuts",bindKey:{win:"Ctrl-Alt-h",mac:"Command-Alt-h"},exec:function(e){ace.config.loadModule("ace/ext/keybinding_menu",function(t){t.init(e),e.showKeyboardShortcuts()})}}),a.commands.addCommand({name:"convertUpper",bindKey:{win:"Ctrl-U",mac:"Command-U"},exec:function(e){e.toUpperCase()}}),a.commands.addCommand({name:"convertLower",bindKey:{win:"Ctrl-O",mac:"Command-O"},exec:function(e){e.toLowerCase()}}),a.commands.addCommand({name:"gotolineAt",bindKey:{win:"Ctrl-L",mac:"Command-L"},exec:function(){$(".top-toolbar .menu-view-goto-line").trigger("mousedown")}}),a.commands.addCommand({name:"convertIndent",exec:function(e,t){ace.config.loadModule("ace/ext/whitespace",function(a){var i={reset_size:G.codeConfig.softTab?" ":"	",to_space:" ",to_tabs:"	"},n=i[t];e.session.setTabSize(G.codeConfig.tabSize),e.session.setUseSoftTabs(G.codeConfig.softTab),a.detectIndentation(e.session),a.convertIndentation(e.session,n,G.codeConfig.tabSize),a.trimTrailingSpace(e.session,n)})}}),a.commands.addCommand({name:"phpBeautify",bindKey:{win:"Ctrl-Shift-B",mac:"Command-Shift-B"},exec:function(e){return"ace/mode/php"!=e.session.$modeId?(Tips.tips("Only for php mode!","warning"),void 0):(ace.config.loadModule("ace/ext/beautify",function(t){t.beautify(e.session)}),void 0)}}),a.commands.addCommand({name:"find",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(e){ace.config.loadModule("ace/ext/searchboxKod",function(t){t.Search(Editor,e)})}}),a.commands.addCommand({name:"replace",bindKey:{win:"Ctrl-H",mac:"Command-Option-F"},exec:function(e){ace.config.loadModule("ace/ext/searchboxKod",function(t){t.Search(Editor,e,!0)})}}),a.commands.addCommand({name:"closeSearchBar",bindKey:"Esc",exec:function(){Editor.searchBox&&Editor.searchBox.hide()}}),a.commands.addCommand({name:"preview",bindKey:{win:"Ctrl-alt-G",mac:"Ctrl-command-G"},exec:function(e){e.findAll(e.session.getTextRange()),H()}}),a.commands.addCommand({name:"refresh",bindKey:{win:"F5",mac:"F5"},exec:function(){Toolbar.doAction("refresh")}}),e.mode||(e.mode=""),a.kod={mode:e.mode,uuid:e.uuid,name:e.name,base64:!1,charset:"utf-8",theUrl:e.theUrl,filename:e.filename},a.hasChanged=!1,t[e.uuid]=a,b(),a.kod.preview=new i(a)},v=function(){var e=P();if(e){e.focus(),e.resize();try{var t=window.parent.$.dialog.list.openEditor,a=Editor.current().kod.filename;a||(a=Editor.current().kod.name);var i='<img draggable="false" src="'+G.staticPath+'images/file_icon/icon_others/edit.png"/>'+htmlEncode(a);if(t){t.title(i);var n=G.appHost+"editor/edit";G.sid!==void 0&&(n=G.appHost+"share/edit&user="+G.user+"&sid="+G.sid),n=n+"#filename="+urlEncode(a),window.parent.$(".openEditor .aui-content iframe").attr("src",n)}}catch(o){}$("title").text(core.pathThis(a))}},g=function(e,t){try{Editor.current().completer.popup.hide()}catch(i){}$(".edit-tab .this").removeClass("this"),$(".edit-tab .tab-"+e).addClass("this"),a=e,t&&$(".edit-tab .this").stop(!0,!0).animate({opacity:.5},50).animate({opacity:.8},50).animate({opacity:.5},50).animate({opacity:1},50,function(){}),v(),H(),D(),N(),Toolbar.toolbarSelected(),b(),Hook.trigger("editor.selectTab",Editor.current())},b=function(){var e=P();e&&void 0!==e.kod&&Editor.searchBox&&Editor.searchBox.isShow()&&(Editor.searchBox.setEditor(Editor,Editor.current()),Editor.searchBox.find(!1,!1,!0))},y=function(e,t){if(void 0!=e&&""!=e){$(".edit-body .this").removeClass("this"),$(".edit-body #"+e).parent().addClass("this"),g(e,t);
var a=$(".tab-"+e).attr("data-name");j(function(e){e.ui.tree.setSelect(a)})}},k=function(e,i,n){var o=t;$.extend(!0,{},G.codeConfig),void 0!=n&&(o={},o[n]?o[n]=t[n]:o[a]=t[a]);var s=function(e){var t=Number(!Number(e));return isNaN(t)?0:t};i!==void 0?G.codeConfig[e]=i:(G.codeConfig[e]=s(G.codeConfig[e]),i=G.codeConfig[e]),Toolbar.toolbarSelected();for(var r in o){var l=o[r];if(l&&l.kod&&l.resize)switch(-1!=$.inArray(e,["fontSize","autoWrap","fontFamily"])&&h(l),e){case"theme":l.setTheme("ace/theme/"+i);break;case"tabSize":l.getSession().setTabSize(parseInt(i));break;case"showGutter":l.renderer.setShowGutter(parseInt(i));break;case"softTab":l.getSession().setUseSoftTabs(parseInt(i));break;case"fontSize":l.setFontSize(parseInt(i));break;case"autoWrap":l.getSession().setUseWrapMode(parseInt(i));break;case"displayChar":l.setShowInvisibles(parseInt(i));break;case"fontFamily":x();break;case"keyboardType":"ace"==G.codeConfig.keyboardType?l.setKeyboardHandler():l.setKeyboardHandler("ace/keyboard/"+G.codeConfig.keyboardType);break;case"functionList":break;case"autoComplete":l.setOptions({enableLiveAutocompletion:G.codeConfig[e]}),l.$enableBasicAutocompletion=G.codeConfig[e];break;default:}}$.ajax({url:G.appHost+"editor/setConfig&k="+e+"&v="+G.codeConfig[e],dataType:"json",success:function(){}})},x=function(){var e=G.codeConfig.fontFamily;e="'"+e+"',Monaco,Menlo,Consolas,source-code-pro,'Liberation Mono','Ubuntu Mono','Microsoft Yahei','微软雅黑',Courier,'Helvetica Neue','Lantinghei SC',STXihei,WenQuanYi,sans-serif",$(".ace-editor-content").css("font-family",e)},w=function(e){var a=t;for(var i in a){var n=a[i];if(n&&n.kod&&n.resize)switch(e){case"resize":n.resize();break;case"setting":n.commands.exec("showSettingsMenu",n);break;default:}}"resize"==e&&N()},N=function(){var e=P();if(e){var t=$("#"+e.kod.uuid).parent().find(".edit-right-frame"),a=0;t.hasClass("hidden")||(a=100*(t.width()/$(window).width())),$(".edit-body .bottom-toolbar").css("right",a+"%")}},L=function(e,t){t!=e.hasChanged&&(e.hasChanged=t,$(".edit-tab .tabs .tab-"+e.kod.uuid).toggleClass("edit-changed"))},_=function(e,i){if(void 0!=a){void 0==e&&(e=a),void 0==i&&(i=!1);var n=t[e];if(void 0==n||""==n)return Tips.tips(LNG.data_error,"warning"),void 0;if(n.hasChanged){P().focus();var o=n.kod.filename;""==o?core.api.pathSelect({type:"file",title:LNG.newfile_save_as},function(e){T(n,e,i)}):T(n,o,i)}}},C=function(){for(var e in t)""!=t[e].kod.filename&&_(e)},T=function(e,t,a){if("view"===e.kod.tabType)return Tips.tips(LNG.error,"warning"),void 0;var i={path:t,charset:e.kod.charset,filestr:e.getValue()};e.kod.charsetSave&&(i.charsetSave=e.kod.charsetSave);var n=G.appHost+"editor/fileSave";G.sharePage!==void 0&&(n=G.appHost+"share/fileSave&user="+G.user+"&sid="+G.sid),e.kod.base64&&(i.base64="1",i.filestr=base64Encode(i.filestr)),i.filestr=urlEncode(i.filestr),""==e.kod.filename&&(i.create_file=1),Tips.loading(LNG.getting,!0),$(".tab-"+e.kod.uuid).addClass("loading"),$.ajax({type:"POST",dataType:"json",url:n,data:i,error:core.ajaxError,success:function(i){return $(".tab-"+e.kod.uuid).removeClass("loading"),i.code?(Tips.close(LNG.success,!0),""==e.kod.filename&&(e.kod.filename=t,S(e)),L(e,!1),v(),a&&A(e.kod.uuid),void 0):(Tips.close(i,!1),void 0)}})},S=function(e){var t=e.kod.filename;e.kod.name=core.pathThis(t),e.kod.mode=p(t),e.kod.theUrl=G.appHost+"editor/fileGet&filename="+t;var a=$(".tab-"+e.kod.uuid);a.attr("title",t),a.find(".name").html(e.kod.name)},E=function(e){if(void 0==e&&(e=a),void 0==t[e])return A(e),void 0;var i=t[e];i.hasChanged?$.dialog({title:LNG.warning,resize:!1,background:"#fff",opacity:.4,lock:!0,icon:"question",content:i.kod.name+"<br/>"+LNG.if_save_file,padding:40,button:[{name:LNG.button_save,focus:!0,callback:function(){_(e,!0)}},{name:LNG.button_not_save,callback:function(){A(e)}}]}):A(e)},A=function(e){delete t[e];var a="",i=$(".edit-tab .tab"),n=$(".edit-tab .tab-"+e),o=$(".edit-body pre#"+e).parent();n.removeClass("edit-tab-menu"),n.hasClass("this")?($(i[0]).attr("uuid")==e?a=$(i[1]).attr("uuid"):i.each(function(){var t=$(this).attr("uuid");return t==e?!1:(a=t,void 0)}),""!=a&&$(".edit-body pre#"+a).addClass("this"),o.remove(),Tap.resetWidth("remove",n,a)):(o.remove(),Tap.resetWidth("remove",n)),D()},D=function(){0==$(".edit-body .tabs .edit-content").length?(P()&&P().kod.preview.close(),$(".disable-mask,.introduction").removeClass("hidden"),$(".bottom-toolbar").addClass("hidden"),$(".edit-body .tabs").addClass("hidden")):($(".disable-mask,.introduction").addClass("hidden"),$(".bottom-toolbar").removeClass("hidden"),$(".edit-body .tabs").removeClass("hidden")),j(function(e){var t=[];$(".edit-tab .tabs .edit-tab-menu").each(function(){var e=$(this).attr("data-name");e&&t.push(e)}),e.ui.fileHistory(t)})},j=function(e){ShareData.frameTop("",function(t){t.core&&t.core.isApp("editor")&&0!=t.$("#page-editor").length&&"function"==typeof e&&e(t)})},z=function(){for(var e in t)try{if(t[e].hasChanged)return!0}catch(a){}return!1},I=function(e){core.setSkin(e)},P=function(){return a&&t[a]&&t[a].focus?t[a]:!1},O=function(e){var a=P();e&&(a=t[e]);var i=a.kod.theUrl,e=a.kod.uuid;return""==i?(Tips.tips(LNG.not_exists,"warning"),void 0):($(".tab-"+e).addClass("loading"),Tips.loading(LNG.loading),i+="&charset="+a.kod.charset,core.fileGet(i,function(t,i){Tips.close(),$(".tab-"+e).removeClass("loading");var n=i.data,o="<?php exit;?>";if(null==n.content&&(n.content=""),"php"==n.ext&&0==n.content.indexOf(o)){var s=n.content.substr(o.length);n.content=o+js_beautify(s)}"oexe"==n.ext&&(n.content=js_beautify(n.content)),a.kod.charset=n.charset,a.kod.base64=n.base64,a.getSession().setValue(n.content);var r=a.getFirstVisibleRow();a.scrollToLine(r),L(a,!1)},function(t){t||(t=LNG.error),Tips.close(t),Tips.tips(t,!1),$(".tab-"+e).removeClass("loading")}),void 0)},R=function(){ShareData.data("FILE_SEARCH_AT")&&setTimeout(function(){for(var e=ShareData.data("FILE_SEARCH_AT"),t=P(),a={row:e.line-1,column:0};e.lineIndex-->=0;){t.selection.moveTo(a.row,a.column);var i=-1==e.lineIndex?!0:!1,n=t.find(e.search,{},i);a=n.end}t.session.highlight(t.$search.$options.re),t.renderer.updateBackMarkers(),ShareData.remove("FILE_SEARCH_AT")},100)},M=function(e){e||(e=G.codeConfig.theme);var t=["ambiance","idle_fingers","monokai","pastel_on_dark","twilight","solarized_dark","tomorrow_night_blue","tomorrow_night_eighties"];return inArray(t,e)?!0:!1},H=function(){var e=Editor.current();if(e){var t=e.selection.getCursor(),a=t.row+1+":"+(t.column+1);e.selection.rangeCount>1&&(a+="  ["+e.selection.rangeCount+"]");for(var i=e.selection.getAllRanges(),n=0,o=0,s=0;i.length>s;s++){var r={start:i[s].start,end:i[s].end},l=e.selection.doc.getTextRange(r);n+=l.length,o+=r.end.row-r.start.row+1}n>0&&(a+=" ("+n+" ~ "+o+")"),$(".editor_position").html(a)}};return{init:d,current:P,getParentEditor:j,hasFileSave:z,setChanged:L,saveConfig:k,doAction:w,setTheme:I,isBlackTheme:M,select:y,remove:E,save:_,saveall:C,refresh:O,getFileMode:p,aceModeList:aceModeList,add:function(e){e=urlDecode(e);var t=c("filename",e);""!=t?(y(t,!0),R()):u(e)}}}),define("app/src/edit/preview",["./previewMarkdown","./previewMarkdownParse","./functionList","./markdownTools"],function(e){return function(t){var a=$("#"+t.kod.uuid).parent(".edit-content"),i=a.find(".edit-right-frame"),n=$("#"+t.kod.uuid),o=a.find(".function-list-frame"),s=a.find(".preview-url-frame"),r=a.find(".preview-markdown-frame"),l=e("./previewMarkdown"),c=e("./functionList"),d=e("./markdownTools"),p=new l(t),u=new c(t),f=10,h=function(){a.find(".preview-url-tool input").keyEnter(L);var e=a.find(".resize"),t=0;e.drag({start:function(){t=i.width(),e.addClass("resize-active"),$("body").css("cursor","col-resize"),i.append('<div class="preview-frame mask-view"></div>'),i.addClass("can-not-select")},move:function(a){var o=t-a,s=$(window).width();o>=s-f&&(o=s-f),f>=o&&(o=f),n.width(s-o),i.width(o),e.css("left",s-o+"px")},end:function(){e.removeClass("resize-active"),$("body").css("cursor","default"),i.find(".mask-view").remove(),i.removeClass("can-not-select"),m()}})},m=function(){if(0==$(".markdown-full-page").length){if(i.is(":visible")){var e=i.width(),t=$(window).width();e>=t-f&&(e=t-f),f>=e&&(e=f);var s=100*parseFloat(e/t);i.width(s+"%"),n.width(100-s+"%");var l=a.find(".resize");l.css("left",100-s+"%"),o.is(":visible")&&i.attr("data-size-width",e),r.is(":visible")&&p.refreshScroll()}Editor.doAction("resize")}},v=function(){a.find(".edit-right-frame .box a,.function-list-tool .box a,[markdown-action]").bind("click",function(t){var i=$(this).attr("class");switch($(this).attr("markdown-action")&&(i=$(this).attr("markdown-action")),i){case"tool-markdown-menu":if(a.find(".markdown-menu-box").toggleClass("hidden"),!a.find(".markdown-menu-box").hasClass("hidden")){var n=p.markdownMenu(a.find(".markdown-preview"));a.find(".markdown-menu-box .content").html(n)}break;case"tool-markdown-download-html":p.markdownDownload(a.find(".markdown-preview").html(),"html");break;case"tool-markdown-download-pdf":p.markdownDownload(a.find(".markdown-preview").html(),"pdf");break;case"tool-markdown-download-markdown":p.markdownDownload("","md");break;case"tool-markdown-full":a.toggleClass("markdown-full"),a.hasClass("markdown-full")&&(a.find(".ace_editor").css("width","50%"),a.find(".edit-right-frame").css("width","50%"),a.find(".resize").css("left","50%")),Editor.doAction("resize");break;case"tool-markdown-setting":a.find(".markdown-setting").toggleClass("hidden");break;case"tool-markdown-help":if(""==a.find(".markdown-help .content").html()){var n="";n="zh-CN"==G.lang||"zh-TW"==G.lang?e("./tpl/markdownHelpCN.html"):e("./tpl/markdownHelp.html"),a.find(".markdown-help .content").html(n)}a.find(".markdown-help").toggleClass("hidden");break;case"tool-markdown-max":a.toggleClass("markdown-full-page"),a.hasClass("markdown-full-page")||m();break;case"tool-open-url":y();break;case"tool-refresh":L();break;case"tool-close":N();break;case"tool-markdown-help":break;default:}return stopPP(t),!1})},g=function(e){var l=0;if(i.removeClass("hidden"),o.addClass("hidden"),r.addClass("hidden"),s.addClass("hidden"),a.find(".resize").removeClass("hidden"),"function-list"==e)o.removeClass("hidden"),l=200,u.refresh(),i.find(".function-search input").focus();else if("markdown"==e)l=.51*$(window).width(),r.removeClass("hidden"),p.refresh(),d.bindEvent(a,t);else if("html"==e){l=.5*$(window).width(),s.removeClass("hidden");var c=t.kod.filename;c=core.path2url(c),i.find(".preview-url-tool input").val(c),i.find("iframe").attr("src",c)}i.css({width:l}),n.css({width:$(window).width()-l}),m()},b=function(){o.hasClass("hidden")?r.hasClass("hidden")||p.refresh():u.refresh()},y=function(e){if(r.hasClass("hidden"))window.open(a.find(".preview-url-frame input").attr("value"));else{var t=p.markdown2html(a.find(".markdown-preview").html()),i=window.open("","_blank","");i.document.open("text/html","replace"),i.opener=null,i.document.write(t),i.document.close()}stopPP(e)},k=function(){return u.support(t.kod.mode)?(o.hasClass("hidden")?(autoFunctionList=1,g("function-list")):(autoFunctionList=0,N()),Editor.saveConfig("functionList",autoFunctionList),void 0):(Tips.tips(LNG.not_support,"warning"),void 0)},x=function(){i.hasClass("hidden")?w()||g("html"):r.hasClass("hidden")&&g("html")},w=function(){return autoFunctionList&&u.support(t.kod.mode)?(g("function-list"),!0):"markdown"==t.kod.mode?(g("markdown"),!0):!1},N=function(){(s.hasClass("hidden")||!w())&&(i.addClass("hidden"),o.addClass("hidden"),r.addClass("hidden"),s.addClass("hidden"),a.find(".resize").addClass("hidden"),$(".markdown-full-page").removeClass("markdown-full-page"),n.css("width","100%"),Editor.doAction("resize"))},L=function(){var e=a.find(".preview-url-tool input"),t=e.attr("value");a.find(".open-browser").attr("href",t),a.find("iframe").attr("src",t)},_=function(){h(),v(),w();var e,n=function(){clearTimeout(e),e=!1,e=setTimeout(function(){o.is(":visible")&&(i.width(i.attr("data-size-width")),m())},10)};$(window).bind("resize",n),d.bindEvent(a,t)};return _(),{open:g,editChange:b,close:N,resize:m,openFunctionList:k,previewForce:x}}}),define("app/src/edit/previewMarkdown",["./previewMarkdownParse"],function(e){var t=e("./previewMarkdownParse"),a=function(){$(".edit-right-frame .markdown-menu a").die("click").live("click",function(e){stopPP(e);var t=$(this).parents(".right-main"),a=t.find("[data-link='"+$(this).attr("href")+"']");if(0!=a.length){var i=a.offset().top+t.scrollTop()-t.offset().top+"px";t.stop(!0).animate({scrollTop:i},100,"linear")}})},i=function(){var e="newfile",t=Editor.current().kod.filename;return""!=t&&(t=core.pathThis(t),e=t.substr(0,t.indexOf("."))),e},n=function(t){var a=e("./tpl/markdownPreview.html"),n=template.compile(a),o=n({addStyle:G.staticPath+"js/lib/markdown/katex/katex.min.css",content:t,title:i(),black_theme:Editor.isBlackTheme()});return o=o.replace(/ data-link="#(.*?)">/g,'><a name="$1" id="$1"></a>')},o=function(e,t){var a=i()+"."+t;switch(t){case"html":$.htmlDownload(n(e),a);break;case"md":var o=Editor.current(),s=o.getValue();$.htmlDownload(s,a);break;case"pdf":$.htmlPrint(n(e));break;default:}};return function(){var i,s,r,l,c=!1,d=!1,p=function(){if(i=Editor.current(),i&&void 0!==i.focus){var e=i.kod.uuid;s=$("#"+e).parent().find(".markdown-preview"),r=$("#"+e).parent().find(".edit-right-frame .right-main"),h(),f(),a(),t.bindBigView()}},u=function(){e.async("lib/markdown/markdown-it.min",function(){if(s&&0!=s.length&&window.markdownit){var e=window.markdownit({html:!0,breaks:!0,linkify:!0}),a=i.getValue(),n=e.render(a),o=$(".markdown-buffer");0==o.length&&($("<div class='markdown-buffer' style='position:fixed;z-index:0;height:100%;width:100%'></div>").appendTo("body"),o=$(".markdown-buffer")),o.html(n),t.menu(o),t.code(o,function(){t.math(o,function(){t.flow(o,function(){s.html(o.html()),o.remove(),y()})})})}})},f=function(){var e,t=function(){return!r.find(".preview-markdown-frame").hasClass("hidden")};i.session.on("changeScrollTop",function(){!d&&t()&&(c=!0,k(!0),clearTimeout(e),e=!1,e=setTimeout(function(){c=!1},1e3))}),i.on("change",function(){!d&&t()&&(c=!0,y(function(){k(!0),clearTimeout(e),e=!1,e=setTimeout(function(){c=!1},1e3)}))})},h=function(){return},m=[],v=[],g=function(){if(void 0!==i.kod.mode&&"markdown"==i.kod.mode&&window.markdownit){m=[];for(var e="\n...\n"+i.getValue(),t=0,a=window.markdownit(),n=a.parse(e,{references:{}}),o=["h1","h2","h3","h4","h5","h6"],s=0;n.length>s;s++)if($.inArray(n[s].tag,o)>=0&&"heading_open"==n[s].type){var r=i.session.documentToScreenPosition(n[s].map[0]-1,2),l=r.row*i.renderer.lineHeight;m.push({start:t,end:l,height:l-t}),t=l}}},b=function(){if(r&&0!=r.length){v=[];var e=0,t=r.scrollTop();s.find("h1,h2,h3,h4,h5,h6").each(function(){var a=$(this).position().top+t+parseInt($(this).css("margin-top"));v.push({start:e,end:a,height:a-e}),e=a})}},y=function(e){clearTimeout(l),l=!1,l=setTimeout(function(){g(),b(),"function"==typeof e&&e()},200)},k=function(e){var t=i.session.getScrollTop(),a=r.scrollTop(),n=function(e,t,a,i){for(var n,o=-1,s=0;e.length>s&&(o=s,n=e[s],!(e[s].end>t));s++);if(!(-1===o||o>=a.length)){var r=(t-n.start)/n.height,l=a[o],c=l.start+l.height*r;o==e.length-1&&t>=n.end-5&&(c=l.end),i(c)}};e?n(m,t,v,function(e){r.stop(!0).animate({scrollTop:e},100,"linear")}):a+r.height()>=r.prop("scrollHeight")-5?i.gotoLine(i.session.getLength()):n(v,a,m,function(e){i.session.setScrollTop(e)})};return p(),{refresh:u,refreshScroll:y,markdownMenu:t.getMenu,markdown2html:n,markdownDownload:o}}}),define("app/src/edit/previewMarkdownParse",[],function(e){var t={},a=[],i=function(e,i){var n=t,o=a,s=100;if(void 0==i){if(n[e]){var r=lodash.findIndex(o,{key:e});return o[r]={key:e,time:timeFloat()},n[e]}return!1}if(lodash.size(n)>=s){for(var l=lodash.sortBy(o,"time").reverse(),c=lodash.map(l,"key"),d=c.length-1;d>s-1;d--){var p=c[d];delete n[p]}o=l.slice(0,s-1)}return n[e]=i,o.push({key:e,time:timeFloat()}),!0},n=function(e){var t="";return e.find("h1,h2,h3,h4,h5,h6").each(function(){var e="markdown-"+$(this).text().replace(/\s+/g,"-"),a="markdown-menu-"+$(this)[0].tagName.toLowerCase();$(this).attr("data-link","#"+e),t+='<li class="'+a+'"><a href="#'+e+'">'+$(this).text()+"</a></li>"}),t="<div class='markdown-menu'><ul>"+t+"</ul></div>"},o=function(e){e.find("a").attr("target","_blank");var t="<p>[TOC]</p>";if(-1!=e.html().indexOf(t)){var a=n(e),i=e.html();i=i.replace(t,a),i=i.replace(/ data-link="#(.*?)">/g,'><a name="$1" id="$1"></a>'),e.html(i)}},s=function(t,a){e.async("lib/markdown/highlight.min",function(){t.find("pre code").each(function(e,t){hljs.highlightBlock(t)}),"function"==typeof a&&a()})},r=function(t,a){e.async(["lib/markdown/katex/katex.min.js","lib/markdown/katex/katex.min.css","lib/markdown/katex/contrib/auto-render.min.js"],function(){renderMathInElement(t[0],[{left:"$$",right:"$$",display:!0}]),$(".katex-display").parent().addClass("markdown-latex"),$(t).find(".language-latex,.language-math,.language-katex").each(function(){try{var e=$(this).text(),t=md5(e),a=i(t);if(a)return $(a).clone().insertBefore($(this).parent()),$(this).parent().remove(),void 0;var n=katex.renderToString(e);if("string"!=typeof n)return;var o=$('<div class="markdown-latex">'+n+"</div>");o.insertBefore($(this).parent()),$(this).parent().remove(),i(t,o.clone())}catch(s){}}),"function"==typeof a&&a()})},l=function(t,a){e.async(["lib/markdown/mermaid/mermaid.min.js","lib/markdown/mermaid/mermaid.min.css"],function(){$(t).find("pre code").each(function(){var e=ltrim($(this).text()),t=md5(e),a=i(t);if(a)return $(a).clone().insertBefore($(this).parent()),$(this).parent().remove(),void 0;if($(this).hasClass("language-mermaid")||$(this).hasClass("language-sequence")||$(this).hasClass("language-seq")||$(this).hasClass("language-gantt")||0==e.indexOf("gantt")||0==e.indexOf("sequenceDiagram")||0==e.indexOf("classDiagram")||0==e.indexOf("gitGraph")||0==e.indexOf("graph")){($(this).hasClass("language-sequence")||$(this).hasClass("language-seq"))&&0!=e.indexOf("sequenceDiagram")&&(e="sequenceDiagram\n"+e),$(this).hasClass("language-gantt")&&0!=e.indexOf("gantt")&&(e="gantt\n"+e);var n=$('<div class="markdown-flow">'+e+"</div>").insertBefore($(this).parent());try{mermaid.init(void 0,n),$(this).parent().remove(),i(t,n.clone())}catch(o){}}}),"function"==typeof a&&a()})},c=function(){var e=$("image-view-big");if(!e.exists()){e=$('<div class="image-view-big hidden"></div>').appendTo("body");var t=".image-view-big,.markdown-flow,.markdown-preview img{cursor:pointer;}			.image-view-big .label{color: #444;}			.image-view-big{				position:fixed;left:0;top:0;right:0;bottom:0;z-index: 99999;				background:rgba(255,255,255,0.95);text-align:center;			}			.image-view-big img{				margin: auto;padding: 2px;				box-shadow: 0 0 20px #555;			    height: auto;max-width: 100%;vertical-align: middle;			    position: absolute;			    top: 0;bottom: 0;left: 0;right: 0;			}			.image-view-big .svg{background:#fff;}";$.addStyle(t)}var a=function(t){t?e.removeClass("hidden").hide().fadeIn(100):e.fadeOut(100,function(){e.html("").addClass("hidden")})};$(".markdown-flow").die("click").live("click",function(){e.html($(this).html()),a(!0)}),$(".markdown-preview img").die("click").live("click",function(){$(this).clone().appendTo(e),a(!0)}),$(".image-view-big").die("click").live("click",function(){a(!1)})};return{getMenu:n,bindBigView:c,menu:o,code:s,math:r,flow:l}}),define("app/src/edit/tpl/markdownPreview.html",[],'<!doctype html><html>\n<head><meta charset="utf-8">\n	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">\n	<head><title>{{title}}</title>\n</head>\n<link rel="stylesheet" type="text/css" href="{{addStyle}}">\n<style type="text/css">\n	body{\n		font-family:"Helvetica Neue","Helvetica","Microsoft Yahei","微软雅黑","Lantinghei SC","STXihei","WenQuanYi Micro Hei",Arial,sans-serif;\n		text-align:justify;margin:auto;font-size:14px;line-height:1.6em;\n		color:#333;background:#fefefe;padding:15px;margin:30px auto;position: relative;\n		-webkit-font-smoothing: antialiased;font-smoothing: antialiased;\n	}\n	\n	article,footer,header,nav{margin:0 auto}\n	article{margin-top:4em;margin-bottom:4em;min-height:400px}\n	footer{margin-bottom:50px}\n	video{margin:2em 0;border:1px solid #ddd}\n	nav{font-size:.9em;font-style:italic;border-bottom:1px solid #ddd;padding:1em 0}\n	nav p{margin:0}\n	details{margin: 15px 0;}\n	summary{cursor:pointer;padding: 4px;}\n	summary:focus{outline: none;box-shadow: 0 0 3px #2196F3;}\n	.h1,h1{font-size:2.2em;}\n	.h2,h2{font-size:1.9em;}\n	.h3,h3{font-size:1.6em;}\n	.h4,h4{font-size:1.3em;}\n	.h5,h5{font-size:1.2em;}\n	.h6,h6{font-size:1.1em;}\n	.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{\n		font-family:inherit;font-weight:500;color: #333;\n		line-height:1.5em;padding:0.3em 0;margin: 1em 0 1em 0;\n		word-break: break-all;\n	}\n	.h1,h1{letter-spacing: 1px;border-bottom: 1px solid #ddd;}\n	.h2,h2{padding-bottom: 0.15em;}\n	p{-webkit-hypens:auto;-moz-hypens:auto;hyphens:auto;margin:10px 0;}\n	p,li,div,ul{word-wrap: break-all;}\n	blockquote{margin-left:1em;padding:10px 15px;margin:10px 0 20px 0;border-left:10px solid #ddd;background: #f6f6f6;}\n	blockquote p{margin:0;font-weight:400;}\n	code{\n		padding: 2px 4px;color: #c7254e;background-color:#f9f2f4;border-radius: 4px;\n	}\n	pre{display:block;padding:0;overflow:auto;margin:0 0 10px;font-size:1em;line-height:1.42857143;\n		word-break:break-all;word-wrap:break-word;color:#333;background:none;border-radius:4px}\n	code,kbd,pre,samp{\n		font-family:Consolas,\'Liberation Mono\',\'Ubuntu Mono\',Menlo,Courier,sans-serif;\n	}\n	pre code{background:#f8f8f8;color:#777;white-space:pre-wrap;padding:6px 1em;border:1px solid #eee;display: block;}\n	a{color:#1980e6;text-decoration:none}\n	a:hover{text-decoration:underline}\n	a img{border:none}\n	img{max-width: 100%;}\n	h1 a,h1 a:hover{text-decoration:none}\n	hr{border: 0 none;height: 4px;margin:1.2em 0;\n	    background: rgba(0, 0, 0, 0) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;\n	}\n	@media screen and (min-width: 900px) {\n		body {width: 900px;}\n	}\n	ul,ol{padding:0.2em 0 0.2em 2em;}\n	table {border-collapse: collapse;border-spacing: 0;margin-bottom: 20px;}\n	table thead{background: #eee;}\n	table td,table th{padding: .5em;border: 1px solid #ddd;line-height: 1.5;}\n	.markdown-flow{background:#fff;padding: 15px;}\n	.markdown-flow .label{color:#444;}\n	.markdown-latex {\n		text-align: center;font-size:1.6em;color: #000;\n		margin-bottom: 1.5em;overflow: hidden;overflow-x:auto;\n	}\n	.latex-inline .katex-display{display:inline-block;font-size: 0.8em;}\n	.markdown-menu ul{padding:0 10px 20px 20px;}\n	.markdown-menu li{\n		font-size:14px;list-style:none;\n		line-height:1.8em;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;\n	}\n	.markdown-menu-h2{padding-left:2em;}\n	.markdown-menu-h3{padding-left:4em;}\n	.markdown-menu-h4{padding-left:6em;}\n	.markdown-menu-h5{padding-left:8em;}\n	.markdown-menu-h6{padding-left:10em;}\n\n	div .hljs{color: #666;}\n	.hljs-comment,.hljs-quote{color:#998;font-style:italic}\n	.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}\n	.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,\n		.hljs-template-variable,.hljs-variable{color:teal}\n	.hljs-doctag,.hljs-string{color:#d14}\n	.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}\n	.hljs-subst{font-weight:400}\n	.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}\n	.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}\n	.hljs-meta,.hljs-strong{font-weight:700}\n	.hljs-link,.hljs-regexp{color:#009926}\n	.hljs-bullet,.hljs-symbol{color:#990073}\n	.hljs-built_in,.hljs-builtin-name{color:#0086b3}\n	.hljs-meta{color:#999}\n	.hljs-deletion{background:#fdd}\n	.hljs-addition{background:#dfd}\n	.hljs-emphasis{font-style:italic}\n\n	/* black theme */\n	body.code-theme-black{background:#333;color:#bbb}\n	body.code-theme-black blockquote{\n		border-color:#444;border-color:rgba(200,200,200,.1);\n		background:#444;background:rgba(200,200,200,.1);\n	}\n	body.code-theme-black .h1,body.code-theme-black h1{border-bottom: 1px solid rgba(200,200,200,.2);}\n\n	body.code-theme-black code,body.code-theme-black pre,body.code-theme-black pre code{color:#777;border-color:#444;border-color:rgba(0,0,0,.1);background:#444;background:rgba(0,0,0,.1)}\n	body.code-theme-black code{color:#C5AC18;background:#555;background:rgba(255,255,255,0.15);}\n	body.code-theme-black a{color:orange}\n\n	body.code-theme-black .h1,body.code-theme-black h1,\n	body.code-theme-black .h2,body.code-theme-black h2,\n	body.code-theme-black .h3,body.code-theme-black h3,\n	body.code-theme-black .h4,body.code-theme-black h4,\n	body.code-theme-black .h5,body.code-theme-black h5,\n	body.code-theme-black .h6,body.code-theme-black h6{\n		color: #fff;\n	}\n	body.code-theme-black hr{border-bottom:solid 1px #444;border-color:rgba(200,200,200,.1);background-image:none;}\n	body.code-theme-black table thead{background: #3e3e3e;}\n	body.code-theme-black table td,body.code-theme-black table th{border-color:#444;border-color:rgba(200,200,200,.1)}\n	body.code-theme-black .markdown-latex {color: #fff;}\n	body.code-theme-black div .hljs{display:block;overflow-x:auto;padding:.5em;background:#23241f}\n	body.code-theme-black .hljs,body.code-theme-black .hljs-subst,body.code-theme-black .hljs-tag{color:#f8f8f2}\n	body.code-theme-black .hljs-emphasis,body.code-theme-black .hljs-strong{color:#a8a8a2}\n	body.code-theme-black .hljs-bullet,body.code-theme-black .hljs-link,body.code-theme-black .hljs-literal,body.code-theme-black .hljs-number,body.code-theme-black .hljs-quote,body.code-theme-black .hljs-regexp{color:#ae81ff}\n	body.code-theme-black .hljs-code,body.code-theme-black .hljs-section,body.code-theme-black .hljs-selector-class,body.code-theme-black .hljs-title{color:#a6e22e}\n	body.code-theme-black .hljs-strong{font-weight:700}\n	body.code-theme-black .hljs-emphasis{font-style:italic}\n	body.code-theme-black .hljs-attr,body.code-theme-black .hljs-keyword,body.code-theme-black .hljs-name,body.code-theme-black .hljs-selector-tag{color:#f92672}\n	body.code-theme-black .hljs-attribute,body.code-theme-black .hljs-symbol{color:#66d9ef}\n	body.code-theme-black .hljs-class .hljs-title,body.code-theme-black .hljs-params{color:#f8f8f2}\n	body.code-theme-black .hljs-addition,body.code-theme-black .hljs-built_in,body.code-theme-black .hljs-builtin-name,body.code-theme-black .hljs-selector-attr,body.code-theme-black .hljs-selector-id,body.code-theme-black .hljs-selector-pseudo,body.code-theme-black .hljs-string,body.code-theme-black .hljs-template-variable,body.code-theme-black .hljs-type,body.code-theme-black .hljs-variable{color:#e6db74}\n	body.code-theme-black .hljs-comment,body.code-theme-black .hljs-deletion,body.code-theme-black .hljs-meta{color:#75715e}\n\n	.print-btn{\n		position:absolute;padding:4px 20px;color:#444;font-size:1em;\n		background:#eee;background:rgba(200,200,200,0.2);margin-top: -45px;right:15px;\n	}\n	.print-btn:hover{text-decoration: none;background: #14a2ff;color: #fff;}\n	@media print {\n		.print-btn{display: none;}\n	}\n</style>\n<body {{if black_theme}}class="code-theme-black"{{/if}}>\n<a href="javascript:window.print();" class="print-btn">Print</a>\n\n{{@content}}\n</body>\n<html>\n\n'),define("app/src/edit/functionList",[],function(){var e={php:[{reg:/\n.*?\s*function\s+([_\w]+)\s*\(.*\)*/g,regName:/.*function\s+(.*\))/,regIndex:1,typeExtents:{"function-value":/\s*(private|protected)\s*/,"function-var":/\s*(public)\s*/},type:"function"},{reg:/\s*class\s+(\w*)\s*.*\{/g,regName:/\s*class\s+(\w*)\s*.*\{/,regIndex:1,type:"class"}],javascript:[{reg:/\s*([\$\w'"\[\]\.]+)\s*=\s*function\s*\([\w,\s\*\[\]\<\>&$]*\)\s*\{/g,regName:/\s*([\$\w'"\[\]\.]+)\s*=\s*function\s*(.*)/,regIndex:1,regName_all:[1,2],type:"function function-var"},{reg:/\s*function\s+([\w\s]+)\s*\([\w,\s\*\[\]\<\>&$]*\)\s*\{/g,regName:/\s*function\s+([\w\s]+)\s*(.*)/,regIndex:1,regName_all:[1,2],type:"function function-define"},{reg:/\s*([\w\.]+)\s*:\s*function\s*\([\w,\s\*\[\]\<\>&$]*\)\s*\{/g,regName:/\s*([\w\.]+)\s*:\s*function\s*(\([\w,\s\*\[\]\<\>&$]*\))/,regIndex:1,regName_all:[1,2],type:"function function-value"}],python:[{reg:/\s*class\s+(\w+)\s*\(/g,regName:/\s*class\s+(\w+)\s*\(/,regIndex:1,type:"class"},{reg:/\s*def\s+(\w+)\s*\(.*\)/g,regName:/\s*def\s+(\w+)\s*\(.*\)/,regIndex:1,type:"function"}],ruby:[{reg:/\s*class\s+(\w+)\s*/g,regName:/\s*class\s+(\w+)\s*/,regIndex:1,type:"class"},{reg:/\s*def\s+(\w+)\s*/g,regName:/\s*def\s+(\w+)\s*/,regIndex:1,type:"function"}],golang:[{reg:/\s*class\s+(\w+)\s*/g,regName:/\s*class\s+(\w+)\s*/,regIndex:1,type:"class"},{reg:/\s*func\s+(\w+)\s*.*\{/g,regName:/\s*func\s+(\w+)\s*/,regIndex:1,type:"function"}],java:[{reg:/\s*(final)?\s*(public|private|protected)\s*.*\s+(\w+)\s*\(.*\).*\{/g,regName:/\s*(final)?\s*(public|private|protected)\s*.*\s+(\w+)\s*\(.*\).*\{/,regIndex:3,type:"function"},{reg:/\s*class\s+(\w+)\s*/g,regName:/\s*class\s+(\w+)\s*/,regIndex:1,type:"class"}],csharp:[{reg:/\s*(public|private|protected)\s*.*\s+(\w+)\s*\(.*\).*/g,regName:/\s*(public|private|protected)\s*.*\s+(\w+)\s*\(.*\).*/,regIndex:2,type:"function"},{reg:/\s*class\s+(\w+)\s*/g,regName:/\s*class\s+(\w+)\s*/,regIndex:1,type:"class"}],actionscript:[{reg:/\s*function\s*(\w+)\s*\(.*\).*\s*\{/g,regName:/\s*function\s*(\w+)\s*\(.*\).*\s*\{/,regIndex:1,type:"function"},{reg:/\s*class\s+(\w+)\s*.*\{/g,regName:/\s*class\s+(\w+)\s*.*\{/,regIndex:1,type:"class"}],objectivec:[{reg:/[\+-]\s*\(.*\)\s*(\w+)\s*\:\s*\(.*/g,regName:/[\+-]\s*\(.*\)\s*(\w+)\s*\:\s*\(.*/,regIndex:1,type:"function"},{reg:/[\+-]\s*\([^:\{\}]*\)\s*(\w*)\s*\{/g,regName:/[\+-]\s*\([^:\{\}]*\)\s*(\w*)\s*\{/,regIndex:1,type:"function"},{reg:/@implementation\s+(\w*)/g,regName:/@implementation\s+(\w*)/,regIndex:1,type:"class"},{reg:/#pragma\s+(mark\s+)?(.*)/g,regName:/#pragma\s+(mark\s+)?(.*)/,regIndex:2,type:"mark"}],c_cpp:[{reg:/([\w*]+\s+)+\*?(\w+)\s*\([\w\s\n\*\/\<\>\[\]\.&,:-]*\)\s*\{/g,regName:/\s+(\w+)\s*\(/,regIndex:1,type:"function"},{reg:/\s*(\w+)::~?(\w+)\s*\([\w\s\n\*\/\<\>\[\]\.&,:-]*\)\s*\{/g,regName:/\s*(\w+)::~?(\w+)\s*\(/,regIndex:2,type:"function function-define"},{reg:/\s*class\s+(\w+)\s*:/g,regName:/\s*class\s+(\w+)\s*:/,regIndex:1,type:"class"}]},t=function(e,t){var a=e.match(t.reg);if(a){for(var i=[],n=a.length,o=0,s=e,r=0;n>r;r++){var l={};l.the_match=a[r];var c=l.the_match.match(t.regName);if(c&&!(c.length<t.regIndex)&&c[t.regIndex]){l.name=c[t.regIndex];var d=s.indexOf(l.the_match),p=l.the_match.indexOf(l.name);if(l.pos_start=o+d+p,l.pos_end=l.pos_start+l.name.length,t.regName_all!==void 0){l.name="";for(var u=t.regName_all,f=0;u.length>f;f++)l.name+=c[u[f]]}o=o+d+l.the_match.length,s=e.substr(o),l.type=t.type,t.typeExtents!==void 0&&$.each(t.typeExtents,function(e,t){l.the_match.match(t)&&(l.type+=" "+e)
}),i.push(l)}}return i}},a=function(a,i){if(void 0!==e[i]){for(var n=e[i],o=[],s=0;n.length>s;s++){var r=t(a,n[s]);r&&Array.prototype.push.apply(o,r)}o.sort(function(e,t){var a="pos_start";return e[a]<t[a]?-1:e[a]>=t[a]?1:void 0});for(var l=a.split("\n"),c=0,d=o[c],p=0,u=0;l.length>u&&d;u++){for(;d&&d.pos_start>=p&&d.pos_start<=p+l[u].length;)o[c].range={start:{row:u,column:d.pos_start-p},end:{row:u,column:d.pos_end-p}},c++,d=o[c];p=p+l[u].length+1}return o}},i=function(e){return e=e.replace(/[\r\n {]+/gi," "),e=e.replace(/"/gi,"'"),e=e.replace(/\</gi,"&lt;"),e=e.replace(/\>/gi,"&gt;")};return function(t){var n="",o='<div class="cell-null">No outline for the active view</div>',s=$("#"+t.kod.uuid).parent(),r=s.find(".function-search input"),l=s.find(".function-list-box"),c=function(){var e=Editor.current();if(!e||e.kod===void 0)return l.html(o),void 0;var t=function(e){var t=e.replace(/(^\s*)|(\s*$)/g,"");return t.replace(/(\{$)/,"")},s=e.kod.mode,c=a(e.getValue(),s);if(c===void 0||0==c.length)return l.html(o),void 0;var p=e.getCursorPosition().row;n="";for(var f=0;c.length>f;f++){var h=c[f],m=h.range;if(m){c.length-1>f&&p>=c[f].range.start.row&&c[f+1].range&&c[f+1].range.start.row>p&&(h.type+=" row-select"),f==c.length-1&&p>=c[f].range.start.row&&(h.type+=" row-select");var v=m.start.row+","+m.start.column+","+m.end.row+","+m.end.column,g=t(t(h.the_match)).substr(0,150);n+='<div class="list-row '+i(h.type)+' " title="'+i(g)+'" data-range="'+v+'">'+'<span class="icon"></span>'+'<span class="cell">'+i(h.name)+"</span></div>"}}r.val()||d(r.val()),u()},d=function(e){if(""==n)return l.html(o),void 0;if(!e||""==e)return l.html(n),u(),void 0;var t=$("<div>"+n+"</div>");t.find(".cell").each(function(){var t=$(this).text(),a=t.toLowerCase().indexOf(e.toLowerCase());-1!=a?(t=t.substr(0,a)+"<b>"+t.substr(a,e.length)+"</b>"+t.substr(a+e.length),$(this).html(t)):$(this).parent().remove()}),l.html(t.html()),p($(l.find(".list-row").get(0)))},p=function(e){if(1==e.length){l.find(".list-row").removeClass("row-select"),e.addClass("row-select");var t=e.attr("data-range"),a=t.split(","),i={start:{row:parseInt(a[0]),column:parseInt(a[1])},end:{row:parseInt(a[2]),column:parseInt(a[3])}};Editor.current()&&(Editor.current().revealRange(i),r.textFocus())}},u=function(){var e=l;if(e.outerHeight()!=e.prop("scrollHeight")){var t=e.scrollTop(),a=t+e.height(),i=e.find(".row-select").index(),n=e.find(".list-row:eq(0)").outerHeight(),o=e.scrollTop();t>i*n?o=i*n:(i+1)*n>a&&(o=i*n-e.height()+n),e.scrollTop(o)}},f=function(){var e="mouse_is_down";l.delegate(".list-row","mouseover mousedown mouseout mouseup",function(t){var a=$(this);switch(t.type){case"mouseover":a.parent().hasClass(e)?p(a):a.addClass("row-hover");break;case"mousedown":p(a),a.parent().addClass(e);break;case"mouseout":a.removeClass("row-hover");break;case"mouseup":a.parent().removeClass(e);break;default:}}),l.bind("mouseup",function(){r.textFocus()}),l.bind("mousedown",function(t){return 1!=t.which?!0:(l.setCapture&&l.setCapture(),$(document).one("mouseup",function(){l.removeClass(e),l.releaseCapture&&l.releaseCapture()}),void 0)});var t=function(){var e=r.val();d(e),""==e?s.find(".search-reset").addClass("hidden"):s.find(".search-reset").removeClass("hidden")};r.unbind("keydown").bind("keydown",function(e){switch(e.keyCode){case 37:break;case 39:break;case 38:0!=s.find(".row-select").prev().length&&(p(s.find(".row-select").prev()),u()),stopPP(e);break;case 40:0!=s.find(".row-select").next().length&&(p(s.find(".row-select").next()),u()),stopPP(e);break;case 27:case 13:p(s.find(".row-select")),r.val(""),t(),Editor.current()&&Editor.current().focus(),stopPP(e);break;default:setTimeout(t,5)}}),s.find(".search-reset").unbind("click").bind("click",function(){r.val(""),t(),Editor.current()&&Editor.current().focus()})};return f(),{refresh:c,support:function(t){return-1==$.inArray(t,objectKeys(e))?!1:!0}}}}),define("app/src/edit/markdownTools",[],function(){var e=function(){return Editor.current()},t={bold:{type:"inline",tag:"**",insert:"**${1:Bold Text}**",title:"Bold<Strong> (Ctrl-B)","class":"bold"},italic:{type:"inline",tag:"*",insert:"*${1:Italic Text}*",title:"Italic<em> (Ctrl-I)","class":"italic"},strikethrough:{type:"inline",tag:"~~",insert:"~~${1:Strikethrough Text}~~",title:"Strikethrough<del>","class":"strikethrough"},h1:{type:"head",insert:"# ",title:"Header 1 <h1>","class":"text-height"},h2:{type:"head",insert:"## ",title:"Header 2 <h2>"},h3:{type:"head",insert:"### ",title:"Header 3 <h3>"},h4:{type:"head",insert:"#### ",title:"Header 4 <h4>"},h5:{type:"head",insert:"###### ",title:"Header 5 <h5>"},quote:{type:"head",insert:"> ",title:"Quote <blockquote> (Ctrl-Q)","class":"quote-left"},list_order:{type:"head",insert:" 1. ",title:"Unordered list <ol> (Ctrl-O)","class":"list-ol"},list_unorder:{type:"head",insert:" - ",title:"Ordered list <ul> (Ctrl-U)","class":"list-ul"},list_task:{type:"head",insert:"- [ ] ",title:"Incomplete task list","class":"check-empty"},list_task_complete:{type:"head",insert:"- [x] ",title:"Complete task list","class":"check"},line:{type:"insert",insert:"\n\n\n----\n$1",title:"Line <hr>","class":"minus"},link:{type:"insert",insert:"[${1:}](http://$2)",title:"Link <a> (Ctrl-L)","class":"link"},image:{type:"image",insert:"![${1:}](http://$2)",title:"Image <img> (Ctrl-G)","class":"picture"},table:{type:"insert",insert:"\n\n\n| header 1    | header 2    |\n| ----------- | ----------- |\n| row 1 col 1 | row 1 col 2 |\n| row 2 col 1 | row 2 col 2 |\n\n",title:"Table <table>","class":"table"},code:{type:"inlineBlock",title:"Code <pre><code> (Ctrl-K)","class":"code",inline:{tag:"`",insert:"`${1:Code}`"},block:{tag:"\n```\n",insert:"\n```\n${1:code}\n```\n"}},math:{type:"inlineBlock",title:"Math (Ctrl-M)","class":"superscript",inline:{tag:"$$",insert:"$$${1:Math}$$"},block:{tag:"\n```\n",insert:"\n```math\n${1:}\n```\n"}},flowchart:{type:"insert",title:"flowchart diagram","class":"long-arrow-right",insert:"\n```mermaid\ngraph LR\nA-->B\n```\n"},sequence:{type:"insert",title:"Sequence diagram","class":"exchange",insert:"\n```mermaid\nsequenceDiagram\nA->>B: How are you?\nB->>A: Great!\n```\n"},gantt:{type:"insert",title:"Gantt diagram","class":"tasks",insert:"\n```mermaid\ngantt\ndateFormat YYYY-MM-DD\nsection S1\nT1: 2014-01-01, 9d\nsection S2\nT2: 2014-01-11, 9d\nsection S3\nT3: 2014-01-02, 9d\n```\n"},classDiagram:{type:"insert",title:"classDiagram diagram","class":"sitemap",insert:"\n```mermaid\nclassDiagram\nBaseClass <|-- AveryLongClass : Cool\nBaseClass : size()\nBaseClass : int chimp\nBaseClass : int gorilla\n```\n"},gitGraph:{type:"insert",title:"gitGraph diagram","class":"sitemap",insert:"\n```mermaid\nclassDiagram\nBaseClass <|-- AveryLongClass : Cool\nBaseClass : size()\nBaseClass : int chimp\nBaseClass : int gorilla\n```\n"}},a=function(e,t){var a=e.session.getTextRange(e.getSelectionRange()),i=t.insert;if(""!==a&&(i=i.replace(/\{1:.*\}/g,"{1:"+a+"}")),""!==a){var n=e.getSelectionRange(),o={start:{row:n.start.row,column:n.start.column-t.tag.length},end:n.start},s={start:n.end,end:{row:n.end.row,column:n.end.column+t.tag.length}};e.session.getTextRange(o)==t.tag&&e.session.getTextRange(s)==t.tag&&(e.selection.setSelectionRange({start:o.start,end:s.end}),i="${1:"+a+"}")}ace.snippetManager.insertSnippet(e,i)},i=function(e,t){for(var a=e.getSelectionRange(),i=[],n=a.end.row-a.start.row+1,o=0,s=0;n>s;s++){var r={start:{row:a.start.row+s,column:0},end:{row:a.start.row+s,column:t.insert.length}};i.push(r),e.session.getTextRange(r)==t.insert&&o++}for(var s=0;n>s;s++){var l=i[s];n==o?e.session.doc.remove(l):e.session.doc.insert({row:l.start.row,column:0},t.insert)}},n=function(e,t){var a=e.session.getTextRange(e.getSelectionRange()),i=t.insert;""!==a&&(i=i.replace(/\{1:.*\}/g,"{1:"+a+"}")),ace.snippetManager.insertSnippet(e,i)},o=function(e,t){var i=e.session.getTextRange(e.getSelectionRange()),n=e.getSelectionRange(),o=e.session.getLine(n.start.row),s={type:"inline",tag:t.inline.tag,insert:t.inline.insert,title:t.title};(n.start.row!=n.end.row||i===o.replace(/(^\s*)|(\s*$)/g,""))&&(s={type:"inline",tag:t.block.tag,insert:t.block.insert,title:t.title}),a(e,s)},s=function(){var e=["bold","italic","strikethrough","|","h1","line","quote","list_order","list_unorder","|","link","image","code","table","|","math","flowchart","sequence","gantt","classDiagram","|"],a="";return $.each(e,function(e,i){if("|"==i)a+="<span class='md-tools md-tools-split'>|</span>";else{var n=t[i],o="class='md-tools md-tools-"+i+" "+(n["class"]?"icon-"+n["class"]:"")+"' ";a+="<a href='javascript:void(0);' title='"+n.title+"' "+o+" data-action='"+i+"'></a>"}}),a},r=function(e){var t={type:"file",title:LNG.path_api_select_image,allowExt:"png|jpg|bmp|gif|jpeg|ico|svg|tiff"};core.api.pathSelect(t,function(t){core.fileLink(t,function(a){var i=core.pathThis(t),n="!["+i+"]("+a+")";ace.snippetManager.insertSnippet(e,n)})})},l=function(s){var l=t[s],c=e();if(l&&c){switch(l.type){case"inline":a(c,l,s);break;case"head":i(c,l,s);break;case"insert":n(c,l,s);break;case"inlineBlock":o(c,l,s);break;case"image":r(c);break;default:}e().focus()}},c=function(e){e.find(".md-tools[data-action]").bind("click",function(){var e=$(this).attr("data-action");l(e)})},d=function(e){$.each(t,function(a){var i=t[a];if(i.title&&i.title.match(/\((.*)\)/)){var n=i.title.match(/\((.*)\)/)[1],o=n.replace("Ctrl","Command");e.commands.addCommand({name:a,bindKey:{win:n,mac:o},exec:function(e){"ace/mode/markdown"==e.session.$modeId&&l(a)}})}})};return{bindEvent:function(e,t){e.find(".toolbar .content").html(s()),c(e),"ace/mode/markdown"==t.session.$modeId&&d(t)},doAction:l}}),define("app/src/edit/tpl/markdownHelpCN.html",[],'<div class="col-xs-5 col-md-3">\n<h5>1.标题与文字格式</h5>\n<p>标题</p>\n<pre>\n# 一级标题\n## 二级标题\n### 三级标题\n#### 四级标题\n##### 五级标题\n</pre>\n<p>文字格式</p>\n<pre>\n*斜体*\n**粗体**\n***粗斜体*** \n~~删除线~~\n</pre>\n<p>水平线</p>\n<pre>\n--- \n</pre> \n<a href="http://wowubuntu.com/markdown/" target="_blank">了解更多</a>\n</div>\n\n<div class="col-xs-5 col-md-3">\n<h5>2.列表</h5>\n<p>无序列表</p>\n<pre>\n- item 1\n- item 2\n* item 3\n(可以是[减号,星号,加号]+空格)\n</pre> \n<p>有序列表</p>\n<pre>\n1. item 1 [数字+空格]\n2. item 2\n3. item 3\n   - child 1\n   - child 2\n</pre>\n</div>\n\n<div class="col-xs-5 col-md-4">\n<h5>3.其他</h5>\n<p>图片</p>\n<pre>\n![图片名称](http://图片网址)\n</pre> \n\n<p>连接</p>\n<pre>\n[链接名称](http://链接网址)\n&lt;http://链接网址&gt;\n</pre> \n\n<p>引用</p>\n<pre>\n> 引用\n> 折行可以不加，新起一行要加\n</pre> \n\n<p>代码</p>\n<pre>\n行内代码:`code`\n```\nvar msg = "多行代码";\nalert(msg);\n```\n</pre> \n\n<p>公式</p>\n<pre>\n行内公式 $$E=mc^2$$ ;\n\n多行公式\n$$E=mc^2$$\n\n多行公式2\n```math\nE=mc^2\n```\n</pre>\n<a href=\'javascript:core.openWindow("http://tool.oschina.net/js/mathml/index.html");\' target="_blank">编辑器</a>  |  \n<a href=\'http://xiang.leanote.com/post/introduction-to-mathjax-and-latex-expression\' target="_blank">公式教程</a> <br/>\n<a href=\'http://blog.csdn.net/wangyaninglm/article/details/52887045\' target="_blank">流程图 |  时序图 |  甘特图 |  类图</a> <br/>\n</div>	\n'),define("app/src/edit/tpl/markdownHelp.html",[],'<div class="col-xs-5 col-md-3">\n<h5>1.Headers and Emphasis</h5>\n<p>Headers</p>\n<pre>\n# Header 1\n## Header 2\n### Header 3\n#### Header 4\n##### Header 5\n</pre>\n<p>Emphasis</p>\n<pre>\n*Emphasis*\n**Strong**\n***Emphasis Strong*** \n~~Strikethrough~~\n</pre>\n<p>Line</p>\n<pre>\n--- \n</pre> \n<a href="http://wowubuntu.com/markdown/" target="_blank">Learn More</a>\n</div>\n\n<div class="col-xs-5 col-md-3">\n<h5>2.Lists</h5>\n<p>Unordered list</p>\n<pre>\n- item 1\n- item 2\n* item 3\n(also[- ,* ,+ )\n</pre> \n<p>Ordered list</p>\n<pre>\n1. item 1\n2. item 2\n3. item 3\n   - child 1\n   - child 2\n</pre>\n</div>\n\n<div class="col-xs-5 col-md-4">\n<h5>3.Others</h5>\n<p>Image</p>\n<pre>\n![Alt text](http://img.png)\n</pre> \n\n<p>Links</p>\n<pre>\n[Link text](http://url)\n&lt;http://url&gt;\n</pre> \n\n<p>Blockquotes</p>\n<pre>\n> Are you \n> ok ?\n</pre> \n\n<p>Code</p>\n<pre>\ninline code:`code`\n```\nvar msg = "Block code";\nalert(msg);\n```\n</pre> \n\n<p>LaTeX Math</p>\n<pre>\ninline $$E=mc^2$$ ;\n\nblock\n$$E=mc^2$$\n\nblock2\n```math\nE=mc^2\n```\n</pre>\n<a href=\'javascript:core.openWindow("http://tool.oschina.net/js/mathml/index.html");\' target="_blank">Math Editor</a> \n<a href=\'javascript:core.openWindow("https://mermaidjs.github.io/");\' target="_blank">Flowcharts</a>  \n</div>	\n'),define("app/src/edit/tpl/editTabContent.html",[],'<div class="edit-content">\n	<pre id="{{uuid}}" class="ace-editor-content"></pre>\n	<div class="resize hidden"></div><!-- 预览 -->\n	<div class="edit-right-frame hidden">\n		<div class="right-main">\n			<div class="function-list-frame hidden">\n				<div class="function-list-tool">\n					<div class="box">\n						<span> <i class="icon-code"></i>{{LNG.function_list}}</span>\n						<a href="javascript:;" class="tool-close" title="{{LNG.close}}"><i class="font-icon icon-remove"></i></a>\n					</div>\n					<div class="function-search">\n						<input type="text" placeholder="Search(ctrl+shift+e)">\n						<i class="font-icon icon-remove-sign search-reset hidden"> </i>\n					</div>\n				</div>\n				<div class="function-list-parent">\n					<div class="function-list-box"></div>\n				</div>\n			</div>\n			<!-- 函数列表 -->\n\n			<div class="preview-url-frame can-right-menu hidden">\n				<div class="preview-url-tool">\n					<div class="input-content"><input type="text" value=""/></div>\n					<div class="box">\n						<a href="javascript:;" class="tool-open-url" title="{{LNG.open_ie}}"><i class="font-icon icon-external-link"></i></a>\n						<a href="javascript:;" class="tool-refresh" title="{{LNG.refresh}}"><i class="font-icon icon-refresh"></i></a>\n						<a href="javascript:;" class="tool-close" title="{{LNG.close}}"><i class="font-icon icon-eye-close"></i></a>\n					</div>\n				</div>\n				<div class="preview-frame-content">\n					<iframe src="" style="width:100%;height:98%;border:0;"></iframe>\n				</div>\n			</div>\n			<!-- url浏览 -->\n\n			<div class="preview-markdown-frame can-right-menu hidden">\n				<div class="preview-markdown-tool">\n					<div class="toolbar"><div class="content"></div></div>\n					<div class="box">\n						<div class="content">\n							<a href="javascript:;" markdown-action="tool-markdown-menu" title="{{LNG.download}}"><i class="font-icon icon-reorder"></i></a>\n							<a href="javascript:;" markdown-action="tool-markdown-max" title="{{LNG.open_ie}}"><i class="font-icon icon-resize-full"></i></a>\n							<a href="javascript:;" markdown-action="tool-markdown-full" title="{{LNG.close}}"><i class="font-icon icon-columns"></i></a>\n							<a href="javascript:;" markdown-action="tool-markdown-setting" title="{{LNG.more}}"><i class="font-icon icon-ellipsis-horizontal"></i></a>\n						</div>						\n					</div>\n					<div class="markdown-setting hidden">\n						<ul>\n							<li><a href="javascript:;" markdown-action="tool-open-url"><i class="icon-external-link"></i>{{LNG.preview}}</a></li>\n							<li class="line"></li>\n							<li><a href="javascript:;" markdown-action="tool-markdown-download-html"><i class="icon-cloud-download"></i>{{LNG.download}} html</a></li>\n							<li><a href="javascript:;" markdown-action="tool-markdown-download-markdown"><i class="icon-cloud-download"></i>{{LNG.download}} markdown</a></li>\n							<li><a href="javascript:;" markdown-action="tool-markdown-download-pdf"><i class="icon-cloud-download"></i>{{LNG.download}} pdf</a></li>\n							<li class="line"></li>\n							<li><a href="javascript:;" markdown-action="tool-markdown-help"><i class="icon-question"></i>{{LNG.help}}</a></li>\n						</ul>\n					</div>\n					<div class="markdown-help container-fluid hidden">\n						<h3>Markdown {{LNG.help}}</h3>\n						<div class="row content"></div>\n					</div>\n					<div class="markdown-menu-box hidden">\n						<h3>{{LNG.markdown_content}}</h3>\n						<div class="content"></div>\n					</div>\n				</div>\n				<div class="markdown-preview can-select"></div>\n			</div>\n			<!-- markdown -->\n		</div>\n	</div>\n</div>\n\n'),define("app/src/edit/taskTap",[],function(){var e=function(){$(".edit-tab .tab").live("mouseenter",function(){$(this).addClass("hover"),$(this).unbind("mousedown").mousedown(function(e){1!=e.which||$(this).hasClass("this")||$.nodeName(e.target,"A")||($(this).removeClass("hover").addClass("this"),Editor.select($(this).attr("uuid")))}).unbind("mouseup").mouseup(function(e){2==e.which&&Editor.remove($(this).attr("uuid"))})}).die("mouseleave").live("mouseleave",function(){$(this).removeClass("hover")}).die("dblclick").live("dblclick",function(e){stopPP(e)}),$(".edit-tab").die("dblclick").live("dblclick",function(e){Editor.add(),stopPP(e)}),$(".edit-tab .tab .close").live("click",function(){var e=$(this).parent().attr("uuid");Editor.remove(e)})},t=function(){$(".context-menu-list").filter(":visible").trigger("contextmenu:hide")},a=function(){$("body").click(t).contextmenu(t),$.contextMenu({zIndex:9999,selector:".edit-tab-menu",items:{refresh:{name:LNG.refresh+"<b>F5</b>",className:"refresh_tab",icon:"refresh",accesskey:"e"},sep1:"---------",close:{name:LNG.close,icon:"remove",className:"close_self",accesskey:"d"},"close-others":{name:LNG.close_others,icon:"remove",className:"close-others",accesskey:"o"},sep2:"--------","close-left":{name:LNG.close_left,icon:"remove-sign",className:"close-left",accesskey:"l"},"close-right":{name:LNG.close_right,icon:"remove-sign",className:"close-right",accesskey:"r"},sep3:"--------","open-the-path":{name:LNG.open_the_path,icon:"folder-open",className:"edit-open-the-path",accesskey:"n"},preview:{name:LNG.preview,icon:"eye-open",className:"edit_preview",accesskey:"p"}},callback:function(e,t){var a=t.$trigger,i=a.attr("uuid");switch(e){case"refresh":Editor.refresh(i);break;case"close":Editor.remove(i);break;case"close-left":var n=$(".edit-tab .tabs .tab").index(a);$(".edit-tab .tabs .tab:lt("+n+")").each(function(){Editor.remove($(this).attr("uuid"))});break;case"close-right":var n=$(".edit-tab .tabs .tab").index(a);$(".edit-tab .tabs .tab:gt("+n+")").each(function(){Editor.remove($(this).attr("uuid"))});break;case"close-others":$(".edit-tab .tabs .tab").each(function(){var e=$(this).attr("uuid");e!=i&&Editor.remove(e)});break;case"open-the-path":var o=a.attr("title");if(""==o)return Tips.tips(LNG.not_exists,"warning"),void 0;var s=core.pathFather(o),r=ShareData.frameTop();r.core.openPath(s);break;case"preview":Toolbar.doAction("preview");break;default:}}})},i=function(){var e,t,a,i,n=!1,o=!1,s=0,r=0,l=0,c=0,d=0,p=0,u=0,f=0;$(".edit-tab .tab").die("mousedown").live("mousedown",function(t){$.nodeName(t.target,"A")||(e=$.nodeName(t.target,"SPAN")?$(t.target).parent():$(this),1==t.which&&(n=!0,this.setCapture&&this.setCapture(),$(document).mousemove(function(e){m(e)}),$(document).one("mouseup",function(e){g(e),this.releaseCapture&&this.releaseCapture()})))});var h=function(i){o=!0,s=i.pageX,l=i.pageY,$tab_parent=$(".edit-tab"),t=$(".edit-tab .tab"),$(".draggable-dragging").remove(),a=e.clone().addClass("draggable-dragging").prependTo("body"),p=$sizeInt(t.css("margin-right")),u=$tab_parent.width(),f=$tab_parent.get(0).getBoundingClientRect().left,f+=$(window).scrollLeft(),r=e.get(0).getBoundingClientRect().left,d=$sizeInt(t.css("width")),c=$sizeInt(t.css("height"))-2;var n=e.get(0).getBoundingClientRect().top-$sizeInt(e.css("margin-top")),h=i.clientX-s+r;$("body").prepend("<div class='dragMaskView'></div>"),a.css({width:d+"px",top:n,left:h}),e.css("opacity",0)},m=function(i){if(n){0==o&&h(i);var u=i.clientX-s+r,f=i.clientY-l+c;a.css({left:u,top:f}),t.each(function(){var t=$(this).get(0).getBoundingClientRect().left;if(u>t&&t+d/2+p>u){if(e.attr("uuid")==$(this).attr("uuid"))return;v($(this).attr("uuid"),"left")}if(u>t-d/2+p&&t>u){if(e.attr("uuid")==$(this).attr("uuid"))return;v($(this).attr("uuid"),"right")}})}},v=function(a,n){if(!e.is(":animated")||i!=a){i=a,e.stop(!0,!0),$(".insertTemp").remove(),t=$(".edit-tab .tab");var o=e.width(),s=$(".edit-tab .tab-"+a),r=e.clone(!0).insertAfter(e).css({"margin-right":"0px",border:"none"}).addClass("insertTemp");"left"==n?e.after(s).css("width","0px"):(e.before(s).css("width","0px"),s.before(r)),e.animate({width:o+"px"},animate_time),r.animate({width:"0px"},animate_time,function(){$(this).remove(),t=$(".edit-tab .tab")})}},g=function(){if(n=!1,o=!1,startTime=0,$(".dragMaskView").remove(),Editor.current()&&Editor.current().focus(),void 0!=a){var t=e.get(0).getBoundingClientRect().left,i=e.get(0).getBoundingClientRect().top;a.animate({left:t+"px",top:i+"px"},animate_time,function(){e.css("opacity",1),$(this).remove()})}}},n=function(e,t,a){"remove"==e&&t.removeClass("edit-tab-menu");var i=1.4*animate_time,n=150,o=n,s=$(".edit-tab .tab.edit-tab-menu"),r=$sizeInt($(".edit-tab .tabs").width()),l=$sizeInt(s.css("margin-right"))+$sizeInt(s.css("border-right")),c=$sizeInt($(".edit-tab .add").css("width"))+30,d=s.length,p=Math.floor((r-c)/(n+l));switch(d>p&&(o=Math.floor((r-c)/d)-l),e){case"add":$(".edit-tab .tabs .this").css({"margin-top":"30px",width:o}).stop(1,1).animate({"margin-top":"0px"},i),s.animate({width:o+"px"},i);break;case"remove":void 0!=a&&Editor.select(a),t.stop(1,1).animate({width:"0","margin-top":"+=30"},i,function(){t.remove()}),s.stop(1,1).animate({width:o+"px"},i);break;case"resize":s.css("width",o+"px");break;default:}};return{rightMenu:{hidden:t},resetWidth:n,init:function(){e(),i(),a()}}}),define("app/src/edit/toolbar",[],function(){var e=function(){a(),$(".toolbar-menu").bind("click mouseup",stopPP),$(".toolbar-menu").on("mousedown",function(){$(".toolbar-menu").removeClass("select"),$(this).addClass("select"),$(this).contextMenu({action:e})}),window.top==window&&$('.tools [action="fullscreen"]').remove();var e=function(e,t){if(t.parent().hasClass("top-toolbar"))e.css({left:t.offset().left-4,top:t.outerHeight()-1});else if(t.parent().hasClass("bottom-toolbar")){var a=t.offset().left-e.outerWidth()+t.outerWidth()-5;e.css({left:a,top:t.offset().top-e.outerHeight()}),e.addClass("hidden"),setTimeout(function(){e.removeClass("hidden").css({top:t.offset().top-e.outerHeight()})},10)}e.find("input").length>=1&&setTimeout(function(){e.find("input").focus()},10)};$.contextMenu({selector:".menu-view-goto-line",trigger:"none",callback:n,items:{gotoline:{name:LNG.goto,className:"disable gotoline-input",type:"text"}}}),$.contextMenu({selector:".menuViewTab",trigger:"none",callback:n,items:{"soft-tab":{name:"Soft Tabs (spaces)",className:"soft-tab"},sep1:"---------","tab-size-2":{name:"Tab with:2",className:"tab-size-set tab-size-2"},"tab-size-3":{name:"Tab with:3",className:"tab-size-set tab-size-3"},"tab-size-4":{name:"Tab with:4",className:"tab-size-set tab-size-4"},"tab-size-8":{name:"Tab with:8",className:"tab-size-set tab-size-8"},sep2:"---------","convert-to-space":{name:"Convert To Space",className:"convert-to-space"},"convert-to-tab":{name:"Convert To Tabs",className:"convert-to-tab"}}});for(var t=[{charset:"UTF-8",name:LNG.charset_UTF_8},{charset:"UTF-16",name:LNG.charset_UTF_16},{charset:"BIG5-HKSCS",name:LNG.charset_BIG5_HKSCS},{charset:"BIG5",name:LNG.charset_BIG5},{charset:"CP850",name:""},{charset:"CP932",name:""},{charset:"CP949",name:LNG.charset_CP949},{charset:"CP1133",name:LNG.charset_CP1133},{charset:"CP1250",name:LNG.charset_CP1250},{charset:"CP1251",name:LNG.charset_CP1251},{charset:"CP1252",name:LNG.charset_CP1252},{charset:"CP1253",name:LNG.charset_CP1253},{charset:"CP1254",name:LNG.charset_CP1254},{charset:"CP1255",name:LNG.charset_CP1255},{charset:"CP1256",name:LNG.charset_CP1256},{charset:"CP1257",name:LNG.charset_CP1257},{charset:"CP1258",name:LNG.charset_CP1258},{charset:"EUC-JP",name:LNG.charset_EUC_JP},{charset:"EUC-KR",name:LNG.charset_EUC_KR},{charset:"GB18030",name:LNG.charset_GB18030},{charset:"GBK",name:LNG.charset_GBK},{charset:"Georgian-Academy",name:LNG.charset_Georgian_Academy},{charset:"ISO-8859-1",name:LNG.charset_ISO_8859_1},{charset:"ISO-8859-2",name:LNG.charset_ISO_8859_2},{charset:"ISO-8859-3",name:LNG.charset_ISO_8859_3},{charset:"ISO-8859-4",name:LNG.charset_ISO_8859_4},{charset:"ISO-8859-5",name:LNG.charset_ISO_8859_5},{charset:"ISO-8859-6",name:LNG.charset_ISO_8859_6},{charset:"ISO-8859-7",name:LNG.charset_ISO_8859_7},{charset:"ISO-8859-8",name:LNG.charset_ISO_8859_8},{charset:"ISO-8859-9",name:"-"},{charset:"ISO-8859-10",name:LNG.charset_ISO_8859_10},{charset:"ISO-8859-11",name:LNG.charset_ISO_8859_11},{charset:"ISO-8859-13",name:LNG.charset_ISO_8859_13},{charset:"ISO-8859-14",name:LNG.charset_ISO_8859_14},{charset:"ISO-8859-15",name:LNG.charset_ISO_8859_15},{charset:"ISO-8859-16",name:LNG.charset_ISO_8859_16},{charset:"ISO-2022-JP",name:LNG.charset_ISO_2022_JP},{charset:"KOI8-R",name:LNG.charset_KOI8_R},{charset:"KOI8-T",name:LNG.charset_KOI8_T},{charset:"KOI8-U",name:LNG.charset_KOI8_U},{charset:"Macintosh",name:LNG.charset_Macintosh},{charset:"PT154",name:LNG.charset_PT154},{charset:"SHIFT_JIS",name:LNG.charset_SHIFT_JIS},{charset:"TIS-620",name:LNG.charset_TIS_620},{charset:"ARMSCII-8",name:LNG.charset_ARMSCII_8},{charset:"VISCII",name:LNG.charset_VISCII},{charset:"Windows-1251",name:""},{charset:"Windows-1252",name:""},{charset:"Windows-1254",name:""}],i=function(e){for(var a={},i=0;t.length>i;i++){var n=t[i],o=n.name?"  ("+n.name+")":"";a[e+"-"+n.charset]={name:n.charset+o}}return a},s=G.codeFontAll.split(","),r={},l=0;s.length>l;l++){var c=s[l],d=replaceAll(c," ","-");r["set-font-family-"+c]={name:c,className:"set-font-family-"+d}}$.contextMenu({selector:".menu-view-setting",trigger:"none",callback:n,items:{tools:{name:LNG.tools,icon:"ellipsis-horizontal",accesskey:"m",items:{preview:{name:LNG.preview+"<b>Ctrl+Shift+S</b>",icon:"eye-open"},"open-browser":{name:LNG.open_ie,icon:"external-link",accesskey:"b"},sep1:"---------","beautify-html":{name:"html "+LNG.beautify_code,icon:"code"},"beautify-css":{name:"css "+LNG.beautify_code,icon:"code"},"beautify-js":{name:"js "+LNG.beautify_code,icon:"code"},"beautify-php":{name:"php "+LNG.beautify_code,icon:"code"},sep11:"---------","convert-case":{name:LNG.convert_case,icon:"font",items:{"convert-upper":{name:LNG.convert_upper_case+"<b>Ctrl+U</b>",icon:"chevron-sign-up"},"convert-lower":{name:LNG.convert_lower_case+"<b>Ctrl+O</b>",icon:"chevron-sign-down"}}},sep12:"---------","charset-set":{name:LNG.charset_default_set,icon:"flag-alt",className:"code-charset-list",accesskey:"c",items:i("set-charset")},"charset-save":{name:LNG.charset_convert_save,icon:"flag",className:"code-charset-list",accesskey:"s",items:i("save-charset")}}},sep1:"---------","function-list":{name:LNG.function_list+"<b>Ctrl+Shift+E</b>",className:"function-list"},"show-gutter":{name:LNG.show_gutter,className:"show-gutter"},"auto-wrap":{name:LNG.wordwrap,className:"auto-wrap"},"display-char":{name:LNG.char_all_display,className:"display-char"},sep2:"---------","font-family":{name:LNG.font_family,icon:"italic",className:"code-font-family-list",accesskey:"m",items:r},"ace-mode":{name:LNG.keyboard_type,icon:"code",accesskey:"m",items:{"keyboard-type-ace":{name:"Default",className:"keyboard-type-ace"},"keyboard-type-vim":{name:"vim",className:"keyboard-type-vim"},"keyboard-type-emacs":{name:"emacs",className:"keyboard-type-emacs"}}},sep3:"---------",help:{name:LNG.help,icon:"question",items:{shortcut:{name:LNG.shortcut,icon:"keyboard"},about:{name:LNG.about,icon:"info-sign"},emmet:{name:"Emmet help",icon:"code"},sep4:"-----------","learn-more":{name:LNG.learn_more,icon:"external-link"}}}}}),Hook.bind("rightMenu.show.menu-view-setting",function(e,t){var a=Editor.current()&&Editor.current().kod,i="contextMenu.items.tools.items.",n=t.data(),o=lodash.get(n,i+"beautify-php.$node"),s=a.charset.toUpperCase();"php"==a.mode?o.removeClass("hidden"):o.addClass("hidden"),$(".code-charset-list .selected").removeClass("selected");var r=lodash.get(n,i+"charset-set.items.set-charset-"+s+".$node"),l=lodash.get(n,i+"charset-save.items.save-charset-"+s+".$node");r&&r.addClass("selected"),l&&l.addClass("selected")}),$(".tools [action]").bind("click",function(e){var t=$(this).attr("action");return n(t),Editor.current()&&Editor.current().focus(),stopPP(e),!1}),$(".tab-size-set").click(function(){var e=$(this).text().split(":");Editor.saveConfig("tabSize",e[1]),Editor.current()&&Editor.current().focus(),Editor.current().execCommand("convertIndent","reset_size")}),$("ul.code-font-family-list .context-menu-item").click(function(){Editor.saveConfig("fontFamily",$(this).find("span").html(),""),Editor.current()&&Editor.current().focus(),o()}),$("body").click(function(e){try{$(".toolbar-menu").removeClass("select"),window.parent.$.contextMenu.hidden(),e&&$(e.target).is("textarea")||$(e.target).is("input")||0!=$(e.target).parents(".right-main").length||Editor.current()&&Editor.current().focus()}catch(e){}}),$(".gotoline-input input").keyup(function(){var e=parseInt($(this).val());isNaN(e)||Editor.current().gotoLine(e)}).keyEnter(function(e){return $.contextMenu.hidden(),Editor.current().focus(),stopPP(e),!1})},t=function(){var e=Editor.aceModeList.modes,t='<ul class="dropdown-menu code-mode-list hidden">';t+='<li class="list-input"><input type="text" value="" name="menuModeInput" /></li>';for(var a=0;e.length>a;a++)t+='<li class="list-cell" mode-name="'+e[a].name+'">'+e[a].caption+"</li>";$(t+"<ul>").appendTo("body");var i=function(){$(".file-mode").removeClass("select"),$(".code-mode-list").addClass("hidden"),$(".code-mode-list input").val(""),$(".code-mode-list .list-cell").removeClass("hidden").removeClass("hover");var e=$(".code-mode-list .selected").attr("mode-name"),t=Editor.current().kod.mode;Editor.current().getSession().setMode("ace/mode/"+e),Editor.current().kod.mode=e,Editor.current()&&Editor.current().focus(),o(),"markdown"==e&&n("preview"),"markdown"==t&&e!=t&&n("preview-close")};$(".file-mode").mousedown(function(){$(".file-mode").addClass("select"),$(".code-mode-list").removeClass("hidden");var e=$(window).width()-$(".file-mode").offset().left-$(".file-mode").outerWidth();$(".code-mode-list").css("right",e)}).mouseup(function(){$(".code-mode-list input").textFocus(),setTimeout(function(){$(".code-mode-list input").focus()},50)}),$("body").mousedown(function(e){!$(".file-mode").hasClass("select")||0!=$(e.target).parents(".code-mode-list").length||$(e.target).hasClass("file-mode")||$(e.target).hasClass("code-mode-list")||i()}),$(".code-mode-list input").keyup(function(e){var t=$(".code-mode-list .list-cell:not(.hidden)"),a=t.index($(".code-mode-list .hover"));switch(e.keyCode){case 38:if(a>0){$(".code-mode-list .hover").removeClass("hover");var n=$(t.get(a-1)).addClass("hover"),o=$(".code-mode-list");1==n.length&&(o.scrollTop(n.offset().top+o.scrollTop()-o.offset().top-50),Editor.current().getSession().setMode("ace/mode/"+n.attr("mode-name")))}return stopPP(e),void 0;case 40:if(t.index(".hover")<t.length-1){$(".code-mode-list .hover").removeClass("hover");var n=$(t.get(a+1)).addClass("hover"),o=$(".code-mode-list");1==n.length&&(o.scrollTop(n.offset().top+o.scrollTop()-o.offset().top-50),Editor.current().getSession().setMode("ace/mode/"+n.attr("mode-name")))}return stopPP(e),void 0;case 27:return i(),void 0;case 13:return $(".code-mode-list .selected").removeClass("selected"),$(".code-mode-list .hover").addClass("selected"),i(),void 0;default:}var s=$(this).val().toLocaleLowerCase(),r="hidden",l="";$(".code-mode-list .list-cell").each(function(){var e=$(this).removeClass("hover").html().toLocaleLowerCase();-1!=e.indexOf(s)?(""==l&&(l=$(this).addClass("hover"),Editor.current().getSession().setMode("ace/mode/"+$(this).attr("mode-name"))),$(this).removeClass(r)):$(this).addClass(r)})}),$(".code-mode-list .list-cell").mouseenter(function(){$(".code-mode-list .hover").removeClass("hover"),$(this).addClass("hover"),Editor.current().getSession().setMode("ace/mode/"+$(this).attr("mode-name")),$(this).unbind("click").click(function(){$(this).parent().find(".list-cell").removeClass("selected"),$(this).addClass("selected"),i()})}).mouseleave(function(){$(this).removeClass("hover"),Editor.current().getSession().setMode("ace/mode/"+Editor.current().kod.mode)
})},a=function(){t(),$(".top-toolbar a").attr("draggable","false"),$(".bottom-toolbar a").attr("draggable","false");for(var e=[12,13,14,15,16,18,20,22,24,26,28,32],a=G.codeThemeAll.split(","),i={},o={},s=0;e.length>s;s++){var r=e[s];i["set-code-font-"+r]={name:r+"px",className:"set-code-font-"+r}}for(var s=0;a.length>s;s++){var l=a[s],c={name:l,className:"set-code-theme-"+l};"ambiance"==l&&(c.className+=" line-top"),o["set-code-theme-"+l]=c}$.contextMenu({selector:".menu-view-font",trigger:"none",className:"code-font-list",callback:n,items:i}),$.contextMenu({selector:".menu-view-theme",trigger:"none",className:"code-theme-list",callback:n,items:o}),$("ul.code-font-list .context-menu-item").mouseenter(function(){Editor.current().setFontSize($(this).text()),$(this).unbind("click").click(function(){var e=$(this).text();Editor.saveConfig("fontSize",e),Editor.current()&&Editor.current().focus()})}).mouseleave(function(){Editor.current().setFontSize(G.codeConfig.fontSize)});var d=function(e){Editor.isBlackTheme(e)?$("body").addClass("code-theme-black"):$("body").removeClass("code-theme-black")};$("ul.code-theme-list .context-menu-item").mouseenter(function(){var e=$(this).find("span").html();d(e),Editor.current()&&Editor.current().setTheme("ace/theme/"+e),$(this).unbind("click").click(function(){var e=$(this).find("span").html();Editor.saveConfig("theme",e),Editor.current()&&Editor.current().focus(),d(e)})}).mouseleave(function(){Editor.current()&&Editor.current().setTheme("ace/theme/"+G.codeConfig.theme),d(G.codeConfig.theme)})},i=function(e){var t=Editor.current().getValue(),a=""==Editor.current().session.getTextRange()?!0:!1;a||(t=Editor.current().session.getTextRange());var i={brace_style:"collapse",break_chained_methods:!1,indent_char:" ",indent_scripts:"keep",indent_size:"4",keep_array_indentation:!0,preserve_newlines:!0,space_after_anon_function:!0,space_before_conditional:!0,unescape_strings:!1,wrap_line_length:"120"};switch(e){case"beautify-html":t=html_beautify(t,i);break;case"beautify-css":t=css_beautify(t);break;case"beautify-js":t=js_beautify(t);break;case"beautify-php":return Editor.current().execCommand("phpBeautify"),void 0}a?Editor.current().setValue(t):Editor.current().insert(t)},n=function(e){if("newfile"==e)return Editor.add(),void 0;switch(e){case"fullscreen":$(".icon-resize-full").toggleClass("icon-resize-small"),ShareData.frameTop("",function(e){e.core.editorFull()});break;case"save":Editor.save();break;case"saveall":Editor.saveall();break;case"undo":Editor.current().undo();break;case"redo":Editor.current().redo();break;case"refresh":Editor.refresh();break;case"delete":Editor.current().execCommand("del");break;case"selectAll":Editor.current().execCommand("selectall");break;case"startAutocomplete":Editor.current().execCommand("startAutocomplete");break;case"search":Editor.current().execCommand("find");break;case"searchReplace":Editor.current().execCommand("replace");break;case"auto-wrap":Editor.saveConfig("autoWrap");break;case"display-char":Editor.saveConfig("displayChar");break;case"show-gutter":Editor.saveConfig("showGutter");break;case"setting":Editor.doAction("setting");break;case"soft-tab":Editor.saveConfig("softTab");break;case"convert-to-space":Editor.current().execCommand("convertIndent","to_space");break;case"convert-to-tab":Editor.current().execCommand("convertIndent","to_tabs");break;case"auto-complete":Editor.saveConfig("autoComplete");break;case"convert-lower":Editor.current().execCommand("convertLower");break;case"convert-upper":Editor.current().execCommand("convertUpper");break;case"keyboard-type-ace":Editor.saveConfig("keyboardType","ace");break;case"keyboard-type-vim":Editor.saveConfig("keyboardType","vim");break;case"keyboard-type-emacs":Editor.saveConfig("keyboardType","emacs");break;case"beautify-html":i(e);break;case"beautify-css":i(e);break;case"beautify-js":i(e);break;case"beautify-php":i(e);break;case"open-browser":url=core.path2url(Editor.current().kod.filename),window.open(url);break;case"function-list":var t=Editor.current().kod.preview;t.openFunctionList();break;case"preview":var t=Editor.current().kod.preview;t.previewForce();break;case"preview-close":var t=Editor.current().kod.preview;t.close();break;case"close":Editor.remove();break;case"about":core.setting("about");break;case"emmet":window.open("http://docs.emmet.io/");break;case"shortcut":Editor.current().execCommand("showKeyboardShortcuts");break;case"learn-more":window.open("https://kodcloud.com/");break;default:if(0===e.indexOf("set-charset-")){var a=e.replace("set-charset-","");return Editor.current().kod.charset=a,Editor.refresh(),void 0}if(0===e.indexOf("save-charset-")){var a=e.replace("save-charset-","");return Editor.setChanged(Editor.current(),!0),Editor.current().kod.charsetSave=a,Editor.save(),Editor.current().kod.charset=a,void 0}}},o=function(){var e=G.codeConfig,t={functionList:"function-list",autoComplete:"auto-complete",autoWrap:"auto-wrap",displayChar:"display-char",softTab:"soft-tab",showGutter:"show-gutter"};$(".context-menu-root .context-menu-item").removeClass("selected");for(var a in t)"1"==e[a]&&$(".context-menu-root ."+t[a]).addClass("selected");$(".set-code-theme-"+e.theme).addClass("selected"),$(".set-code-font-"+e.fontSize.substr(0,2)).addClass("selected"),$(".tab-size-"+e.tabSize).addClass("selected"),$(".keyboard-type-"+e.keyboardType).addClass("selected");var i=replaceAll(e.fontFamily," ","-");if($(".set-font-family-"+i).addClass("selected"),Editor.current()){var n=Editor.aceModeList.modesByName[Editor.current().kod.mode].caption;$(".code-mode-list .list-cell").removeClass("selected hidden"),$(".code-mode-list [mode-name="+Editor.current().kod.mode+"]").addClass("selected"),$(".bottom-toolbar .file-mode").html(n),$(".bottom-toolbar .config-tab").html("Tabs:"+e.tabSize)}};return{doAction:n,toolbarSelected:o,init:function(){e(),Mousetrap.bind(["ctrl+s","command+s"],function(e){e.preventDefault(),e.returnvalue=!1,Editor.save()}),Mousetrap.bind(["ctrl+shift+e","command+shift+e"],function(e){e.preventDefault(),e.returnvalue=!1,Toolbar.doAction("function-list")}),Mousetrap.bind(["f5"],function(){Editor.refresh()})}}});